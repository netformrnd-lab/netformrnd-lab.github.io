<!DOCTYPE html>
<html lang="ko">
<head>
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>공급사 입점신청 - 모여라딜</title>
    <meta name="description" content="모여라딜 공급사 입점신청 - 제품이 최단 거리로 시장에 노출되고, 실구매로 이어지는 구조">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: #fff;
            color: #333;
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            word-break: keep-all;
            line-height: 1.6;
            min-height: 100vh;
        }

        .page-container {
            display: flex;
            min-height: 100vh;
        }

        /* 왼쪽: 컨텐츠 영역 */
        .left-section {
            flex: 1;
            background: #000;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 60px 40px;
        }

        .hero-message {
            text-align: center;
            margin-bottom: 40px;
        }

        .hero-message h1 {
            color: #fff;
            font-size: 32px;
            font-weight: 700;
            line-height: 1.4;
            margin-bottom: 16px;
        }

        .hero-message h1 .highlight {
            color: #fe9f29;
        }

        .hero-message p {
            color: rgba(255,255,255,0.7);
            font-size: 16px;
        }

        .slider-container {
            overflow: hidden;
            margin: 0 -40px;
            padding: 20px 0;
        }

        .slider-track {
            display: flex;
            gap: 16px;
            animation: slideLeft 30s linear infinite;
            padding-left: 40px;
        }

        .slider-track:hover {
            animation-play-state: paused;
        }

        @keyframes slideLeft {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-50%);
            }
        }

        .slide-item {
            flex-shrink: 0;
            width: 200px;
            height: 280px;
            border-radius: 16px;
            overflow: hidden;
            position: relative;
            background: #1a1a1a;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .slide-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .bottom-message {
            text-align: center;
            margin-top: 40px;
        }

        .bottom-message h2 {
            color: #fff;
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .bottom-message h2 .highlight {
            color: #fe9f29;
        }

        .bottom-message p {
            color: rgba(255,255,255,0.6);
            font-size: 14px;
        }

        /* 오른쪽: 폼 영역 */
        .right-section {
            flex: 1;
            padding: 60px 48px;
            max-width: 480px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .form-header {
            margin-bottom: 32px;
        }

        .form-header h2 {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
        }

        .form-header p {
            font-size: 14px;
            color: #666;
        }

        .form-container {
            max-width: 380px;
            width: 100%;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .required {
            color: #fe9f29;
            margin-left: 2px;
        }

        .form-input {
            width: 100%;
            padding: 14px 0;
            background: transparent;
            border: none;
            border-bottom: 1px solid #ddd;
            color: #333;
            font-size: 15px;
            font-family: inherit;
            transition: all 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-bottom-color: #fe9f29;
        }

        .form-input::placeholder {
            color: #aaa;
        }

        /* 파일 첨부 영역 */
        .file-upload-group {
            margin-bottom: 24px;
        }

        .file-input-wrapper {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 0;
            border-bottom: 1px solid #ddd;
        }

        .file-btn {
            background: #f5f5f5;
            border: 1px solid #ddd;
            padding: 10px 20px;
            font-size: 14px;
            color: #333;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
            font-weight: 500;
        }

        .file-btn:hover {
            background: #eee;
            border-color: #ccc;
        }

        .file-name {
            font-size: 14px;
            color: #888;
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .file-input {
            display: none;
        }

        .file-hint {
            font-size: 12px;
            color: #999;
            margin-top: 8px;
        }

        .upload-progress {
            display: none;
            margin-top: 8px;
        }

        .upload-progress.active {
            display: block;
        }

        .progress-bar {
            height: 4px;
            background: #eee;
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #fe9f29;
            width: 0%;
            transition: width 0.3s;
        }

        .progress-text {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
        }

        /* 개인정보 동의 */
        .privacy-group {
            margin-bottom: 28px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-wrapper input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: #fe9f29;
        }

        .checkbox-wrapper label {
            font-size: 14px;
            color: #333;
            cursor: pointer;
        }

        .privacy-link {
            font-size: 13px;
            color: #666;
            text-decoration: none;
        }

        .privacy-link:hover {
            color: #fe9f29;
            text-decoration: underline;
        }

        /* 제출 버튼 */
        .submit-btn {
            width: 100%;
            background: #333;
            color: #fff;
            font-size: 16px;
            font-weight: 600;
            padding: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .submit-btn:hover {
            background: #000;
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* 성공 모달 */
        .success-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .success-modal.active {
            display: flex;
        }

        .success-content {
            background: #fff;
            border-radius: 16px;
            padding: 48px 40px;
            text-align: center;
            max-width: 420px;
            margin: 20px;
        }

        .success-icon {
            font-size: 56px;
            margin-bottom: 20px;
        }

        .success-content h2 {
            font-size: 22px;
            font-weight: 700;
            color: #333;
            margin-bottom: 16px;
        }

        .success-content p {
            font-size: 15px;
            color: #666;
            line-height: 1.6;
            margin-bottom: 28px;
        }

        .close-btn {
            background: #333;
            color: #fff;
            font-size: 15px;
            font-weight: 600;
            padding: 14px 48px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: #000;
        }

        /* 반응형 */
        @media (max-width: 1024px) {
            .page-container {
                flex-direction: column;
            }

            .left-section {
                min-height: 450px;
                padding: 40px 20px;
            }

            .hero-message h1 {
                font-size: 26px;
            }

            .right-section {
                max-width: none;
                padding: 40px 24px;
            }

            .form-container {
                max-width: 480px;
                margin: 0 auto;
            }
        }

        @media (max-width: 768px) {
            .left-section {
                min-height: 380px;
                padding: 32px 16px;
            }

            .hero-message {
                margin-bottom: 24px;
            }

            .hero-message h1 {
                font-size: 22px;
            }

            .hero-message p {
                font-size: 14px;
            }

            .slide-item {
                width: 160px;
                height: 220px;
            }

            .bottom-message {
                margin-top: 24px;
            }

            .bottom-message h2 {
                font-size: 18px;
            }

            .right-section {
                padding: 32px 20px;
            }

            .form-header h2 {
                font-size: 20px;
            }

            .success-content {
                padding: 36px 24px;
            }
        }
    </style>
</head>
<body>
    <div class="page-container">
        <!-- 왼쪽: 컨텐츠 영역 -->
        <div class="left-section">
            <div class="hero-message">
                <h1>제품이 <span class="highlight">최단 거리</span>로<br>시장에 노출되고,<br>실구매로 이어지는 구조</h1>
                <p>모여라딜</p>
            </div>

            <div class="slider-container">
                <div class="slider-track" id="sliderTrack">
                    <div class="slide-item">
                        <img src="https://ecimg.cafe24img.com/pg2246b37345376080/moyeora02/web/upload/wz/gif1.gif" alt="콘텐츠 1">
                    </div>
                    <div class="slide-item">
                        <img src="https://ecimg.cafe24img.com/pg2246b37345376080/moyeora02/web/upload/wz/gif2.gif" alt="콘텐츠 2">
                    </div>
                    <div class="slide-item">
                        <img src="https://ecimg.cafe24img.com/pg2246b37345376080/moyeora02/web/upload/wz/gif4.gif" alt="콘텐츠 3">
                    </div>
                    <div class="slide-item">
                        <img src="https://ecimg.cafe24img.com/pg2246b37345376080/moyeora02/web/upload/wz/gif5.gif" alt="콘텐츠 4">
                    </div>
                    <div class="slide-item">
                        <img src="https://ecimg.cafe24img.com/pg2246b37345376080/moyeora02/web/upload/wz/gif6.gif" alt="콘텐츠 5">
                    </div>
                </div>
            </div>

            <div class="bottom-message">
                <h2>이들은 광고가 아니라 <span class="highlight">진짜 경험</span>을 전합니다</h2>
                <p>신뢰는 광고가 아니라 사람에서 시작됩니다</p>
            </div>
        </div>

        <!-- 오른쪽: 입점신청 폼 -->
        <div class="right-section">
            <div class="form-header">
                <h2>입점 신청</h2>
                <p>함께 성장할 파트너를 기다립니다</p>
            </div>

            <div class="form-container">
                <form id="supplierApplicationForm">
                    <div class="form-group">
                        <label class="form-label">기업명<span class="required">*</span></label>
                        <input type="text" class="form-input" id="companyName" required placeholder="회사명을 입력해주세요">
                    </div>

                    <div class="form-group">
                        <label class="form-label">자사몰 or 홈페이지</label>
                        <input type="text" class="form-input" id="website" placeholder="https://...">
                    </div>

                    <div class="form-group">
                        <label class="form-label">담당자 이름 / 직급<span class="required">*</span></label>
                        <input type="text" class="form-input" id="managerName" required placeholder="예: 홍길동 / 대리">
                    </div>

                    <div class="form-group">
                        <label class="form-label">연락처<span class="required">*</span></label>
                        <input type="tel" class="form-input" id="phone" required placeholder="010-0000-0000" maxlength="13">
                    </div>

                    <div class="file-upload-group">
                        <label class="form-label">회사소개서 / 제안서 첨부</label>
                        <div class="file-input-wrapper">
                            <button type="button" class="file-btn" onclick="document.getElementById('fileInput').click()">파일 선택</button>
                            <span class="file-name" id="fileName">선택된 파일 없음</span>
                            <input type="file" class="file-input" id="fileInput" accept=".pdf,.doc,.docx,.ppt,.pptx,.hwp,.zip">
                        </div>
                        <p class="file-hint">PDF, DOC, PPT, HWP (최대 10MB)</p>
                        <div class="upload-progress" id="uploadProgress">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill"></div>
                            </div>
                            <p class="progress-text" id="progressText">업로드 중...</p>
                        </div>
                    </div>

                    <div class="privacy-group">
                        <div class="checkbox-wrapper">
                            <input type="checkbox" id="privacyAgree" required>
                            <label for="privacyAgree">개인정보처리방침에 동의합니다.</label>
                        </div>
                        <a href="/privacy/" target="_blank" class="privacy-link">[약관확인]</a>
                    </div>

                    <button type="submit" class="submit-btn" id="submitBtn">신청하기</button>
                </form>
            </div>
        </div>
    </div>

    <!-- 성공 모달 -->
    <div class="success-modal" id="successModal">
        <div class="success-content">
            <div class="success-icon">✅</div>
            <h2>입점신청이 완료되었습니다!</h2>
            <p>
                소중한 신청 감사드립니다.<br>
                영업일 기준 1~2일 내에<br>
                담당자가 연락드리겠습니다.
            </p>
            <button class="close-btn" onclick="closeSuccessModal()">확인</button>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <script>
        // Firebase 설정
        const firebaseConfig = {
            apiKey: "AIzaSyAQf_Cu9wMji5QsMBQns5eg6nOD_vmrZMs",
            authDomain: "moyeora-deal-manager.firebaseapp.com",
            projectId: "moyeora-deal-manager",
            storageBucket: "moyeora-deal-manager.firebasestorage.app",
            messagingSenderId: "527148187832",
            appId: "1:527148187832:web:dc35b0413a7157db34744d",
            measurementId: "G-XEGLCEG93R"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const storage = firebase.storage();

        // 업로드된 파일 URL 저장
        let uploadedFileUrl = '';
        let uploadedFileName = '';

        // 슬라이드 복제 (무한 루프용)
        document.addEventListener('DOMContentLoaded', function() {
            const track = document.getElementById('sliderTrack');
            const items = track.innerHTML;
            track.innerHTML = items + items;
        });

        // 파일 선택 시 처리
        document.getElementById('fileInput').addEventListener('change', async function(e) {
            const file = e.target.files[0];
            if (!file) {
                document.getElementById('fileName').textContent = '선택된 파일 없음';
                uploadedFileUrl = '';
                uploadedFileName = '';
                return;
            }

            // 파일 크기 체크 (10MB)
            if (file.size > 10 * 1024 * 1024) {
                alert('파일 크기는 10MB 이하만 가능합니다.');
                e.target.value = '';
                return;
            }

            document.getElementById('fileName').textContent = file.name;
            uploadedFileName = file.name;

            // Firebase Storage에 업로드
            try {
                const progressDiv = document.getElementById('uploadProgress');
                const progressFill = document.getElementById('progressFill');
                const progressText = document.getElementById('progressText');

                progressDiv.classList.add('active');
                progressText.textContent = '업로드 중...';

                const timestamp = Date.now();
                const safeName = file.name.replace(/[^a-zA-Z0-9.-]/g, '_');
                const storageRef = storage.ref(`supplier-applications/${timestamp}_${safeName}`);

                const uploadTask = storageRef.put(file);

                uploadTask.on('state_changed',
                    (snapshot) => {
                        const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                        progressFill.style.width = progress + '%';
                        progressText.textContent = `업로드 중... ${Math.round(progress)}%`;
                    },
                    (error) => {
                        console.error('업로드 실패:', error);
                        progressDiv.classList.remove('active');
                        alert('파일 업로드에 실패했습니다. 다시 시도해주세요.');
                        uploadedFileUrl = '';
                    },
                    async () => {
                        uploadedFileUrl = await uploadTask.snapshot.ref.getDownloadURL();
                        progressText.textContent = '업로드 완료!';
                        setTimeout(() => {
                            progressDiv.classList.remove('active');
                        }, 1500);
                    }
                );
            } catch (error) {
                console.error('업로드 오류:', error);
                alert('파일 업로드 중 오류가 발생했습니다.');
            }
        });

        // 전화번호 자동 포맷팅
        document.getElementById('phone').addEventListener('input', function(e) {
            let num = e.target.value.replace(/[^0-9]/g, '');
            let result = '';
            if (num.length < 4) result = num;
            else if (num.length < 8) result = num.substr(0,3) + '-' + num.substr(3);
            else result = num.substr(0,3) + '-' + num.substr(3,4) + '-' + num.substr(7);
            e.target.value = result;
        });

        // 폼 제출
        document.getElementById('supplierApplicationForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = '제출 중...';

            try {
                // 폼 데이터 수집
                const formData = {
                    companyName: document.getElementById('companyName').value.trim(),
                    website: document.getElementById('website').value.trim(),
                    managerName: document.getElementById('managerName').value.trim(),
                    phone: document.getElementById('phone').value.trim(),

                    // 파일 정보
                    fileName: uploadedFileName,
                    fileUrl: uploadedFileUrl,

                    // 메타 정보
                    status: 'pending',
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
                    source: 'web_application_v3'
                };

                // Firebase에 저장
                await db.collection('supplierApplications').add(formData);

                // Google Sheets에도 전송 (기존 시스템 호환)
                try {
                    await fetch('https://script.google.com/macros/s/AKfycbzUDI9Dj19HfSqxyjy4eT-su7Kdwli3hGymcw390FQatzZLjp2JNKT0EVYTGhs4FlmR/exec', {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            type: '공급사_입점신청',
                            name: formData.companyName,
                            contact: formData.phone,
                            manager: formData.managerName,
                            website: formData.website,
                            file: uploadedFileName || '없음'
                        })
                    });
                } catch (err) {
                    console.log('Google Sheets 전송 실패 (무시):', err);
                }

                // 성공 모달 표시
                document.getElementById('successModal').classList.add('active');

                // 폼 초기화
                document.getElementById('supplierApplicationForm').reset();
                document.getElementById('fileName').textContent = '선택된 파일 없음';
                uploadedFileUrl = '';
                uploadedFileName = '';

            } catch (error) {
                console.error('신청 제출 실패:', error);
                alert('신청 제출 중 오류가 발생했습니다. 다시 시도해주세요.');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = '신청하기';
            }
        });

        function closeSuccessModal() {
            document.getElementById('successModal').classList.remove('active');
            window.location.href = '/supplier/';
        }

        // 모달 외부 클릭 시 닫기
        document.getElementById('successModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeSuccessModal();
            }
        });
    </script>
</body>
</html>
