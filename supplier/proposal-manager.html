<!DOCTYPE html>
<html lang="ko">
<head>
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì œì•ˆì„œ ê´€ë¦¬ - ëª¨ì—¬ë¼ë”œ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #f5f5f5; font-family: 'Noto Sans KR', sans-serif; min-height: 100vh; }

        .header { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); padding: 16px 24px; color: #fff; }
        .header-inner { max-width: 1400px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; }
        .logo { font-size: 18px; font-weight: 700; text-decoration: none; color: #fff; display: flex; align-items: center; gap: 8px; }
        .nav-menu { display: flex; gap: 4px; }
        .nav-item { padding: 8px 16px; border-radius: 8px; text-decoration: none; color: rgba(255,255,255,0.9); font-size: 14px; font-weight: 500; transition: all 0.2s; }
        .nav-item:hover { background: rgba(255,255,255,0.15); }
        .nav-item.active { background: rgba(255,255,255,0.25); color: #fff; font-weight: 600; }

        .container { max-width: 1400px; margin: 0 auto; padding: 40px 24px; }

        .page-header { margin-bottom: 40px; }
        .page-title { font-size: 32px; font-weight: 700; color: #374151; margin-bottom: 12px; }
        .page-desc { font-size: 16px; color: #6b7280; line-height: 1.6; }

        .category-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 24px; margin-bottom: 48px; }

        .category-card { background: #fff; border-radius: 16px; padding: 32px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); border: 2px solid transparent; transition: all 0.3s; }
        .category-card:hover { border-color: #f59e0b; box-shadow: 0 8px 24px rgba(245,158,11,0.15); }

        .category-icon { font-size: 48px; margin-bottom: 16px; }
        .category-name { font-size: 20px; font-weight: 700; color: #111; margin-bottom: 8px; }
        .category-desc { font-size: 14px; color: #6b7280; line-height: 1.6; margin-bottom: 16px; min-height: 48px; }
        .category-tags { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 20px; }
        .category-tag { display: inline-block; padding: 4px 12px; background: #fef3c7; color: #92400e; font-size: 12px; font-weight: 600; border-radius: 12px; }

        .btn-group { display: flex; gap: 8px; margin-bottom: 12px; }
        .btn-primary { flex: 1; padding: 12px; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: #fff; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-primary:hover { background: linear-gradient(135deg, #d97706 0%, #b45309 100%); }
        .btn-secondary { flex: 1; padding: 12px; background: #fff; color: #f59e0b; border: 2px solid #f59e0b; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-secondary:hover { background: #fffbeb; }

        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; padding-bottom: 16px; border-bottom: 3px solid #f59e0b; }
        .section-title { font-size: 24px; font-weight: 700; color: #111; }
        .section-badge { background: #fef3c7; color: #92400e; padding: 6px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; }

        .coming-soon { opacity: 0.6; pointer-events: none; }
        .coming-soon-badge { background: #e5e7eb; color: #6b7280; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 600; display: inline-block; margin-top: 8px; }

        /* íŒŒìƒë³¸ ëª©ë¡ */
        .derivatives-section { margin-top: 16px; padding-top: 16px; border-top: 1px solid #e5e7eb; }
        .derivatives-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .derivatives-title { font-size: 14px; font-weight: 600; color: #374151; }
        .derivatives-count { font-size: 12px; color: #6b7280; }
        .derivative-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 12px; background: #f9fafb; border-radius: 8px; margin-bottom: 8px; border: 1px solid #e5e7eb; }
        .derivative-info { flex: 1; min-width: 0; }
        .derivative-name { font-size: 13px; font-weight: 600; color: #111; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .derivative-url { font-size: 11px; color: #6b7280; margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .derivative-actions { display: flex; gap: 6px; margin-left: 12px; }
        .btn-icon { padding: 6px 10px; background: #fff; border: 1px solid #d1d5db; border-radius: 6px; font-size: 11px; cursor: pointer; transition: all 0.2s; white-space: nowrap; }
        .btn-icon:hover { background: #f9fafb; border-color: #f59e0b; color: #f59e0b; }
        .btn-icon.danger:hover { border-color: #dc2626; color: #dc2626; }

        /* ëª¨ë‹¬ */
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center; }
        .modal.active { display: flex; }
        .modal-content { background: #fff; border-radius: 16px; padding: 32px; max-width: 500px; width: 90%; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        .modal-header { font-size: 20px; font-weight: 700; color: #111; margin-bottom: 20px; }
        .modal-body { margin-bottom: 24px; }
        .modal-label { display: block; font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 8px; }
        .modal-input { width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 15px; font-family: 'Noto Sans KR', sans-serif; }
        .modal-input:focus { outline: none; border-color: #f59e0b; }
        .modal-hint { font-size: 12px; color: #6b7280; margin-top: 8px; line-height: 1.6; }
        .modal-hint strong { color: #f59e0b; }
        .modal-footer { display: flex; gap: 12px; justify-content: flex-end; }
        .btn-modal { padding: 12px 24px; border: none; border-radius: 8px; font-size: 15px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-modal-cancel { background: #e5e7eb; color: #374151; }
        .btn-modal-cancel:hover { background: #d1d5db; }
        .btn-modal-confirm { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: #fff; }
        .btn-modal-confirm:hover { background: linear-gradient(135deg, #d97706 0%, #b45309 100%); }

        .url-preview { background: #f3f4f6; padding: 12px; border-radius: 8px; margin-top: 12px; }
        .url-preview-label { font-size: 11px; color: #6b7280; margin-bottom: 4px; }
        .url-preview-value { font-size: 13px; color: #111; font-family: monospace; word-break: break-all; }

        .toast { position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%); background: #111; color: #fff; padding: 12px 24px; border-radius: 8px; font-size: 14px; z-index: 2000; opacity: 0; transition: opacity 0.3s; }
        .toast.show { opacity: 1; }

        /* ì´ë©”ì¼ ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬ */
        .email-modal .modal-content { max-width: 800px; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column; }
        .email-modal .modal-body { flex: 1; overflow: hidden; display: flex; flex-direction: column; }
        .email-subject-row { display: flex; gap: 8px; margin-bottom: 12px; align-items: center; }
        .email-subject-label { font-size: 13px; font-weight: 600; color: #374151; white-space: nowrap; }
        .email-subject-input { flex: 1; padding: 10px 14px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px; font-family: inherit; }
        .email-subject-input:focus { outline: none; border-color: #f59e0b; }
        .btn-copy-subject { padding: 10px 16px; background: #1a1a2e; color: #fff; border: none; border-radius: 8px; font-size: 13px; font-weight: 600; cursor: pointer; white-space: nowrap; }
        .btn-copy-subject:hover { background: #16213e; }
        .email-tabs { display: flex; gap: 4px; margin-bottom: 12px; }
        .email-tab { padding: 8px 16px; background: #e5e7eb; border: none; border-radius: 8px 8px 0 0; font-size: 13px; font-weight: 600; color: #6b7280; cursor: pointer; }
        .email-tab.active { background: #f59e0b; color: #fff; }
        .email-preview-frame { flex: 1; border: 1px solid #e5e7eb; border-radius: 0 8px 8px 8px; overflow: auto; background: #f8f9fa; min-height: 350px; }
        .email-preview-frame iframe { width: 100%; height: 400px; border: none; }
        .email-html-editor { display: none; flex: 1; min-height: 350px; }
        .email-html-editor.active { display: block; }
        .email-html-textarea { width: 100%; height: 350px; padding: 12px; border: 1px solid #e5e7eb; border-radius: 0 8px 8px 8px; font-family: 'Consolas', 'Monaco', monospace; font-size: 12px; line-height: 1.5; resize: none; background: #1a1a2e; color: #e5e7eb; }
        .email-html-textarea:focus { outline: none; border-color: #f59e0b; }
        .email-actions { display: flex; gap: 8px; margin-top: 16px; }
        .email-actions .btn-modal { flex: 1; }
        .btn-modal-email { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); }
        .btn-modal-email:hover { background: linear-gradient(135deg, #16213e 0%, #0f3460 100%); }

        /* ì œì•ˆ ë°©ì‹ ì²´í¬ë°•ìŠ¤ */
        .method-checkbox { display: flex; align-items: center; cursor: pointer; padding: 10px 16px; background: #f9fafb; border: 2px solid #e5e7eb; border-radius: 8px; transition: all 0.2s; }
        .method-checkbox:hover { border-color: #f59e0b; background: #fffbeb; }
        .method-checkbox input[type="checkbox"] { display: none; }
        .method-checkbox input[type="checkbox"]:checked + .method-label { color: #f59e0b; font-weight: 600; }
        .method-checkbox:has(input[type="checkbox"]:checked) { border-color: #f59e0b; background: #fffbeb; }
        .method-label { font-size: 13px; color: #374151; white-space: nowrap; }

        /* íŒŒìƒë³¸ ì•„ì´í…œ ìƒì„¸ ì •ë³´ */
        .derivative-details { font-size: 11px; color: #6b7280; margin-top: 4px; display: flex; gap: 8px; flex-wrap: wrap; }
        .derivative-detail-item { display: inline-flex; align-items: center; gap: 2px; }
        .method-badge { display: inline-block; padding: 2px 6px; background: #e5e7eb; color: #374151; font-size: 10px; border-radius: 4px; }
        .method-badge.active { background: #fef3c7; color: #92400e; }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-inner">
            <a href="/" class="logo">
                <span>â˜€ï¸ëª¨ì—¬ë¼ë”œ</span>
            </a>
            <div class="nav-menu">
                <a href="proposal-manager.html" class="nav-item active">ì œì•ˆì„œ</a>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="page-header">
            <h1 class="page-title">ğŸ“‘ ê³µê¸‰ì‚¬ ë§ì¶¤ ì œì•ˆì„œ</h1>
            <p class="page-desc">ì¹´í…Œê³ ë¦¬ë³„ ê¸°ë³¸ ì œì•ˆì„œë¥¼ í™•ì¸í•˜ê³ , ê³µê¸‰ì‚¬ ë§ì¶¤ ì œì•ˆì„œë¥¼ ìƒì„±í•˜ì„¸ìš”.<br>ìƒì„±ëœ ë§í¬ë¥¼ ê³µê¸‰ì‚¬ì—ê²Œ ë°”ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>

        <div class="section-header">
            <h2 class="section-title">ğŸ¯ ì œí’ˆ ì¹´í…Œê³ ë¦¬ë³„</h2>
            <span class="section-badge">ì œì•ˆì„œ ìƒì„±</span>
        </div>

        <div class="category-grid">
            <!-- ì‹í’ˆ/ìŒë£Œ -->
            <div class="category-card" data-category="food">
                <div class="category-icon">ğŸ½ï¸</div>
                <h3 class="category-name">ì‹í’ˆ/ìŒë£Œ</h3>
                <p class="category-desc">ê°€ê³µì‹í’ˆ, ìŒë£Œ, ê±´ê°•ì‹, ê°„í¸ì‹ ë“±</p>
                <div class="category-tags">
                    <span class="category-tag">ë§› ì²´í—˜</span>
                    <span class="category-tag">ë‹¨ê°€ ì ˆê°</span>
                    <span class="category-tag">ì‹œì¦Œ ëŒ€ì‘</span>
                </div>
                <div class="btn-group">
                    <button class="btn-primary" onclick="openProposal('category/email-proposal-food.html')">ê¸°ë³¸ ì œì•ˆì„œ ë³´ê¸°</button>
                    <button class="btn-secondary" onclick="openCreateModal('food', 'ì‹í’ˆ/ìŒë£Œ')">+ ë§ì¶¤ ìƒì„±</button>
                </div>
                <div class="derivatives-section" id="derivatives-food"></div>
            </div>

            <!-- ìœ¡ì•„/í‚¤ì¦ˆ -->
            <div class="category-card" data-category="baby">
                <div class="category-icon">ğŸ‘¶</div>
                <h3 class="category-name">ìœ¡ì•„/í‚¤ì¦ˆ</h3>
                <p class="category-desc">ìœ ì•„ìš©í’ˆ, ì¥ë‚œê°, ìœ¡ì•„ìš©í’ˆ</p>
                <div class="category-tags">
                    <span class="category-tag">ì—„ë§ˆ ì»¤ë®¤ë‹ˆí‹°</span>
                    <span class="category-tag">ì•ˆì „ì„±</span>
                    <span class="category-tag">ì¬êµ¬ë§¤</span>
                </div>
                <div class="btn-group">
                    <button class="btn-primary" onclick="openProposal('category/email-proposal-baby.html')">ê¸°ë³¸ ì œì•ˆì„œ ë³´ê¸°</button>
                    <button class="btn-secondary" onclick="openCreateModal('baby', 'ìœ¡ì•„/í‚¤ì¦ˆ')">+ ë§ì¶¤ ìƒì„±</button>
                </div>
                <div class="derivatives-section" id="derivatives-baby"></div>
            </div>

            <!-- ìƒí™œìš©í’ˆ -->
            <div class="category-card" data-category="lifestyle">
                <div class="category-icon">ğŸ§¹</div>
                <h3 class="category-name">ìƒí™œìš©í’ˆ/í™ˆì¼€ì–´</h3>
                <p class="category-desc">ì„¸ì œ, ì²­ì†Œìš©í’ˆ, ë°©í–¥ì œ, ìˆ˜ë‚©ìš©í’ˆ</p>
                <div class="category-tags">
                    <span class="category-tag">ì‹¤ìš©ì„±</span>
                    <span class="category-tag">ê°€ì„±ë¹„</span>
                    <span class="category-tag">ì •ê¸° êµ¬ë…</span>
                </div>
                <div class="btn-group">
                    <button class="btn-primary" onclick="openProposal('category/email-proposal-lifestyle.html')">ê¸°ë³¸ ì œì•ˆì„œ ë³´ê¸°</button>
                    <button class="btn-secondary" onclick="openCreateModal('lifestyle', 'ìƒí™œìš©í’ˆ')">+ ë§ì¶¤ ìƒì„±</button>
                </div>
                <div class="derivatives-section" id="derivatives-lifestyle"></div>
            </div>

            <!-- ë·°í‹°/í™”ì¥í’ˆ -->
            <div class="category-card coming-soon">
                <div class="category-icon">ğŸ’„</div>
                <h3 class="category-name">ë·°í‹°/í™”ì¥í’ˆ</h3>
                <p class="category-desc">í™”ì¥í’ˆ, ìŠ¤í‚¨ì¼€ì–´, ë©”ì´í¬ì—… ë¸Œëœë“œ</p>
                <div class="category-tags">
                    <span class="category-tag">ì²´í—˜ë‹¨</span>
                    <span class="category-tag">ì‚¬ìš© í›„ê¸°</span>
                </div>
                <span class="coming-soon-badge">ê³§ ê³µê°œ</span>
            </div>

            <!-- ê±´ê°•ì‹í’ˆ -->
            <div class="category-card coming-soon">
                <div class="category-icon">ğŸ’Š</div>
                <h3 class="category-name">ê±´ê°•ì‹í’ˆ/ì˜ì–‘ì œ</h3>
                <p class="category-desc">ê±´ê°•ê¸°ëŠ¥ì‹í’ˆ, ì˜ì–‘ì œ, ë‹¤ì´ì–´íŠ¸ ì œí’ˆ</p>
                <div class="category-tags">
                    <span class="category-tag">íš¨ê³¼ ê²€ì¦</span>
                    <span class="category-tag">ì¬êµ¬ë§¤ìœ¨</span>
                </div>
                <span class="coming-soon-badge">ê³§ ê³µê°œ</span>
            </div>

            <!-- ë°˜ë ¤ë™ë¬¼ -->
            <div class="category-card coming-soon">
                <div class="category-icon">ğŸ¾</div>
                <h3 class="category-name">ë°˜ë ¤ë™ë¬¼</h3>
                <p class="category-desc">ë°˜ë ¤ë™ë¬¼ ìš©í’ˆ, ì‚¬ë£Œ, ê°„ì‹</p>
                <div class="category-tags">
                    <span class="category-tag">í« ì¸í”Œë£¨ì–¸ì„œ</span>
                    <span class="category-tag">ì»¤ë®¤ë‹ˆí‹°</span>
                </div>
                <span class="coming-soon-badge">ê³§ ê³µê°œ</span>
            </div>
        </div>
    </div>

    <!-- íŒŒìƒë³¸ ìƒì„± ëª¨ë‹¬ -->
    <div id="createModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">ğŸ“ ë§ì¶¤ ì œì•ˆì„œ ìƒì„±</div>
            <div class="modal-body">
                <label class="modal-label">ê³µê¸‰ì‚¬ëª… (í•œê¸€ + ì˜ì–´)</label>
                <input type="text" id="companyName" class="modal-input" placeholder="ì˜ˆ: ì‚¼ì„±ì „ì samsung">
                <div class="modal-hint">
                    <strong>í˜•ì‹:</strong> í•œê¸€ëª… ì˜ì–´ëª…<br>
                    ì˜ì–´ ë¶€ë¶„ì´ URL ì£¼ì†Œë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.
                </div>
                <div class="url-preview" id="urlPreview" style="display: none;">
                    <div class="url-preview-label">ìƒì„±ë  URL</div>
                    <div class="url-preview-value" id="urlPreviewValue"></div>
                </div>

                <label class="modal-label" style="margin-top: 20px;">ì „í™”ë²ˆí˜¸</label>
                <input type="tel" id="companyPhone" class="modal-input" placeholder="ì˜ˆ: 02-1234-5678">

                <label class="modal-label" style="margin-top: 20px;">ì œì•ˆ ë°©ì‹ (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)</label>
                <div class="proposal-methods" style="display: flex; flex-wrap: wrap; gap: 12px; margin-top: 8px;">
                    <label class="method-checkbox">
                        <input type="checkbox" id="methodEmail" value="email" checked>
                        <span class="method-label">ğŸ“§ ì´ë©”ì¼</span>
                    </label>
                    <label class="method-checkbox">
                        <input type="checkbox" id="methodPhone" value="phone">
                        <span class="method-label">ğŸ“ ì „í™”</span>
                    </label>
                    <label class="method-checkbox">
                        <input type="checkbox" id="methodKakao" value="kakao">
                        <span class="method-label">ğŸ’¬ ì¹´ì¹´ì˜¤í†¡</span>
                    </label>
                    <label class="method-checkbox">
                        <input type="checkbox" id="methodWebsite" value="website">
                        <span class="method-label">ğŸŒ í™ˆí˜ì´ì§€</span>
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-modal btn-modal-cancel" onclick="closeCreateModal()">ì·¨ì†Œ</button>
                <button class="btn-modal btn-modal-confirm" onclick="createDerivative()">ìƒì„±í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <!-- ì´ë©”ì¼ ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬ -->
    <div id="emailModal" class="modal email-modal">
        <div class="modal-content">
            <div class="modal-header">ğŸ“§ ì´ë©”ì¼ í…œí”Œë¦¿</div>
            <div class="modal-body">
                <!-- ë©”ì¼ ì œëª© -->
                <div class="email-subject-row">
                    <span class="email-subject-label">ì œëª©:</span>
                    <input type="text" id="emailSubject" class="email-subject-input" readonly>
                    <button class="btn-copy-subject" onclick="copyEmailSubject()">ğŸ“‹ ì œëª© ë³µì‚¬</button>
                </div>
                <!-- íƒ­ -->
                <div class="email-tabs">
                    <button class="email-tab active" onclick="switchEmailTab('preview')">ë¯¸ë¦¬ë³´ê¸°</button>
                    <button class="email-tab" onclick="switchEmailTab('html')">HTML í¸ì§‘</button>
                </div>
                <!-- ë¯¸ë¦¬ë³´ê¸° -->
                <div class="email-preview-frame" id="emailPreviewContainer">
                    <iframe id="emailPreviewFrame"></iframe>
                </div>
                <!-- HTML í¸ì§‘ -->
                <div class="email-html-editor" id="emailHtmlEditor">
                    <textarea id="emailHtmlTextarea" class="email-html-textarea" spellcheck="false"></textarea>
                </div>
                <div class="email-actions">
                    <button class="btn-modal btn-modal-cancel" onclick="closeEmailModal()">ë‹«ê¸°</button>
                    <button class="btn-modal btn-modal-email" onclick="copyEmailHtml()">ğŸ“‹ HTML ë³µì‚¬</button>
                    <button class="btn-modal btn-modal-confirm" onclick="downloadEmailHtml()">ğŸ’¾ íŒŒì¼ ì €ì¥</button>
                </div>
            </div>
        </div>
    </div>

    <!-- í† ìŠ¤íŠ¸ -->
    <div id="toast" class="toast"></div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <script>
        // Firebase ì„¤ì •
        const firebaseConfig = {
            apiKey: "AIzaSyAQf_Cu9wMji5QsMBQns5eg6nOD_vmrZMs",
            authDomain: "moyeora-deal-manager.firebaseapp.com",
            projectId: "moyeora-deal-manager",
            storageBucket: "moyeora-deal-manager.firebasestorage.app",
            messagingSenderId: "527148187832",
            appId: "1:527148187832:web:dc35b0413a7157db34744d"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        let currentCategory = null;
        let currentCategoryName = null;
        const BASE_URL = 'https://netformrnd-lab.github.io';

        // í˜ì´ì§€ ë¡œë“œ ì‹œ íŒŒìƒë³¸ ëª©ë¡ í‘œì‹œ (Firebaseì—ì„œ)
        document.addEventListener('DOMContentLoaded', function() {
            loadProposalsFromFirebase();
        });

        // Firebaseì—ì„œ ì œì•ˆì„œ ëª©ë¡ ë¡œë“œ
        async function loadProposalsFromFirebase() {
            try {
                const snapshot = await db.collection('proposalDerivatives').orderBy('createdAt', 'desc').get();
                const proposals = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

                // ì¹´í…Œê³ ë¦¬ë³„ë¡œ ê·¸ë£¹í•‘
                const byCategory = {};
                proposals.forEach(p => {
                    const cat = mapCategoryToProposal(p.category);
                    if (!byCategory[cat]) byCategory[cat] = [];
                    byCategory[cat].push(p);
                });

                // ê° ì¹´í…Œê³ ë¦¬ë³„ë¡œ ëª©ë¡ ì—…ë°ì´íŠ¸
                ['food', 'baby', 'lifestyle', 'beauty', 'health', 'pet'].forEach(cat => {
                    updateDerivativesListFromData(cat, byCategory[cat] || []);
                });
            } catch (err) {
                console.error('Firebase load error:', err);
                // í´ë°±: localStorage ì‚¬ìš©
                ['food', 'baby', 'lifestyle'].forEach(cat => {
                    updateDerivativesList(cat);
                });
            }
        }

        // ì¹´í…Œê³ ë¦¬ ë§¤í•‘ (ìƒí’ˆë¦¬ìŠ¤íŠ¸ ì¹´í…Œê³ ë¦¬ â†’ ì œì•ˆì„œ ì¹´í…Œê³ ë¦¬)
        function mapCategoryToProposal(category) {
            if (!category) return 'lifestyle';
            const cat = category.toLowerCase();
            if (cat.includes('ì‹í’ˆ') || cat.includes('ìŒë£Œ') || cat.includes('food')) return 'food';
            if (cat.includes('ìœ¡ì•„') || cat.includes('í‚¤ì¦ˆ') || cat.includes('baby') || cat.includes('ìœ ì•„')) return 'baby';
            if (cat.includes('ìƒí™œ') || cat.includes('ë¦¬ë¹™') || cat.includes('í™ˆ') || cat.includes('lifestyle')) return 'lifestyle';
            if (cat.includes('ë·°í‹°') || cat.includes('í™”ì¥') || cat.includes('beauty')) return 'beauty';
            if (cat.includes('ê±´ê°•') || cat.includes('ì˜ì–‘') || cat.includes('health')) return 'health';
            if (cat.includes('ë°˜ë ¤') || cat.includes('í«') || cat.includes('pet')) return 'pet';
            return 'lifestyle';
        }

        // Firebase ë°ì´í„°ë¡œ ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateDerivativesListFromData(category, derivatives) {
            const container = document.getElementById(`derivatives-${category}`);
            if (!container) return;

            if (derivatives.length === 0) {
                container.innerHTML = '';
                return;
            }

            let html = `
                <div class="derivatives-header">
                    <span class="derivatives-title">ğŸ“‚ ë§ì¶¤ ì œì•ˆì„œ</span>
                    <span class="derivatives-count">${derivatives.length}ê°œ</span>
                </div>
            `;

            derivatives.forEach(d => {
                const methodLabels = { email: 'ì´ë©”ì¼', phone: 'ì „í™”', kakao: 'ì¹´ì¹´ì˜¤í†¡', website: 'í™ˆí˜ì´ì§€' };
                const methods = d.proposalMethods || ['email'];
                const methodBadges = methods.map(m => `<span class="method-badge active">${methodLabels[m] || m}</span>`).join('');
                const companyName = d.companyName || d.name || '-';

                html += `
                    <div class="derivative-item">
                        <div class="derivative-info">
                            <div class="derivative-name">${companyName}</div>
                            <div class="derivative-details">
                                ${d.phone ? `<span class="derivative-detail-item">ğŸ“ ${d.phone}</span>` : ''}
                                ${d.productName ? `<span class="derivative-detail-item">ğŸ“¦ ${d.productName}</span>` : ''}
                                <span class="derivative-detail-item">ì œì•ˆ: ${methodBadges}</span>
                            </div>
                        </div>
                        <div class="derivative-actions">
                            <button class="btn-icon" onclick="copyUrlFromFirebase('${d.id}', '${category}')">ë³µì‚¬</button>
                            <button class="btn-icon" onclick="openDerivativeFromFirebase('${d.id}', '${category}')">ì—´ê¸°</button>
                            <button class="btn-icon" onclick="openEmailModalFromFirebase('${d.id}', '${category}')" style="background:#1a1a2e;color:#fff;">ì´ë©”ì¼</button>
                            <button class="btn-icon danger" onclick="deleteDerivativeFromFirebase('${d.id}', '${category}')">ì‚­ì œ</button>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // Firebaseì—ì„œ URL ë³µì‚¬ (ê°„ëµ ë²„ì „ - ë¬¸ì„œID ì‚¬ìš©)
        async function copyUrlFromFirebase(docId, category) {
            // ê°„ëµ URL: ?c=ì¹´í…Œê³ ë¦¬&id=ë¬¸ì„œID
            const url = `${BASE_URL}/supplier/proposal/?c=${category}&id=${docId}`;
            navigator.clipboard.writeText(url).then(() => showToast('URLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!'));
        }

        // Firebaseì—ì„œ ì œì•ˆì„œ ì—´ê¸°
        async function openDerivativeFromFirebase(docId, category) {
            try {
                const doc = await db.collection('proposalDerivatives').doc(docId).get();
                if (!doc.exists) {
                    showToast('ì œì•ˆì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                const d = doc.data();
                const data = { category: category, companyName: d.companyName || d.name };
                const encodedData = btoa(encodeURIComponent(JSON.stringify(data)));
                window.open(`/supplier/proposal/?d=${encodedData}`, '_blank');
            } catch (err) {
                showToast('ì—´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // Firebaseì—ì„œ ì œì•ˆì„œ ì‚­ì œ
        async function deleteDerivativeFromFirebase(docId, category) {
            if (!confirm('ì´ ë§ì¶¤ ì œì•ˆì„œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            try {
                await db.collection('proposalDerivatives').doc(docId).delete();
                loadProposalsFromFirebase();
                showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (err) {
                showToast('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // Firebaseì—ì„œ ì´ë©”ì¼ ëª¨ë‹¬
        async function openEmailModalFromFirebase(docId, category) {
            try {
                const doc = await db.collection('proposalDerivatives').doc(docId).get();
                if (!doc.exists) {
                    showToast('ì œì•ˆì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                const d = doc.data();
                const companyName = d.companyName || d.name;
                currentEmailCompany = companyName;
                currentEmailSubject = `[ëª¨ì—¬ë¼ë”œ] ${companyName} íŒŒíŠ¸ë„ˆì‹­ ì œì•ˆë“œë¦½ë‹ˆë‹¤`;
                document.getElementById('emailSubject').value = currentEmailSubject;

                const data = { category: category, companyName: companyName };
                const encodedData = btoa(encodeURIComponent(JSON.stringify(data)));
                const proposalUrl = `${BASE_URL}/supplier/proposal/?d=${encodedData}`;

                currentEmailHtml = generateEmailHtml(companyName, category, proposalUrl);
                document.getElementById('emailPreviewFrame').srcdoc = currentEmailHtml;
                document.getElementById('emailHtmlTextarea').value = currentEmailHtml;
                switchEmailTab('preview');
                document.getElementById('emailModal').classList.add('active');
            } catch (err) {
                showToast('ì´ë©”ì¼ ëª¨ë‹¬ ì—´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì œì•ˆì„œ ì—´ê¸°
        function openProposal(url) {
            window.open(url, '_blank');
        }

        // ìƒì„± ëª¨ë‹¬ ì—´ê¸°
        function openCreateModal(category, categoryName) {
            currentCategory = category;
            currentCategoryName = categoryName;
            document.getElementById('companyName').value = '';
            document.getElementById('companyPhone').value = '';
            document.getElementById('urlPreview').style.display = 'none';
            // ì²´í¬ë°•ìŠ¤ ì´ˆê¸°í™”
            document.getElementById('methodEmail').checked = true;
            document.getElementById('methodPhone').checked = false;
            document.getElementById('methodKakao').checked = false;
            document.getElementById('methodWebsite').checked = false;
            document.getElementById('createModal').classList.add('active');
            document.getElementById('companyName').focus();
        }

        // ìƒì„± ëª¨ë‹¬ ë‹«ê¸°
        function closeCreateModal() {
            document.getElementById('createModal').classList.remove('active');
            currentCategory = null;
            currentCategoryName = null;
        }

        // ì…ë ¥ ì‹œ URL ë¯¸ë¦¬ë³´ê¸°
        document.getElementById('companyName').addEventListener('input', function(e) {
            const value = e.target.value.trim();
            const urlId = extractEnglish(value);

            if (urlId) {
                document.getElementById('urlPreview').style.display = 'block';
                document.getElementById('urlPreviewValue').textContent = `${BASE_URL}/supplier/proposal/${urlId}`;
            } else {
                document.getElementById('urlPreview').style.display = 'none';
            }
        });

        // ì˜ì–´ ë¶€ë¶„ ì¶”ì¶œ
        function extractEnglish(text) {
            const match = text.match(/[a-zA-Z][a-zA-Z0-9_-]*/);
            return match ? match[0].toLowerCase() : null;
        }

        // í•œê¸€ ë¶€ë¶„ ì¶”ì¶œ
        function extractKorean(text) {
            const match = text.match(/[\uAC00-\uD7AF\u1100-\u11FF\u3130-\u318F]+/g);
            return match ? match.join(' ') : text;
        }

        // íŒŒìƒë³¸ ìƒì„±
        async function createDerivative() {
            const input = document.getElementById('companyName').value.trim();

            if (!input) {
                showToast('ê³µê¸‰ì‚¬ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const urlId = extractEnglish(input);
            if (!urlId) {
                showToast('ì˜ì–´ ë¶€ë¶„ì´ í•„ìš”í•©ë‹ˆë‹¤. (ì˜ˆ: ì‚¼ì„±ì „ì samsung)');
                return;
            }

            // í•œê¸€ ì´ë¦„ ì¶”ì¶œ
            const companyName = extractKorean(input) || input;

            // ì „í™”ë²ˆí˜¸
            const phone = document.getElementById('companyPhone').value.trim();

            // ì œì•ˆ ë°©ì‹ ìˆ˜ì§‘
            const proposalMethods = [];
            if (document.getElementById('methodEmail').checked) proposalMethods.push('email');
            if (document.getElementById('methodPhone').checked) proposalMethods.push('phone');
            if (document.getElementById('methodKakao').checked) proposalMethods.push('kakao');
            if (document.getElementById('methodWebsite').checked) proposalMethods.push('website');

            // ìƒˆ íŒŒìƒë³¸ ìƒì„±
            const newDerivative = {
                urlId: urlId,
                name: input,
                companyName: companyName,
                phone: phone,
                proposalMethods: proposalMethods,
                category: currentCategory,
                categoryName: currentCategoryName,
                sourceType: 'outbound',  // ì•„ì›ƒë°”ìš´ë“œ êµ¬ë¶„
                stage: 'proposal',  // íŒŒì´í”„ë¼ì¸ ë‹¨ê³„
                proposalAt: new Date().toISOString(),  // ì œì•ˆ ì‹œì  (ì†Œìš”ì‹œê°„ ê³„ì‚°ìš©)
                createdAt: new Date().toISOString()
            };

            try {
                // Firebaseì— ì €ì¥
                const docRef = await db.collection('proposalDerivatives').add(newDerivative);
                newDerivative.id = docRef.id;

                closeCreateModal();
                // Firebaseì—ì„œ ë‹¤ì‹œ ë¡œë“œ
                await loadProposalsFromFirebase();
                showToast(`"${companyName}" ë§ì¶¤ ì œì•ˆì„œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!`);
            } catch (err) {
                console.error('Firebase save error:', err);
                // í´ë°±: localStorage ì‚¬ìš©
                const derivatives = getDerivatives(currentCategory);
                newDerivative.id = Date.now().toString();
                derivatives.push(newDerivative);
                saveDerivatives(currentCategory, derivatives);
                closeCreateModal();
                updateDerivativesList(currentCategory);
                showToast(`"${companyName}" ë§ì¶¤ ì œì•ˆì„œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤! (ë¡œì»¬ ì €ì¥)`);
            }
        }

        // íŒŒìƒë³¸ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
        function getDerivatives(category) {
            const data = localStorage.getItem(`derivatives_${category}`);
            return data ? JSON.parse(data) : [];
        }

        // íŒŒìƒë³¸ ì €ì¥
        function saveDerivatives(category, derivatives) {
            localStorage.setItem(`derivatives_${category}`, JSON.stringify(derivatives));
        }

        // íŒŒìƒë³¸ ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateDerivativesList(category) {
            const container = document.getElementById(`derivatives-${category}`);
            if (!container) return;

            const derivatives = getDerivatives(category);

            if (derivatives.length === 0) {
                container.innerHTML = '';
                return;
            }

            let html = `
                <div class="derivatives-header">
                    <span class="derivatives-title">ğŸ“‚ ë§ì¶¤ ì œì•ˆì„œ</span>
                    <span class="derivatives-count">${derivatives.length}ê°œ</span>
                </div>
            `;

            derivatives.forEach(d => {
                // ì œì•ˆ ë°©ì‹ ë¼ë²¨ ë§¤í•‘
                const methodLabels = {
                    email: 'ì´ë©”ì¼',
                    phone: 'ì „í™”',
                    kakao: 'ì¹´ì¹´ì˜¤í†¡',
                    website: 'í™ˆí˜ì´ì§€'
                };
                const methods = d.proposalMethods || ['email'];
                const methodBadges = methods.map(m => `<span class="method-badge active">${methodLabels[m] || m}</span>`).join('');

                html += `
                    <div class="derivative-item">
                        <div class="derivative-info">
                            <div class="derivative-name">${d.name}</div>
                            <div class="derivative-details">
                                ${d.phone ? `<span class="derivative-detail-item">ğŸ“ ${d.phone}</span>` : ''}
                                <span class="derivative-detail-item">ì œì•ˆ: ${methodBadges}</span>
                            </div>
                        </div>
                        <div class="derivative-actions">
                            <button class="btn-icon" onclick="copyUrl('${d.urlId}', '${category}')">ë³µì‚¬</button>
                            <button class="btn-icon" onclick="openDerivative('${d.urlId}', '${category}')">ì—´ê¸°</button>
                            <button class="btn-icon" onclick="openEmailModal('${d.urlId}', '${category}')" style="background:#1a1a2e;color:#fff;">ì´ë©”ì¼</button>
                            <button class="btn-icon danger" onclick="deleteDerivative('${category}', '${d.id}')">ì‚­ì œ</button>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // URL ë³µì‚¬ (ë°ì´í„° í¬í•¨)
        function copyUrl(urlId, category) {
            const derivatives = getDerivatives(category);
            const derivative = derivatives.find(d => d.urlId === urlId);

            if (!derivative) {
                showToast('ì œì•ˆì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // í•„ìˆ˜ ë°ì´í„°ë§Œ í¬í•¨ (URL ê¸¸ì´ ìµœì†Œí™”)
            const data = {
                category: derivative.category,
                companyName: derivative.companyName || derivative.name
            };

            // Base64 ì¸ì½”ë”©
            const encodedData = btoa(encodeURIComponent(JSON.stringify(data)));
            const url = `${BASE_URL}/supplier/proposal/?d=${encodedData}`;

            navigator.clipboard.writeText(url).then(() => {
                showToast('URLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! (ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œë„ ì ‘ì† ê°€ëŠ¥)');
            }).catch(() => {
                // í´ë°±
                const textarea = document.createElement('textarea');
                textarea.value = url;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showToast('URLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }

        // íŒŒìƒë³¸ ì—´ê¸° (ë°ì´í„° í¬í•¨ URL)
        function openDerivative(urlId, category) {
            const derivatives = getDerivatives(category);
            const derivative = derivatives.find(d => d.urlId === urlId);

            if (!derivative) {
                showToast('ì œì•ˆì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const data = {
                category: derivative.category,
                companyName: derivative.companyName || derivative.name
            };

            const encodedData = btoa(encodeURIComponent(JSON.stringify(data)));
            window.open(`/supplier/proposal/?d=${encodedData}`, '_blank');
        }

        // íŒŒìƒë³¸ ì‚­ì œ
        function deleteDerivative(category, id) {
            if (!confirm('ì´ ë§ì¶¤ ì œì•ˆì„œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            let derivatives = getDerivatives(category);
            derivatives = derivatives.filter(d => d.id !== id);
            saveDerivatives(category, derivatives);
            updateDerivativesList(category);
            showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        // í† ìŠ¤íŠ¸ í‘œì‹œ
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2500);
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('createModal').addEventListener('click', function(e) {
            if (e.target === this) closeCreateModal();
        });

        document.getElementById('emailModal').addEventListener('click', function(e) {
            if (e.target === this) closeEmailModal();
        });

        // Enter í‚¤ë¡œ ìƒì„±
        document.getElementById('companyName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') createDerivative();
        });

        // ==================== ì´ë©”ì¼ í…œí”Œë¦¿ ê¸°ëŠ¥ ====================
        let currentEmailHtml = '';
        let currentEmailCompany = '';
        let currentEmailSubject = '';

        // ì´ë©”ì¼ ëª¨ë‹¬ ì—´ê¸°
        function openEmailModal(urlId, category) {
            const derivatives = getDerivatives(category);
            const derivative = derivatives.find(d => d.urlId === urlId);

            if (!derivative) {
                showToast('ì œì•ˆì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const companyName = derivative.companyName || derivative.name;
            currentEmailCompany = companyName;

            // ì´ë©”ì¼ ì œëª© ìƒì„±
            currentEmailSubject = `[ëª¨ì—¬ë¼ë”œ] ${companyName} íŒŒíŠ¸ë„ˆì‹­ ì œì•ˆë“œë¦½ë‹ˆë‹¤`;
            document.getElementById('emailSubject').value = currentEmailSubject;

            // ì œì•ˆì„œ URL ìƒì„±
            const data = {
                category: derivative.category,
                companyName: companyName
            };
            const encodedData = btoa(encodeURIComponent(JSON.stringify(data)));
            const proposalUrl = `${BASE_URL}/supplier/proposal/?d=${encodedData}`;

            // ì´ë©”ì¼ HTML ìƒì„±
            currentEmailHtml = generateEmailHtml(companyName, category, proposalUrl);

            // iframeì— ì´ë©”ì¼ ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
            const iframe = document.getElementById('emailPreviewFrame');
            iframe.srcdoc = currentEmailHtml;

            // HTML í¸ì§‘ê¸°ì—ë„ í‘œì‹œ
            document.getElementById('emailHtmlTextarea').value = currentEmailHtml;

            // íƒ­ ì´ˆê¸°í™” (ë¯¸ë¦¬ë³´ê¸° íƒ­ìœ¼ë¡œ)
            switchEmailTab('preview');

            document.getElementById('emailModal').classList.add('active');
        }

        // ì´ë©”ì¼ ëª¨ë‹¬ ë‹«ê¸°
        function closeEmailModal() {
            document.getElementById('emailModal').classList.remove('active');
            currentEmailHtml = '';
            currentEmailCompany = '';
            currentEmailSubject = '';
        }

        // íƒ­ ì „í™˜
        function switchEmailTab(tab) {
            const tabs = document.querySelectorAll('.email-tab');
            const previewContainer = document.getElementById('emailPreviewContainer');
            const htmlEditor = document.getElementById('emailHtmlEditor');

            tabs.forEach(t => t.classList.remove('active'));

            if (tab === 'preview') {
                tabs[0].classList.add('active');
                previewContainer.style.display = 'block';
                htmlEditor.classList.remove('active');
                // HTML í¸ì§‘ ë‚´ìš©ì„ ë¯¸ë¦¬ë³´ê¸°ì— ë°˜ì˜
                currentEmailHtml = document.getElementById('emailHtmlTextarea').value;
                document.getElementById('emailPreviewFrame').srcdoc = currentEmailHtml;
            } else {
                tabs[1].classList.add('active');
                previewContainer.style.display = 'none';
                htmlEditor.classList.add('active');
            }
        }

        // ì´ë©”ì¼ ì œëª© ë³µì‚¬
        function copyEmailSubject() {
            const subject = document.getElementById('emailSubject').value;
            navigator.clipboard.writeText(subject).then(() => {
                showToast('ì´ë©”ì¼ ì œëª©ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }).catch(() => {
                const input = document.getElementById('emailSubject');
                input.select();
                document.execCommand('copy');
                showToast('ì´ë©”ì¼ ì œëª©ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }

        // ì´ë©”ì¼ HTML ë³µì‚¬
        function copyEmailHtml() {
            // HTML í¸ì§‘ê¸°ì˜ ìµœì‹  ë‚´ìš© ì‚¬ìš©
            currentEmailHtml = document.getElementById('emailHtmlTextarea').value;
            navigator.clipboard.writeText(currentEmailHtml).then(() => {
                showToast('ì´ë©”ì¼ HTMLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }).catch(() => {
                const textarea = document.createElement('textarea');
                textarea.value = currentEmailHtml;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showToast('ì´ë©”ì¼ HTMLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }

        // ì´ë©”ì¼ HTML íŒŒì¼ ì €ì¥
        function downloadEmailHtml() {
            // HTML í¸ì§‘ê¸°ì˜ ìµœì‹  ë‚´ìš© ì‚¬ìš©
            currentEmailHtml = document.getElementById('emailHtmlTextarea').value;
            const blob = new Blob([currentEmailHtml], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ëª¨ì—¬ë¼ë”œ_ì œì•ˆ_${currentEmailCompany}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast('ì´ë©”ì¼ íŒŒì¼ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // ì´ë©”ì¼ HTML ìƒì„±
        function generateEmailHtml(companyName, category, proposalUrl) {
            // ì¹´í…Œê³ ë¦¬ë³„ ì„¤ì •
            const categoryConfig = {
                food: { name: 'ì‹í’ˆ/ìŒë£Œ', icon: 'ğŸ½ï¸' },
                baby: { name: 'ìœ¡ì•„/í‚¤ì¦ˆ', icon: 'ğŸ‘¶' },
                lifestyle: { name: 'ìƒí™œìš©í’ˆ', icon: 'ğŸ§¹' }
            };
            const config = categoryConfig[category] || categoryConfig.lifestyle;

            return `<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ëª¨ì—¬ë¼ë”œ íŒŒíŠ¸ë„ˆì‹­ ì œì•ˆ</title>
</head>
<body style="margin: 0; padding: 0; font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif; background-color: #f8f9fa; -webkit-font-smoothing: antialiased;">

  <!-- Email Container -->
  <table role="presentation" style="width: 100%; border-collapse: collapse; background-color: #f8f9fa;">
    <tr>
      <td style="padding: 40px 20px;">

        <!-- Main Card -->
        <table role="presentation" style="max-width: 640px; margin: 0 auto; border-collapse: collapse; background-color: #ffffff; border-radius: 16px; box-shadow: 0 4px 24px rgba(0,0,0,0.08);">

          <!-- Header with Gradient -->
          <tr>
            <td style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); padding: 48px 40px; border-radius: 16px 16px 0 0; text-align: center;">
              <table role="presentation" style="margin: 0 auto 24px;">
                <tr>
                  <td style="background: rgba(255,255,255,0.1); padding: 12px 24px; border-radius: 8px;">
                    <span style="color: #ffffff; font-size: 24px; font-weight: 700; letter-spacing: 1px;">ëª¨ì—¬ë¼ë”œ</span>
                    <span style="color: #e94560; font-size: 24px; font-weight: 700;">.</span>
                  </td>
                </tr>
              </table>
              <h1 style="margin: 0 0 8px; color: #ffffff; font-size: 28px; font-weight: 700; letter-spacing: -0.5px;">
                íŒŒíŠ¸ë„ˆì‹­ ì œì•ˆì„œ
              </h1>
              <p style="margin: 0; color: rgba(255,255,255,0.7); font-size: 15px;">
                Partnership Proposal for Strategic Collaboration
              </p>
            </td>
          </tr>

          <!-- Personalized Greeting -->
          <tr>
            <td style="padding: 40px 40px 0;">
              <table role="presentation" style="width: 100%; background: linear-gradient(135deg, #fff9f0 0%, #fff5eb 100%); border-radius: 12px; border-left: 4px solid #e94560;">
                <tr>
                  <td style="padding: 24px;">
                    <p style="margin: 0 0 4px; color: #e94560; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;">
                      To. íŒŒíŠ¸ë„ˆì‚¬
                    </p>
                    <p style="margin: 0; color: #1a1a2e; font-size: 22px; font-weight: 700;">
                      ${companyName} ë‹´ë‹¹ìë‹˜ê»˜
                    </p>
                  </td>
                </tr>
              </table>
            </td>
          </tr>

          <!-- Main Content -->
          <tr>
            <td style="padding: 32px 40px;">
              <p style="margin: 0 0 20px; color: #333; font-size: 15px; line-height: 1.8;">
                ì•ˆë…•í•˜ì„¸ìš”, <strong style="color: #1a1a2e;">ëª¨ì—¬ë¼ë”œ</strong>ì…ë‹ˆë‹¤.
              </p>
              <p style="margin: 0 0 20px; color: #333; font-size: 15px; line-height: 1.8;">
                ê·€ì‚¬ì˜ ë¸Œëœë“œì™€ ì œí’ˆì„ ì‚´í´ë³´ë©° ëª¨ì—¬ë¼ë”œê³¼ í•¨ê»˜í•˜ì‹¤ ë•Œ í° ì‹œë„ˆì§€ê°€ ë‚  ê²ƒì´ë¼ í™•ì‹ í•˜ì—¬ ì´ë ‡ê²Œ íŒŒíŠ¸ë„ˆì‹­ì„ ì œì•ˆë“œë¦½ë‹ˆë‹¤.
              </p>
              <p style="margin: 0 0 20px; color: #333; font-size: 15px; line-height: 1.8;">
                ëª¨ì—¬ë¼ë”œì€ <strong style="color: #e94560;">ì „êµ­ 1,000ëª… ì´ìƒì˜ ì¸í”Œë£¨ì–¸ì„œ ì— ë²„ì„œë”</strong>ì™€ í•¨ê»˜í•˜ëŠ” ê³µë™êµ¬ë§¤ í”Œë«í¼ì…ë‹ˆë‹¤. ê²€ì¦ëœ ê³µê¸‰ì‚¬ì˜ ê³ í’ˆì§ˆ ìƒí’ˆì„ SNS í™ë³´ + ì¹œêµ¬ ì¶”ì²œ ë°”ì´ëŸ´ë¡œ íŒë§¤í•˜ê³  ìˆìœ¼ë©°, ê·€ì‚¬ì™€ì˜ í˜‘ë ¥ì„ í†µí•´ ë” ë§ì€ ê³ ê°ì—ê²Œ ê°€ì¹˜ë¥¼ ì „ë‹¬í•˜ê³ ì í•©ë‹ˆë‹¤.
              </p>
            </td>
          </tr>

          <!-- Key Benefits Section -->
          <tr>
            <td style="padding: 0 40px 32px;">
              <table role="presentation" style="width: 100%; border-collapse: collapse;">
                <tr>
                  <td style="padding-bottom: 16px;">
                    <p style="margin: 0; color: #1a1a2e; font-size: 18px; font-weight: 700;">
                      âœ¦ íŒŒíŠ¸ë„ˆ í˜œíƒ
                    </p>
                  </td>
                </tr>
                <tr>
                  <td>
                    <table role="presentation" style="width: 100%; border-collapse: separate; border-spacing: 0 12px;">
                      <tr>
                        <td style="background: #f8f9fa; padding: 20px; border-radius: 12px;">
                          <table role="presentation" style="width: 100%;">
                            <tr>
                              <td style="width: 48px; vertical-align: top;">
                                <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #e94560 0%, #ff6b6b 100%); border-radius: 10px; text-align: center; line-height: 40px;">
                                  <span style="color: #fff; font-size: 18px;">ğŸ“Š</span>
                                </div>
                              </td>
                              <td style="vertical-align: top; padding-left: 12px;">
                                <p style="margin: 0 0 4px; color: #1a1a2e; font-size: 15px; font-weight: 600;">
                                  ê´‘ê³ ë¹„ 0ì›, ë¦¬ìŠ¤í¬ 0ì›
                                </p>
                                <p style="margin: 0; color: #666; font-size: 13px; line-height: 1.6;">
                                  íŒ”ë¦° ë§Œí¼ë§Œ ìˆ˜ìˆ˜ë£Œ ì°¨ê°, ì´ˆê¸° ë¹„ìš© ì—†ìŒ
                                </p>
                              </td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                      <tr>
                        <td style="background: #f8f9fa; padding: 20px; border-radius: 12px;">
                          <table role="presentation" style="width: 100%;">
                            <tr>
                              <td style="width: 48px; vertical-align: top;">
                                <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border-radius: 10px; text-align: center; line-height: 40px;">
                                  <span style="color: #fff; font-size: 18px;">ğŸ¯</span>
                                </div>
                              </td>
                              <td style="vertical-align: top; padding-left: 12px;">
                                <p style="margin: 0 0 4px; color: #1a1a2e; font-size: 15px; font-weight: 600;">
                                  1,000+ ì— ë²„ì„œë” SNS í™ë³´
                                </p>
                                <p style="margin: 0; color: #666; font-size: 13px; line-height: 1.6;">
                                  ì¸ìŠ¤íƒ€ê·¸ë¨Â·ë¸”ë¡œê·¸ ì‹¤ì œ ì‚¬ìš© í›„ê¸°ë¡œ ìì—°ìŠ¤ëŸ¬ìš´ ë…¸ì¶œ
                                </p>
                              </td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                      <tr>
                        <td style="background: #f8f9fa; padding: 20px; border-radius: 12px;">
                          <table role="presentation" style="width: 100%;">
                            <tr>
                              <td style="width: 48px; vertical-align: top;">
                                <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-radius: 10px; text-align: center; line-height: 40px;">
                                  <span style="color: #fff; font-size: 18px;">ğŸ’°</span>
                                </div>
                              </td>
                              <td style="vertical-align: top; padding-left: 12px;">
                                <p style="margin: 0 0 4px; color: #1a1a2e; font-size: 15px; font-weight: 600;">
                                  ëŒ€ëŸ‰ ì£¼ë¬¸ + ë¹ ë¥¸ ì •ì‚°
                                </p>
                                <p style="margin: 0; color: #666; font-size: 13px; line-height: 1.6;">
                                  ê³µë™êµ¬ë§¤ë¡œ ë¬¼ëŸ‰ í™•ë³´, 3~7ì¼ ë‚´ ì •ì‚°
                                </p>
                              </td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
            </td>
          </tr>

          <!-- CTA Section -->
          <tr>
            <td style="padding: 0 40px 40px;">
              <table role="presentation" style="width: 100%; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border-radius: 16px;">
                <tr>
                  <td style="padding: 32px; text-align: center;">
                    <p style="margin: 0 0 8px; color: rgba(255,255,255,0.7); font-size: 13px; text-transform: uppercase; letter-spacing: 1px;">
                      ìƒì„¸ ì œì•ˆì„œ í™•ì¸
                    </p>
                    <p style="margin: 0 0 24px; color: #ffffff; font-size: 18px; font-weight: 600;">
                      ê·€ì‚¬ë¥¼ ìœ„í•œ ë§ì¶¤ ì œì•ˆì„œë¥¼ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤
                    </p>
                    <a href="${proposalUrl}"
                       style="display: inline-block; background: linear-gradient(135deg, #e94560 0%, #ff6b6b 100%); color: #ffffff; text-decoration: none; padding: 16px 48px; border-radius: 50px; font-size: 16px; font-weight: 700; letter-spacing: 0.5px; box-shadow: 0 4px 15px rgba(233,69,96,0.4);">
                      ì œì•ˆì„œ ë³´ê¸° â†’
                    </a>
                    <p style="margin: 20px 0 0; color: rgba(255,255,255,0.5); font-size: 12px;">
                      í´ë¦­ í•œ ë²ˆìœ¼ë¡œ ìƒì„¸ ë‚´ìš©ì„ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤
                    </p>
                  </td>
                </tr>
              </table>
            </td>
          </tr>

          <!-- Contact Section -->
          <tr>
            <td style="padding: 0 40px 40px;">
              <table role="presentation" style="width: 100%; border-top: 1px solid #eee;">
                <tr>
                  <td style="padding-top: 32px;">
                    <p style="margin: 0 0 16px; color: #1a1a2e; font-size: 15px; line-height: 1.8;">
                      ì œì•ˆì„œ ê²€í†  í›„ í˜‘ë ¥ ì˜í–¥ì´ ìˆìœ¼ì‹œë‹¤ë©´ í¸í•˜ê²Œ ì—°ë½ ë¶€íƒë“œë¦½ë‹ˆë‹¤.<br>
                      ê·€ì‚¬ì™€ì˜ ì„±ê³µì ì¸ íŒŒíŠ¸ë„ˆì‹­ì„ ê¸°ëŒ€í•©ë‹ˆë‹¤.
                    </p>
                    <p style="margin: 0; color: #333; font-size: 14px; line-height: 1.8;">
                      ê°ì‚¬í•©ë‹ˆë‹¤.
                    </p>
                  </td>
                </tr>
              </table>
            </td>
          </tr>

          <!-- Signature -->
          <tr>
            <td style="padding: 0 40px 40px;">
              <table role="presentation" style="width: 100%; background: #f8f9fa; border-radius: 12px;">
                <tr>
                  <td style="padding: 24px;">
                    <table role="presentation" style="width: 100%;">
                      <tr>
                        <td style="vertical-align: middle;">
                          <p style="margin: 0 0 4px; color: #1a1a2e; font-size: 16px; font-weight: 700;">
                            ëª¨ì—¬ë¼ë”œ ì‚¬ì—…ê°œë°œíŒ€
                          </p>
                          <p style="margin: 0 0 12px; color: #666; font-size: 13px;">
                            Business Development Team
                          </p>
                          <table role="presentation">
                            <tr>
                              <td style="padding-right: 16px;">
                                <p style="margin: 0; color: #666; font-size: 12px;">
                                  ğŸ“ 010-4320-4179
                                </p>
                              </td>
                              <td>
                                <p style="margin: 0; color: #666; font-size: 12px;">
                                  ğŸ’¬ <a href="http://pf.kakao.com/_xoxnJHn" style="color: #e94560; text-decoration: none;">ì¹´ì¹´ì˜¤ì±„ë„</a>
                                </p>
                              </td>
                            </tr>
                          </table>
                        </td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
            </td>
          </tr>

          <!-- Footer -->
          <tr>
            <td style="background: #1a1a2e; padding: 32px 40px; border-radius: 0 0 16px 16px;">
              <table role="presentation" style="width: 100%;">
                <tr>
                  <td style="text-align: center;">
                    <p style="margin: 0 0 8px; color: rgba(255,255,255,0.9); font-size: 14px; font-weight: 600;">
                      ëª¨ì—¬ë¼ë”œ by NetForm R&D
                    </p>
                    <p style="margin: 0 0 16px; color: rgba(255,255,255,0.5); font-size: 12px;">
                      SNS ì— ë²„ì„œë” ë¯¸ë””ì–´ ì»¤ë¨¸ìŠ¤ ê¸°ë°˜ ìœ í†µí˜ì‹  í”Œë«í¼
                    </p>
                    <p style="margin: 0; color: rgba(255,255,255,0.3); font-size: 11px; line-height: 1.6;">
                      Â© 2025 ëª¨ì—¬ë¼ë”œ. All rights reserved.
                    </p>
                  </td>
                </tr>
              </table>
            </td>
          </tr>

        </table>

        <!-- Unsubscribe -->
        <table role="presentation" style="max-width: 640px; margin: 24px auto 0;">
          <tr>
            <td style="text-align: center;">
              <p style="margin: 0; color: #999; font-size: 11px;">
                ë³¸ ë©”ì¼ì€ íŒŒíŠ¸ë„ˆì‹­ ì œì•ˆì„ ìœ„í•´ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.
              </p>
            </td>
          </tr>
        </table>

      </td>
    </tr>
  </table>

</body>
</html>`;
        }
    </script>
</body>
</html>
