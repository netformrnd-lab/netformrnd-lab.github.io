<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëª¨ì—¬ë¼ë”œ ì‹í’ˆ/ìŒë£Œ ê³µê¸‰ì‚¬ ì œì•ˆì„œ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f5f5f5;
            padding: 0;
        }

        .email-container {
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
            box-shadow: 0 10px 50px rgba(0,0,0,0.1);
        }

        .no-print {
            text-align: center;
            padding: 20px;
            background: #111;
            color: #fff;
            font-size: 14px;
        }

        .no-print a {
            color: #fe9f29;
            text-decoration: none;
            font-weight: 700;
        }

        /* í¸ì§‘ ëª¨ë“œ */
        .edit-mode-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            padding: 12px 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: space-between;
        }
        .edit-mode-bar.active { display: flex; }
        .edit-mode-info {
            color: #fff;
            font-size: 14px;
            font-weight: 600;
        }
        .edit-mode-actions {
            display: flex;
            gap: 8px;
        }
        .btn-edit {
            padding: 8px 16px;
            background: #fff;
            color: #f59e0b;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-edit:hover { background: #fffbeb; }
        .btn-save {
            padding: 8px 16px;
            background: #10b981;
            color: #fff;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-save:hover { background: #059669; }

        /* í¸ì§‘ ê°€ëŠ¥ ìš”ì†Œ */
        .editable {
            position: relative;
            transition: all 0.2s;
        }
        .editable.editing {
            outline: 2px dashed #f59e0b;
            outline-offset: 4px;
            background: rgba(245, 158, 11, 0.05);
            cursor: text;
        }
        .editable.editing::after {
            content: 'âœï¸ í´ë¦­í•´ì„œ ìˆ˜ì •';
            position: absolute;
            top: -24px;
            left: 0;
            background: #f59e0b;
            color: #fff;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            pointer-events: none;
        }

        /* íƒœë¸”ë¦¿ */
        @media screen and (max-width: 1024px) {
            .email-container {
                max-width: 100%;
            }
        }

        /* ëª¨ë°”ì¼ */
        @media screen and (max-width: 768px) {
            body {
                padding: 0;
            }

            .email-container {
                box-shadow: none;
            }

            .no-print {
                padding: 15px;
                font-size: 13px;
            }

            /* ë¹„êµ í…Œì´ë¸” ëª¨ë°”ì¼ ìµœì í™” */
            table[cellpadding] td[style*="width: 50%"] {
                display: block !important;
                width: 100% !important;
                padding: 0 0 16px 0 !important;
            }

            table[cellpadding] td[style*="padding-right: 10px"],
            table[cellpadding] td[style*="padding-left: 10px"],
            table[cellpadding] td[style*="padding-right: 8px"],
            table[cellpadding] td[style*="padding-left: 8px"],
            table[cellpadding] td[style*="padding-right: 12px"],
            table[cellpadding] td[style*="padding-left: 12px"] {
                padding: 0 0 16px 0 !important;
            }

            /* 3ë‹¨ ë°•ìŠ¤ ëª¨ë°”ì¼ ìµœì í™” */
            table[cellpadding] td[style*="width: 33.33%"] {
                display: block !important;
                width: 100% !important;
                padding: 0 0 16px 0 !important;
            }

            /* 4ë‹¨ í”„ë¡œì„¸ìŠ¤ ëª¨ë°”ì¼ ìµœì í™” */
            table[cellpadding] td[style*="width: 25%"],
            table[cellpadding] td[style*="width: 8%"] {
                display: block !important;
                width: 100% !important;
                padding: 8px 0 !important;
            }

            table[cellpadding] td[style*="width: 8%"] span {
                display: block;
                transform: rotate(90deg);
                margin: 10px 0;
            }

            /* í™”ì‚´í‘œ ìˆ¨ê¸°ê¸° (ëª¨ë°”ì¼) */
            table[cellpadding] td[style*="width: 40px"] {
                display: none !important;
            }

            /* íŒ¨ë”© ì¡°ì • */
            td[style*="padding: 60px 40px"] {
                padding: 40px 20px !important;
            }

            td[style*="padding: 56px 40px"] {
                padding: 40px 20px !important;
            }

            td[style*="padding: 40px 30px"] {
                padding: 32px 20px !important;
            }

            td[style*="padding: 50px 30px"] {
                padding: 40px 20px !important;
            }

            /* í°íŠ¸ í¬ê¸° ì¡°ì • */
            h1[style*="font-size: 38px"] {
                font-size: 28px !important;
                line-height: 1.4 !important;
            }

            h2[style*="font-size: 32px"] {
                font-size: 24px !important;
            }

            h2[style*="font-size: 24px"] {
                font-size: 20px !important;
            }

            h2[style*="font-size: 22px"] {
                font-size: 18px !important;
            }

            h3[style*="font-size: 28px"] {
                font-size: 22px !important;
            }

            h3[style*="font-size: 24px"] {
                font-size: 20px !important;
            }

            div[style*="font-size: 48px"] {
                font-size: 36px !important;
            }

            div[style*="font-size: 36px"] {
                font-size: 28px !important;
            }

            div[style*="font-size: 32px"] {
                font-size: 24px !important;
            }

            span[style*="font-size: 30px"] {
                font-size: 24px !important;
            }

            span[style*="font-size: 42px"] {
                font-size: 32px !important;
            }

            span[style*="font-size: 40px"] {
                font-size: 32px !important;
            }

            /* ë²„íŠ¼ í¬ê¸° ì¡°ì • */
            td[style*="padding: 18px 56px"] {
                padding: 16px 40px !important;
            }

            /* ì´ë¯¸ì§€ ì¡°ì • */
            img[style*="height: 56px"] {
                height: 40px !important;
            }

            /* ì•„ì´ì½˜ ë²„íŠ¼ í¬ê¸° ì¡°ì • */
            div[style*="width: 56px; height: 56px"] {
                width: 48px !important;
                height: 48px !important;
                font-size: 24px !important;
            }

            /* border-right ì œê±° (ëª¨ë°”ì¼ì—ì„œ ì„¸ë¡œ ë°°ì¹˜) */
            td[style*="border-right: 1px solid"] {
                border-right: none !important;
                padding-bottom: 16px !important;
                border-bottom: 1px solid rgba(254,159,41,0.3) !important;
            }
        }

        /* ì‘ì€ ëª¨ë°”ì¼ (iPhone SE ë“±) */
        @media screen and (max-width: 375px) {
            h1[style*="font-size: 28px"] {
                font-size: 24px !important;
            }

            h2[style*="font-size: 24px"] {
                font-size: 20px !important;
            }

            div[style*="font-size: 36px"] {
                font-size: 28px !important;
            }
        }

        @media print {
            body {
                padding: 0;
                background: #fff;
            }
            .no-print {
                display: none;
            }
            .email-container {
                max-width: 100%;
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <!-- í¸ì§‘ ëª¨ë“œ ë°” -->
    <div id="editModeBar" class="edit-mode-bar">
        <div class="edit-mode-info">
            âœï¸ í¸ì§‘ ëª¨ë“œ | <span id="derivativeName"></span>
        </div>
        <div class="edit-mode-actions">
            <button class="btn-edit" onclick="cancelEdit()">ì·¨ì†Œ</button>
            <button class="btn-save" onclick="saveChanges()">ğŸ’¾ ì €ì¥í•˜ê¸°</button>
        </div>
    </div>

    <div class="no-print">
        ğŸ’¡ ì´ í˜ì´ì§€ë¥¼ ì´ë¯¸ì§€ë¡œ ì €ì¥í•˜ë ¤ë©´: <a href="#" onclick="window.print(); return false;">ì¸ì‡„(Ctrl+P)</a> â†’ PDF/ì´ë¯¸ì§€ë¡œ ì €ì¥
        <span id="editToggle"></span>
    </div>

    <table class="email-container" cellpadding="0" cellspacing="0" border="0" style="max-width: 680px; margin: 0 auto; background: #ffffff;">
        <!-- Header -->
        <tr>
            <td style="background: #ffffff; padding: 80px 50px 60px; text-align: center;">
                <img src="https://ecimg.cafe24img.com/pg2246b37345376080/moyeora02/web/upload/wz/logo1127.png" alt="ëª¨ì—¬ë¼ë”œ" style="height: 40px; margin-bottom: 48px; opacity: 0.8;">
                <h1 style="color: #111; font-size: 42px; font-weight: 700; line-height: 1.4; margin: 0 0 20px 0; letter-spacing: -0.02em;">
                    <span class="editable" data-edit="header-main">ë§›ìˆìœ¼ë©´ ì†Œë¬¸ë‚œë‹¤</span>
                </h1>
                <p style="color: #666; font-size: 18px; line-height: 1.6; margin: 0; font-weight: 400;">
                    <span class="editable" data-edit="header-desc">ì „êµ­ ì˜í–¥ë ¥ ìˆëŠ” í‘¸ë“œ ì— ë²„ì„œë”ê°€ ìì‹ ì˜ ì±„ë„ì—ì„œ í™ë³´</span>
                </p>
            </td>
        </tr>

        <!-- Comparison: ì¼ë°˜ ì‡¼í•‘ëª° vs ëª¨ì—¬ë¼ë”œ -->
        <tr>
            <td style="padding: 70px 50px; background: #fafafa;">
                <h2 style="font-size: 28px; font-weight: 700; color: #111; text-align: center; margin: 0 0 40px 0; line-height: 1.4;">
                    íŒë§¤ ë°©ì‹ì— ë”°ë¼ ìˆ˜ìµì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤
                </h2>
                <table cellpadding="0" cellspacing="0" border="0" style="width: 100%;">
                    <tr>
                        <td style="width: 50%; padding-right: 12px; vertical-align: top;">
                            <!-- ì¼ë°˜ ì‡¼í•‘ëª° -->
                            <div style="background: #fff; border: 1px solid #ddd; border-radius: 12px; padding: 32px;">
                                <div style="text-align: center; margin-bottom: 24px;">
                                    <span style="font-size: 14px; font-weight: 700; color: #999;">ì¼ë°˜ ì‡¼í•‘ëª°</span>
                                </div>
                                <div style="font-size: 15px; color: #333; line-height: 2; margin-bottom: 20px;">
                                    <div style="margin-bottom: 8px;">íŒë§¤ê°€: <strong class="editable" data-edit="comp-price">100,000ì›</strong></div>
                                    <div style="margin-bottom: 8px; color: #999;">íŒë§¤ìˆ˜ìˆ˜ë£Œ: <strong class="editable" data-edit="comp-fee">-10,000ì›</strong></div>
                                    <div style="margin-bottom: 8px; color: #999;">ê´‘ê³ ë¹„(í•„ìˆ˜): <strong class="editable" data-edit="comp-ad">-15,000ì›</strong></div>
                                    <div style="margin-bottom: 8px; color: #999;">CS/ë°°ì†¡: <strong class="editable" data-edit="comp-cs">-5,000ì›</strong></div>
                                </div>
                                <div style="border-top: 2px solid #eee; padding-top: 20px; text-align: center;">
                                    <div style="font-size: 13px; color: #999; margin-bottom: 8px;">ì‹¤ìˆ˜ë ¹</div>
                                    <span style="font-size: 32px; font-weight: 700; color: #111;" class="editable" data-edit="comp-result">70,000ì›</span>
                                </div>
                            </div>
                        </td>
                        <td style="width: 50%; padding-left: 12px; vertical-align: top;">
                            <!-- ëª¨ì—¬ë¼ë”œ -->
                            <div style="background: #fff; border: 2px solid #fe9f29; border-radius: 12px; padding: 32px;">
                                <div style="text-align: center; margin-bottom: 24px;">
                                    <span style="font-size: 14px; font-weight: 700; color: #fe9f29;">ëª¨ì—¬ë¼ë”œ</span>
                                </div>
                                <div style="font-size: 15px; color: #333; line-height: 2; margin-bottom: 20px;">
                                    <div style="margin-bottom: 8px;">íŒë§¤ê°€: <strong class="editable" data-edit="moyeo-price">100,000ì›</strong></div>
                                    <div style="margin-bottom: 8px; color: #666;">íŒë§¤ìˆ˜ìˆ˜ë£Œë§Œ: <strong class="editable" data-edit="moyeo-fee">-20,000ì›</strong></div>
                                    <div style="margin-bottom: 8px; color: #666;">ê´‘ê³ ë¹„: <strong>0ì›</strong></div>
                                    <div style="margin-bottom: 8px; color: #666;">CS/ë°°ì†¡: <strong>0ì›</strong></div>
                                </div>
                                <div style="border-top: 2px solid #fe9f29; padding-top: 20px; text-align: center;">
                                    <div style="font-size: 13px; color: #666; margin-bottom: 8px;">ì‹¤ìˆ˜ë ¹</div>
                                    <span style="font-size: 36px; font-weight: 700; color: #fe9f29;" class="editable" data-edit="moyeo-result">80,000ì›</span>
                                </div>
                            </div>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>

        <!-- í•µì‹¬ ì •ë³´ -->
        <tr>
            <td style="padding: 80px 50px; background: #ffffff;">
                <table cellpadding="0" cellspacing="0" border="0" style="width: 100%;">
                    <tr>
                        <td style="width: 33.33%; padding: 0 20px; vertical-align: top; text-align: center;">
                            <div style="font-size: 36px; font-weight: 700; color: #fe9f29; margin-bottom: 16px;">20~30%</div>
                            <div style="font-size: 16px; color: #333; font-weight: 600; margin-bottom: 8px;">íŒë§¤ ìˆ˜ìˆ˜ë£Œ</div>
                            <div style="font-size: 14px; color: #999;">íƒ€ í”Œë«í¼ ëŒ€ë¹„ ë‹¨ìˆœ</div>
                        </td>
                        <td style="width: 33.33%; padding: 0 20px; vertical-align: top; text-align: center;">
                            <div style="font-size: 36px; font-weight: 700; color: #fe9f29; margin-bottom: 16px;">3~7ì¼</div>
                            <div style="font-size: 16px; color: #333; font-weight: 600; margin-bottom: 8px;">ì •ì‚°</div>
                            <div style="font-size: 14px; color: #999;">ë¹ ë¥´ê³  íˆ¬ëª…</div>
                        </td>
                        <td style="width: 33.33%; padding: 0 20px; vertical-align: top; text-align: center;">
                            <div style="font-size: 36px; font-weight: 700; color: #fe9f29; margin-bottom: 16px;">0ì›</div>
                            <div style="font-size: 16px; color: #333; font-weight: 600; margin-bottom: 8px;">ê´‘ê³ ë¹„</div>
                            <div style="font-size: 14px; color: #999;">ë¦¬ìŠ¤í¬ ì—†ìŒ</div>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>

        <!-- CTA -->
        <tr>
            <td style="padding: 80px 50px; background: #fafafa; text-align: center;">
                <h2 style="font-size: 32px; font-weight: 700; color: #111; margin: 0 0 24px 0; line-height: 1.4;">
                    ë¬´ë£Œë¡œ ì‹œì‘í•˜ì„¸ìš”
                </h2>
                <p style="margin: 0 0 36px 0; font-size: 16px; color: #666; line-height: 1.6;">
                    ì´ˆê¸°ë¹„ìš© 0ì› Â· ê´‘ê³ ë¹„ 0ì›
                </p>
                <div style="margin-bottom: 32px;">
                    <a href="https://partner-moyeoradeal.kr" style="display: inline-block; background: #fe9f29; color: #fff; text-decoration: none; padding: 16px 48px; border-radius: 8px; font-size: 17px; font-weight: 700;">
                        íŒŒíŠ¸ë„ˆ ì‹ ì²­í•˜ê¸°
                    </a>
                </div>
                <div style="font-size: 14px; color: #999; line-height: 1.8;">
                    ë¬¸ì˜: contact@moyeoradeal.kr
                </div>
            </td>
        </tr>

        <!-- Footer -->
        <tr>
            <td style="padding: 20px 30px; background: #0a0a0a; text-align: center;">
                <p style="margin: 0; font-size: 11px; color: rgba(255,255,255,0.4); line-height: 1.5;">
                    â“’ 2024 ëª¨ì—¬ë¼ë”œ. All rights reserved.
                </p>
            </td>
        </tr>
    </table>

    <script>
        let isEditMode = false;
        let derivativeId = null;
        let category = null;
        let originalValues = {};

        // URL íŒŒë¼ë¯¸í„° ì½ê¸° ë° HTML ë¡œë“œ
        function getUrlParams() {
            const params = new URLSearchParams(window.location.search);
            derivativeId = params.get('derivative');
            category = params.get('category') || 'food';
            const name = params.get('name');

            if (derivativeId) {
                // HTML ì „ì²´ê°€ ì €ì¥ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
                const htmlKey = `derivative_html_${category}_${derivativeId}`;
                const savedHtml = localStorage.getItem(htmlKey);

                if (savedHtml) {
                    // ì „ì²´ HTMLì„ ë Œë”ë§
                    document.open();
                    document.write(savedHtml);
                    document.close();

                    // íŒŒìƒë³¸ ì´ë¦„ í‘œì‹œ (HTMLì´ ë¡œë“œëœ í›„)
                    setTimeout(() => {
                        const nameEl = document.getElementById('derivativeName');
                        const toggleEl = document.getElementById('editToggle');
                        if (nameEl && name) {
                            nameEl.textContent = decodeURIComponent(name);
                        }
                        if (toggleEl) {
                            toggleEl.innerHTML = ` | <a href="#" onclick="toggleEditMode(); return false;" style="color: #f59e0b; font-weight: 700;">âœï¸ í¸ì§‘ ëª¨ë“œ</a>`;
                        }
                    }, 100);
                    return;
                }

                // HTMLì´ ì—†ìœ¼ë©´ ê¸°ì¡´ í…ìŠ¤íŠ¸ í¸ì§‘ ë°©ì‹ ì‚¬ìš© (í•˜ìœ„ í˜¸í™˜ì„±)
                if (name) {
                    document.getElementById('derivativeName').textContent = decodeURIComponent(name);
                    document.getElementById('editToggle').innerHTML = ` | <a href="#" onclick="toggleEditMode(); return false;" style="color: #f59e0b; font-weight: 700;">âœï¸ í¸ì§‘ ëª¨ë“œ</a>`;
                    loadCustomValues();
                }
            }
        }

        // ì»¤ìŠ¤í…€ ê°’ ë¡œë“œ (í…ìŠ¤íŠ¸ í¸ì§‘ ë°©ì‹ - í•˜ìœ„ í˜¸í™˜ì„±)
        function loadCustomValues() {
            const key = `derivative_custom_${category}_${derivativeId}`;
            const saved = localStorage.getItem(key);

            if (saved) {
                const customValues = JSON.parse(saved);

                // ì €ì¥ëœ ê°’ìœ¼ë¡œ í…ìŠ¤íŠ¸ êµì²´
                Object.keys(customValues).forEach(editKey => {
                    const element = document.querySelector(`[data-edit="${editKey}"]`);
                    if (element) {
                        element.textContent = customValues[editKey];
                    }
                });
            }
        }

        // í¸ì§‘ ëª¨ë“œ í† ê¸€
        function toggleEditMode() {
            isEditMode = !isEditMode;
            const editBar = document.getElementById('editModeBar');
            const editables = document.querySelectorAll('.editable');

            if (isEditMode) {
                editBar.classList.add('active');
                // ì›ë³¸ ê°’ ì €ì¥
                editables.forEach(el => {
                    const key = el.dataset.edit;
                    originalValues[key] = el.textContent;
                    el.classList.add('editing');
                    el.contentEditable = true;
                });
            } else {
                editBar.classList.remove('active');
                editables.forEach(el => {
                    el.classList.remove('editing');
                    el.contentEditable = false;
                });
            }
        }

        // ë³€ê²½ ì‚¬í•­ ì €ì¥
        function saveChanges() {
            const editables = document.querySelectorAll('.editable');
            const customValues = {};

            editables.forEach(el => {
                const key = el.dataset.edit;
                const value = el.textContent.trim();
                customValues[key] = value;
            });

            // localStorageì— ì €ì¥
            const storageKey = `derivative_custom_${category}_${derivativeId}`;
            localStorage.setItem(storageKey, JSON.stringify(customValues));

            // í¸ì§‘ ëª¨ë“œ ì¢…ë£Œ
            toggleEditMode();

            alert('âœ… ë³€ê²½ ì‚¬í•­ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // ì·¨ì†Œ
        function cancelEdit() {
            if (!confirm('ë³€ê²½ ì‚¬í•­ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            // ì›ë³¸ ê°’ìœ¼ë¡œ ë³µì›
            const editables = document.querySelectorAll('.editable');
            editables.forEach(el => {
                const key = el.dataset.edit;
                if (originalValues[key]) {
                    el.textContent = originalValues[key];
                }
            });

            toggleEditMode();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        window.addEventListener('DOMContentLoaded', getUrlParams);
    </script>
</body>
</html>
