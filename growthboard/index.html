<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î™®Ïó¨ÎùºÎîú | ÏóÖÎ¨¥ ÏÑ±Í≥º Î≥¥Í≥†</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <style>
        :root {
            --color-primary: #1a2b4a;
            --color-primary-light: #2d4a7c;
            --color-accent: #3b7dd8;
            --color-accent-light: #e8f1fc;
            --color-bg: #fafbfc;
            --color-card: #ffffff;
            --color-text: #2c3e50;
            --color-text-light: #6b7c93;
            --color-border: #e5e9ef;
            --color-success: #27ae60;
            --color-warning: #f39c12;
            --color-orange: #e67e22;
            --shadow-sm: 0 1px 3px rgba(26, 43, 74, 0.06);
            --shadow-md: 0 4px 12px rgba(26, 43, 74, 0.08);
            --shadow-lg: 0 8px 30px rgba(26, 43, 74, 0.1);
            --radius: 12px;
            --radius-sm: 8px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--color-bg);
            color: var(--color-text);
            line-height: 1.7;
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
        }
        .container { max-width: 960px; margin: 0 auto; padding: 0 24px; }

        /* Media Viewer Modal - Compact */
        .viewer-overlay {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8); z-index: 5000;
            justify-content: center; align-items: center; flex-direction: column;
        }
        .viewer-overlay.active { display: flex; }
        .viewer-container {
            background: #1a1a2e; border-radius: 16px; padding: 24px;
            max-width: 600px; width: 90%; max-height: 85vh;
            display: flex; flex-direction: column; align-items: center;
            position: relative; box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            transition: max-width 0.3s ease;
        }
        .viewer-container.compare-mode {
            max-width: 900px;
        }
        .viewer-close {
            position: absolute; top: 12px; right: 12px;
            background: rgba(255,255,255,0.15); border: none; color: white;
            width: 32px; height: 32px; border-radius: 50%; cursor: pointer;
            font-size: 18px; transition: all 0.2s ease; z-index: 5001;
        }
        .viewer-close:hover { background: rgba(255,255,255,0.3); }
        .viewer-mode-toggle {
            display: flex; gap: 6px; margin-bottom: 16px;
        }
        .viewer-mode-btn {
            padding: 8px 16px; border-radius: 16px; font-size: 12px; font-weight: 600;
            cursor: pointer; border: 2px solid rgba(255,255,255,0.3); background: transparent;
            color: white; transition: all 0.2s ease;
        }
        .viewer-mode-btn.active { background: var(--color-accent); border-color: var(--color-accent); }
        .viewer-content-wrapper {
            display: flex; gap: 16px; align-items: center; justify-content: center;
        }
        .viewer-single { display: flex; flex-direction: column; align-items: center; }
        .viewer-compare { display: none; gap: 16px; align-items: flex-start; }
        .viewer-compare.active { display: flex; }
        .viewer-single.active { display: flex; }
        .viewer-single:not(.active) { display: none; }
        .viewer-box {
            background: rgba(255,255,255,0.05); border-radius: 10px; padding: 16px;
            max-width: 380px; text-align: center; cursor: pointer;
            transition: all 0.2s ease; border: 2px solid transparent;
        }
        .viewer-box:hover { background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.2); }
        .viewer-box-label {
            font-size: 11px; font-weight: 600; text-transform: uppercase;
            letter-spacing: 1px; margin-bottom: 10px; padding: 5px 14px;
            border-radius: 16px; display: inline-block;
        }
        .viewer-box.before .viewer-box-label { background: #e74c3c; color: white; }
        .viewer-box.after .viewer-box-label { background: var(--color-success); color: white; }
        .viewer-media {
            max-width: 100%; max-height: 50vh; border-radius: 8px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.3); cursor: pointer;
            transition: transform 0.2s ease;
        }
        .viewer-media:hover { transform: scale(1.02); }
        .viewer-box-hint { font-size: 10px; color: rgba(255,255,255,0.4); margin-top: 8px; }

        /* Fullscreen Image Overlay */
        .fullscreen-overlay {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.95); z-index: 6000;
            justify-content: center; align-items: center; cursor: zoom-out;
        }
        .fullscreen-overlay.active { display: flex; }
        .fullscreen-media { max-width: 95vw; max-height: 95vh; border-radius: 8px; }
        .viewer-arrow { font-size: 28px; color: var(--color-accent); }
        .viewer-title { color: white; font-size: 16px; margin-top: 16px; text-align: center; font-weight: 600; }
        .viewer-description { color: rgba(255,255,255,0.7); font-size: 13px; margin-top: 6px; max-width: 500px; text-align: center; }
        .viewer-upload-hint {
            color: rgba(255,255,255,0.5); font-size: 11px; margin-top: 12px;
            display: flex; gap: 12px; justify-content: center;
        }
        .viewer-upload-btn {
            background: rgba(255,255,255,0.1); border: 1px dashed rgba(255,255,255,0.3);
            color: white; padding: 6px 12px; border-radius: 6px; cursor: pointer;
            font-size: 11px; transition: all 0.2s ease;
        }
        .viewer-upload-btn:hover { background: rgba(255,255,255,0.2); }
        .no-media-placeholder {
            width: 200px; height: 150px; background: rgba(255,255,255,0.05);
            border: 2px dashed rgba(255,255,255,0.2); border-radius: 10px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: rgba(255,255,255,0.5); cursor: pointer; transition: all 0.2s ease;
        }
        .no-media-placeholder:hover { background: rgba(255,255,255,0.1); border-color: var(--color-accent); }
        .no-media-placeholder span { font-size: 36px; margin-bottom: 6px; }

        /* Hero Section */
        .hero {
            background: linear-gradient(165deg, var(--color-primary) 0%, var(--color-primary-light) 100%);
            color: white; padding: 80px 0 100px; position: relative; overflow: hidden;
        }
        .hero::before {
            content: ''; position: absolute; top: 0; right: 0; width: 50%; height: 100%;
            background: radial-gradient(ellipse at 80% 20%, rgba(59, 125, 216, 0.15) 0%, transparent 60%);
        }
        .hero-content { position: relative; z-index: 1; }
        .hero-badge {
            display: inline-block; background: rgba(255, 255, 255, 0.15);
            padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: 500;
            margin-bottom: 24px; backdrop-filter: blur(4px);
        }
        .hero h1 { font-size: clamp(24px, 4vw, 36px); font-weight: 700; line-height: 1.4; margin-bottom: 16px; letter-spacing: -0.02em; }
        .hero-subtitle { font-size: 16px; opacity: 0.85; margin-bottom: 48px; line-height: 1.8; }
        .hero-subtitle p { margin-bottom: 4px; }
        .summary-cards { display: grid; grid-template-columns: repeat(6, 1fr); gap: 10px; }
        .summary-card {
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.15); border-radius: var(--radius);
            padding: 16px 12px; text-align: center; cursor: pointer; transition: all 0.3s ease;
        }
        .summary-card:hover { background: rgba(255, 255, 255, 0.2); transform: translateY(-4px); }
        .summary-card-number { font-size: 10px; opacity: 0.7; margin-bottom: 6px; }
        .summary-card-icon { font-size: 20px; margin-bottom: 6px; }
        .summary-card-title { font-size: 11px; font-weight: 500; opacity: 0.95; }

        /* Sections */
        .section { padding: 80px 0; }
        .section-header { margin-bottom: 48px; }
        .section-number {
            display: inline-block; width: 32px; height: 32px;
            background: var(--color-accent-light); color: var(--color-accent);
            border-radius: 50%; font-size: 14px; font-weight: 600;
            line-height: 32px; text-align: center; margin-bottom: 16px;
        }
        .section-title { font-size: clamp(22px, 3vw, 28px); font-weight: 700; color: var(--color-primary); margin-bottom: 12px; letter-spacing: -0.02em; }
        .section-desc { font-size: 15px; color: var(--color-text-light); max-width: 600px; }

        /* Clickable Items */
        .clickable-item { transition: all 0.2s ease; position: relative; cursor: default; }
        .clickable-item:hover { box-shadow: var(--shadow-md); }
        .item-buttons {
            position: absolute; top: 8px; right: 8px;
            display: flex; gap: 6px; opacity: 0; transition: opacity 0.2s ease; z-index: 10;
        }
        .clickable-item:hover .item-buttons { opacity: 1; }
        .item-btn {
            padding: 6px 12px; border-radius: 6px; font-size: 11px; font-weight: 600;
            cursor: pointer; border: none; transition: all 0.2s ease;
        }
        .item-btn-view { background: var(--color-success); color: white; }
        .item-btn-view:hover { background: #219a52; }
        .item-btn-edit { background: var(--color-accent); color: white; }
        .item-btn-edit:hover { background: var(--color-primary); }
        .item-btn-view.no-media { background: #ccc; cursor: not-allowed; }

        /* Cards */
        .card {
            background: var(--color-card); border-radius: var(--radius);
            box-shadow: var(--shadow-sm); border: 1px solid var(--color-border);
            padding: 28px; margin-bottom: 20px; transition: all 0.3s ease; position: relative;
        }
        .card:hover { box-shadow: var(--shadow-md); }
        .card-title {
            font-size: 17px; font-weight: 600; color: var(--color-primary);
            margin-bottom: 12px; display: flex; align-items: center; gap: 10px;
        }
        .card-title-icon {
            width: 36px; height: 36px; background: var(--color-accent-light);
            border-radius: var(--radius-sm); display: flex; align-items: center;
            justify-content: center; font-size: 18px;
        }
        .card-content { font-size: 15px; color: var(--color-text-light); }

        /* Grid layouts */
        .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; }
        .grid-6 { display: grid; grid-template-columns: repeat(6, 1fr); gap: 12px; }

        /* Step cards for Í≥µÍµ¨Í¥ÄÎ¶¨ */
        .step-card {
            background: var(--color-card); border-radius: var(--radius);
            box-shadow: var(--shadow-sm); border: 1px solid var(--color-border);
            padding: 20px; text-align: center; position: relative; transition: all 0.2s ease;
        }
        .step-card:hover { box-shadow: var(--shadow-md); transform: translateY(-2px); }
        .step-number {
            width: 32px; height: 32px; background: var(--color-orange); color: white;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 14px; font-weight: 700; margin: 0 auto 12px;
        }
        .step-title { font-size: 13px; font-weight: 600; color: var(--color-primary); margin-bottom: 4px; }
        .step-desc { font-size: 11px; color: var(--color-text-light); }
        .step-badge {
            position: absolute; top: -8px; right: -8px;
            background: #9b59b6; color: white; font-size: 9px; padding: 2px 8px;
            border-radius: 10px; font-weight: 600;
        }

        /* Problem Item */
        .problem-item {
            display: flex; align-items: flex-start; gap: 12px;
            padding: 12px 0; border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .problem-item:last-child { border-bottom: none; padding-bottom: 0; }
        .problem-text { flex: 1; }
        .problem-text strong { display: block; font-size: 15px; color: var(--color-text); margin-bottom: 2px; }
        .problem-text span { font-size: 13px; color: var(--color-text-light); }

        /* Before After */
        .before-after {
            display: grid; grid-template-columns: 1fr auto 1fr;
            gap: 24px; align-items: center; margin-bottom: 32px;
        }
        .before-box, .after-box { padding: 24px; border-radius: var(--radius); }
        .before-box { background: #f8f9fa; border: 1px dashed #d1d5db; }
        .after-box { background: linear-gradient(135deg, var(--color-accent-light) 0%, #f0f7ff 100%); border: 1px solid #c5ddf8; }
        .ba-label { font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 12px; }
        .before-box .ba-label { color: #9ca3af; }
        .after-box .ba-label { color: var(--color-accent); display: flex; align-items: center; justify-content: space-between; gap: 12px; }
        .admin-link {
            font-size: 12px; font-weight: 500; color: var(--color-accent);
            text-decoration: none; background: white; padding: 6px 12px;
            border-radius: 16px; border: 1px solid var(--color-accent);
            transition: all 0.2s ease; text-transform: none; letter-spacing: 0;
        }
        .admin-link:hover { background: var(--color-accent); color: white; }
        .ba-list { list-style: none; }
        .ba-list li {
            font-size: 14px; padding: 8px 10px; display: flex; align-items: center; gap: 8px;
            border-radius: 6px; margin-bottom: 4px; position: relative; transition: background 0.2s ease;
        }
        .ba-list li:hover { background: rgba(0,0,0,0.03); }
        .arrow-divider { color: var(--color-accent); font-size: 24px; }

        /* Feature cards */
        .feature-card { text-align: center; padding: 24px 16px; }
        .feature-icon {
            width: 48px; height: 48px; background: var(--color-accent-light);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 22px; margin: 0 auto 16px;
        }
        .feature-title { font-size: 14px; font-weight: 600; color: var(--color-primary); margin-bottom: 8px; }
        .feature-desc { font-size: 13px; color: var(--color-text-light); }

        /* Highlight box */
        .highlight-box {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-light) 100%);
            color: white; padding: 24px 28px; border-radius: var(--radius); margin-top: 24px;
        }
        .highlight-box p { font-size: 15px; line-height: 1.7; }
        .highlight-box strong { font-weight: 600; }

        /* Stat cards */
        .stat-card { text-align: center; padding: 28px 20px; }
        .stat-value { font-size: 32px; font-weight: 700; color: var(--color-primary); margin-bottom: 4px; }
        .stat-label { font-size: 13px; color: var(--color-text-light); }

        /* Pipeline */
        .pipeline { display: flex; justify-content: space-between; position: relative; margin: 32px 0; }
        .pipeline::before {
            content: ''; position: absolute; top: 28px; left: 60px; right: 60px;
            height: 3px; background: var(--color-border);
        }
        .pipeline-step {
            text-align: center; position: relative; z-index: 1; flex: 1;
            padding: 8px; border-radius: var(--radius); transition: background 0.2s ease;
        }
        .pipeline-step:hover { background: rgba(59, 125, 216, 0.05); }
        .pipeline-number {
            width: 56px; height: 56px; background: var(--color-card);
            border: 3px solid var(--color-accent); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 20px; font-weight: 700; color: var(--color-accent); margin: 0 auto 12px;
        }
        .pipeline-label { font-size: 13px; color: var(--color-text-light); margin-bottom: 4px; }
        .pipeline-value { font-size: 15px; font-weight: 600; color: var(--color-primary); }

        /* Mini cards */
        .mini-card { display: flex; align-items: center; gap: 16px; padding: 20px; }
        .mini-icon {
            width: 44px; height: 44px; background: var(--color-accent-light);
            border-radius: var(--radius-sm); display: flex; align-items: center;
            justify-content: center; font-size: 20px; flex-shrink: 0;
        }
        .mini-text { flex: 1; }
        .mini-title { font-size: 14px; font-weight: 600; color: var(--color-primary); margin-bottom: 2px; }
        .mini-desc { font-size: 13px; color: var(--color-text-light); }

        /* Sub Section */
        .sub-section { background: var(--color-bg); border-radius: var(--radius); padding: 24px; margin-bottom: 24px; }
        .sub-section-title {
            font-size: 16px; font-weight: 600; color: var(--color-primary);
            margin-bottom: 16px; display: flex; align-items: center; gap: 8px;
        }
        .sub-section-badge {
            background: var(--color-accent-light); color: var(--color-accent);
            padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;
        }

        /* Final Section */
        .final-section { background: var(--color-primary); color: white; padding: 80px 0; text-align: center; }
        .final-quote { font-size: clamp(20px, 3vw, 26px); font-weight: 600; margin-bottom: 40px; line-height: 1.5; }
        .next-steps {
            display: inline-flex; flex-direction: column; gap: 12px; text-align: left;
            background: rgba(255, 255, 255, 0.1); padding: 28px 36px;
            border-radius: var(--radius); backdrop-filter: blur(8px);
        }
        .next-step { display: flex; align-items: center; gap: 12px; font-size: 15px; }
        .next-step-icon {
            width: 24px; height: 24px; background: var(--color-accent); border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-size: 12px;
        }

        /* Divider */
        .divider { height: 1px; background: var(--color-border); margin: 0; }

        /* Script Section */
        .script-section { background: #1a1a2e; color: #e0e0e0; padding: 60px 0; }
        .script-header { text-align: center; margin-bottom: 48px; }
        .script-header h2 { font-size: 24px; color: white; margin-bottom: 8px; }
        .script-header p { color: #888; font-size: 14px; }
        .script-card { background: #252542; border-radius: var(--radius); padding: 24px; margin-bottom: 20px; }
        .script-card-header {
            display: flex; align-items: center; gap: 12px;
            margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid #3a3a5c;
        }
        .script-number {
            background: var(--color-accent); color: white; width: 28px; height: 28px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 13px; font-weight: 600;
        }
        .script-title { font-size: 16px; font-weight: 600; color: white; }
        .script-time {
            margin-left: auto; background: rgba(255,255,255,0.1);
            padding: 4px 12px; border-radius: 12px; font-size: 12px; color: #aaa;
        }
        .script-content { font-size: 14px; line-height: 2; color: #ccc; }
        .script-content p { margin-bottom: 12px; }
        .script-highlight { background: rgba(59, 125, 216, 0.2); color: #7eb3ff; padding: 2px 6px; border-radius: 4px; }
        .script-action { color: #f39c12; font-style: italic; }
        .print-btn {
            background: var(--color-accent); color: white; border: none;
            padding: 14px 32px; border-radius: 8px; font-size: 15px; font-weight: 600;
            cursor: pointer; margin-top: 32px;
        }
        .print-btn:hover { background: var(--color-primary); }

        /* Edit Modal */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.7); z-index: 4000; justify-content: center; align-items: center;
        }
        .modal-overlay.active { display: flex; }
        .modal-content {
            background: white; border-radius: var(--radius);
            max-width: 700px; width: 90%; max-height: 90vh; overflow: hidden;
        }
        .modal-header {
            padding: 20px 24px; border-bottom: 1px solid var(--color-border);
            display: flex; justify-content: space-between; align-items: center;
        }
        .modal-header h3 { font-size: 18px; color: var(--color-primary); }
        .modal-close { background: none; border: none; font-size: 24px; cursor: pointer; color: var(--color-text-light); }
        .modal-body { padding: 24px; overflow-y: auto; max-height: 70vh; }
        .mode-selector { display: flex; gap: 12px; margin-bottom: 24px; }
        .mode-btn {
            flex: 1; padding: 16px; border: 2px solid var(--color-border); border-radius: var(--radius-sm);
            background: white; cursor: pointer; text-align: center; transition: all 0.2s ease;
        }
        .mode-btn:hover { border-color: var(--color-accent); }
        .mode-btn.active { border-color: var(--color-accent); background: var(--color-accent-light); }
        .mode-btn-icon { font-size: 24px; margin-bottom: 8px; }
        .mode-btn-title { font-size: 14px; font-weight: 600; color: var(--color-primary); }
        .mode-btn-desc { font-size: 11px; color: var(--color-text-light); }
        .media-upload-section { margin-bottom: 20px; }
        .media-upload-section label { display: block; font-size: 14px; font-weight: 600; color: var(--color-text); margin-bottom: 8px; }
        .media-preview-box {
            background: #f8f9fa; border: 2px dashed var(--color-border); border-radius: var(--radius-sm);
            height: 150px; display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; transition: all 0.2s ease; overflow: hidden;
        }
        .media-preview-box:hover { border-color: var(--color-accent); background: var(--color-accent-light); }
        .media-preview-box img, .media-preview-box video { max-width: 100%; max-height: 100%; object-fit: contain; }
        .media-preview-text { color: var(--color-text-light); font-size: 12px; }
        .compare-uploads { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-size: 14px; font-weight: 600; color: var(--color-text); margin-bottom: 8px; }
        .form-group input, .form-group textarea {
            width: 100%; padding: 12px; border: 1px solid var(--color-border);
            border-radius: var(--radius-sm); font-size: 14px; font-family: inherit;
        }
        .form-group textarea { min-height: 80px; resize: vertical; }
        .modal-footer {
            padding: 16px 24px; border-top: 1px solid var(--color-border);
            display: flex; gap: 12px; justify-content: flex-end;
        }
        .btn { padding: 10px 20px; border-radius: var(--radius-sm); font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
        .btn-secondary { background: var(--color-bg); border: 1px solid var(--color-border); color: var(--color-text); }
        .btn-primary { background: var(--color-accent); border: none; color: white; }
        .btn-primary:hover { background: var(--color-primary); }

        /* Items Editor - Per-item Media Support */
        .items-list { margin-bottom: 12px; }
        .item-edit-row {
            padding: 16px; background: #f8f9fa; border-radius: 10px;
            margin-bottom: 12px; border: 1px solid var(--color-border);
        }
        .item-edit-row:hover { border-color: var(--color-accent); }
        .item-edit-header {
            display: flex !important;
            flex-direction: row !important;
            gap: 10px;
            align-items: flex-start;
            margin-bottom: 12px;
            width: 100%;
        }
        .item-edit-emoji {
            width: 50px !important;
            min-width: 50px !important;
            max-width: 50px !important;
            height: 44px;
            border: 1px solid var(--color-border);
            border-radius: 6px;
            text-align: center;
            font-size: 20px;
            background: white;
            cursor: pointer;
            flex: 0 0 50px !important;
        }
        .item-edit-fields {
            flex: 1 1 auto !important;
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-width: 0;
            width: calc(100% - 110px) !important;
        }
        .item-edit-title,
        .item-edit-desc {
            width: 100% !important;
            padding: 12px 14px !important;
            border: 1px solid var(--color-border) !important;
            border-radius: 6px;
            font-size: 14px;
            box-sizing: border-box !important;
            display: block !important;
        }
        .item-edit-title {
            font-weight: 600;
        }
        .item-edit-desc {
            color: var(--color-text-light);
        }
        .item-edit-delete {
            width: 40px !important;
            min-width: 40px !important;
            max-width: 40px !important;
            height: 40px;
            border: none;
            background: #fee2e2;
            color: #dc2626;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            flex: 0 0 40px !important;
        }
        .item-edit-delete:hover { background: #fecaca; }
        .item-media-section {
            background: white; border-radius: 8px; padding: 12px;
            border: 1px solid var(--color-border);
        }
        .item-media-header {
            display: flex; align-items: center; gap: 8px; margin-bottom: 10px;
        }
        .item-media-label { font-size: 12px; font-weight: 600; color: var(--color-text); }
        .item-mode-toggle {
            display: flex; gap: 4px; margin-left: auto;
        }
        .item-mode-btn {
            padding: 4px 10px; font-size: 10px; border-radius: 12px;
            border: 1px solid var(--color-border); background: white;
            cursor: pointer; transition: all 0.2s ease;
        }
        .item-mode-btn.active { background: var(--color-accent); color: white; border-color: var(--color-accent); }
        .item-media-uploads { display: flex; gap: 8px; }
        .item-media-box {
            flex: 1; height: 80px; border: 2px dashed var(--color-border);
            border-radius: 6px; display: flex; flex-direction: column;
            align-items: center; justify-content: center; cursor: pointer;
            transition: all 0.2s ease; overflow: hidden; background: #fafbfc;
        }
        .item-media-box:hover { border-color: var(--color-accent); background: var(--color-accent-light); }
        .item-media-box img, .item-media-box video { max-width: 100%; max-height: 100%; object-fit: contain; }
        .item-media-box span { font-size: 18px; }
        .item-media-box p { font-size: 9px; color: var(--color-text-light); margin-top: 2px; }
        .item-media-box.before-box { border-color: #e74c3c; }
        .item-media-box.after-box { border-color: #27ae60; }
        .item-media-box.paste-target { border-color: var(--color-accent); box-shadow: 0 0 8px var(--color-accent); }
        .btn-add-item {
            width: 100%; padding: 12px; border: 2px dashed var(--color-border);
            background: transparent; border-radius: 8px; color: var(--color-accent);
            font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s ease;
        }
        .btn-add-item:hover { border-color: var(--color-accent); background: var(--color-accent-light); }

        /* Descriptions Editor - Multiple Descriptions Support */
        .descriptions-list { margin-bottom: 12px; }
        .desc-edit-row {
            padding: 16px; background: #f8f9fa; border-radius: 10px;
            margin-bottom: 12px; border: 1px solid var(--color-border);
        }
        .desc-edit-row:hover { border-color: var(--color-accent); }
        .desc-edit-header {
            display: flex; align-items: center; gap: 10px; margin-bottom: 12px;
        }
        .desc-title-input {
            flex: 1; font-weight: 600; font-size: 13px; color: var(--color-text);
            padding: 8px 12px; border: 1px solid var(--color-border); border-radius: 6px;
            background: white;
        }
        .desc-title-input:focus {
            border-color: var(--color-accent); outline: none;
        }
        .desc-edit-delete {
            width: 32px; height: 32px; border: none; background: #fee2e2;
            color: #dc2626; border-radius: 6px; cursor: pointer; font-size: 14px;
        }
        .desc-edit-delete:hover { background: #fecaca; }
        .desc-media-section {
            background: white; border-radius: 8px; padding: 12px;
            border: 1px solid var(--color-border); margin-bottom: 12px;
        }
        .desc-media-header {
            display: flex; align-items: center; gap: 8px; margin-bottom: 10px;
        }
        .desc-media-label { font-size: 12px; font-weight: 600; color: var(--color-text); }
        .desc-mode-toggle { display: flex; gap: 4px; margin-left: auto; }
        .desc-mode-btn {
            padding: 4px 10px; font-size: 10px; border-radius: 12px;
            border: 1px solid var(--color-border); background: white;
            cursor: pointer; transition: all 0.2s ease;
        }
        .desc-mode-btn.active { background: var(--color-accent); color: white; border-color: var(--color-accent); }
        .desc-media-uploads { display: flex; gap: 8px; }
        .desc-media-box {
            flex: 1; height: 100px; border: 2px dashed var(--color-border);
            border-radius: 6px; display: flex; flex-direction: column;
            align-items: center; justify-content: center; cursor: pointer;
            transition: all 0.2s ease; overflow: hidden; background: #fafbfc;
        }
        .desc-media-box:hover { border-color: var(--color-accent); background: var(--color-accent-light); }
        .desc-media-box img, .desc-media-box video { max-width: 100%; max-height: 100%; object-fit: contain; }
        .desc-media-box span { font-size: 18px; }
        .desc-media-box p { font-size: 9px; color: var(--color-text-light); margin-top: 2px; }
        .desc-media-box.before-box { border-color: #e74c3c; }
        .desc-media-box.after-box { border-color: #27ae60; }
        .desc-media-box.paste-target { border-color: var(--color-accent); box-shadow: 0 0 8px var(--color-accent); }
        .desc-text-area {
            width: 100%; padding: 12px; border: 1px solid var(--color-border);
            border-radius: 6px; font-size: 14px; resize: vertical; min-height: 60px;
            box-sizing: border-box;
        }
        .desc-text-area:focus { border-color: var(--color-accent); outline: none; }

        /* Presentation Mode (Hide Edit Buttons) */
        body.presentation-mode .item-buttons,
        body.presentation-mode .modal-overlay,
        body.presentation-mode .viewer-upload-hint { display: none !important; }
        body.presentation-mode .clickable-item { cursor: pointer; }

        /* Item Viewer Modal */
        .item-viewer-overlay {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.85); z-index: 5000;
            justify-content: center; align-items: center; flex-direction: column;
        }
        .item-viewer-overlay.active { display: flex; }
        .item-viewer-container {
            background: #1a1a2e; border-radius: 16px; padding: 24px;
            max-width: 900px; width: 90%; max-height: 85vh;
            display: flex; flex-direction: column; align-items: center;
            position: relative; box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        .item-viewer-close {
            position: absolute; top: 12px; right: 12px;
            background: rgba(255,255,255,0.15); border: none; color: white;
            width: 32px; height: 32px; border-radius: 50%; cursor: pointer;
            font-size: 18px; transition: all 0.2s ease; z-index: 5001;
        }
        .item-viewer-close:hover { background: rgba(255,255,255,0.3); }
        .item-viewer-info {
            color: white; text-align: center; margin-bottom: 16px;
        }
        .item-viewer-info h4 { font-size: 18px; margin-bottom: 4px; }
        .item-viewer-info p { font-size: 13px; color: rgba(255,255,255,0.7); }

        /* Animation */
        .fade-in { opacity: 0; transform: translateY(30px); transition: opacity 0.6s ease, transform 0.6s ease; }
        .fade-in.visible { opacity: 1; transform: translateY(0); }

        /* Responsive */
        @media (max-width: 768px) {
            .summary-cards { grid-template-columns: repeat(3, 1fr); }
            .grid-2, .grid-3, .grid-4, .grid-6 { grid-template-columns: 1fr; }
            .before-after { grid-template-columns: 1fr; }
            .arrow-divider { transform: rotate(90deg); margin: 8px 0; }
            .pipeline { flex-direction: column; gap: 24px; }
            .pipeline::before { display: none; }
            .section { padding: 60px 0; }
            .hero { padding: 60px 0 80px; }
            .item-buttons { opacity: 1; }
            .viewer-content-wrapper { flex-direction: column; }
            .viewer-compare { flex-direction: column; }
        }

        @media print {
            .fade-in { opacity: 1 !important; transform: none !important; }
            .script-section .print-btn, .item-buttons { display: none !important; }
            .script-section { background: white !important; color: black !important; }
            .script-card { background: #f5f5f5 !important; page-break-inside: avoid; }
            .script-content { color: black !important; }
        }

        /* Ìé∏Ïßë ÏôÑÎ£å & Í≥µÏú† ÎßÅÌÅ¨ Î≤ÑÌäº */
        .top-action-bar {
            position: fixed; top: 16px; right: 16px; z-index: 4000;
            display: flex; gap: 10px; align-items: center;
        }
        .top-action-btn {
            padding: 10px 18px; border-radius: 8px; font-size: 13px; font-weight: 600;
            cursor: pointer; border: none; transition: all 0.2s ease;
            display: flex; align-items: center; gap: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .top-action-btn.save-btn {
            background: var(--color-success); color: white;
        }
        .top-action-btn.save-btn:hover { background: #219a52; transform: translateY(-2px); }
        .top-action-btn.share-btn {
            background: var(--color-accent); color: white;
        }
        .top-action-btn.share-btn:hover { background: var(--color-primary); transform: translateY(-2px); }
        .top-action-bar.hidden { display: none; }

        /* Í≥µÏú† ÎßÅÌÅ¨ Î™®Îã¨ */
        .share-modal-overlay {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.7); z-index: 5500;
            justify-content: center; align-items: center;
        }
        .share-modal-overlay.active { display: flex; }
        .share-modal {
            background: white; border-radius: 16px; padding: 32px;
            max-width: 500px; width: 90%; box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .share-modal h3 { font-size: 20px; margin-bottom: 8px; color: var(--color-primary); }
        .share-modal p { font-size: 14px; color: var(--color-text-light); margin-bottom: 20px; }
        .share-link-box {
            background: #f5f7fa; border: 1px solid var(--color-border); border-radius: 8px;
            padding: 12px; display: flex; align-items: center; gap: 10px;
        }
        .share-link-box input {
            flex: 1; border: none; background: transparent; font-size: 13px;
            color: var(--color-text); outline: none;
        }
        .share-link-box button {
            padding: 8px 16px; background: var(--color-accent); color: white;
            border: none; border-radius: 6px; font-size: 12px; font-weight: 600;
            cursor: pointer; transition: all 0.2s ease;
        }
        .share-link-box button:hover { background: var(--color-primary); }
        .share-modal-close {
            margin-top: 20px; width: 100%; padding: 12px;
            background: #f0f0f0; border: none; border-radius: 8px;
            font-size: 14px; cursor: pointer; transition: all 0.2s ease;
        }
        .share-modal-close:hover { background: #e0e0e0; }
        .share-info {
            display: flex; flex-direction: column; gap: 8px; margin-bottom: 20px;
            padding: 16px; background: #f0f7ff; border-radius: 8px;
        }
        .share-info-item {
            display: flex; align-items: center; gap: 8px; font-size: 13px; color: var(--color-text);
        }
        .share-info-item span:first-child { font-size: 16px; }

        /* ÌôïÎåÄ Î™®Îã¨ (ÏÉÅÏÑ∏ Î≥¥Í∏∞) */
        .detail-modal-overlay {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.85); z-index: 5200;
            justify-content: center; align-items: center; padding: 20px;
        }
        .detail-modal-overlay.active { display: flex; }
        .detail-modal {
            background: #1a1a2e; border-radius: 16px; padding: 32px;
            max-width: 900px; width: 100%; max-height: 90vh; overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5); position: relative;
        }
        .detail-modal-close {
            position: absolute; top: 16px; right: 16px;
            background: rgba(255,255,255,0.15); border: none; color: white;
            width: 36px; height: 36px; border-radius: 50%; cursor: pointer;
            font-size: 20px; transition: all 0.2s ease;
        }
        .detail-modal-close:hover { background: rgba(255,255,255,0.3); }
        .detail-modal-title {
            color: white; font-size: 24px; font-weight: 700; margin-bottom: 8px;
        }
        .detail-modal-desc {
            color: rgba(255,255,255,0.7); font-size: 14px; margin-bottom: 24px;
        }
        .detail-section {
            background: rgba(255,255,255,0.05); border-radius: 12px; padding: 20px;
            margin-bottom: 16px;
        }
        .detail-section-header {
            display: flex; align-items: center; gap: 10px; margin-bottom: 16px;
            padding-bottom: 12px; border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .detail-section-badge {
            background: var(--color-accent); color: white; padding: 4px 12px;
            border-radius: 12px; font-size: 12px; font-weight: 600;
        }
        .detail-section-title {
            color: white; font-size: 16px; font-weight: 600;
        }
        .detail-item {
            display: flex; align-items: flex-start; gap: 12px; padding: 12px;
            background: rgba(255,255,255,0.03); border-radius: 8px; margin-bottom: 8px;
            transition: all 0.2s ease; cursor: pointer;
        }
        .detail-item:hover { background: rgba(255,255,255,0.08); }
        .detail-item-icon { font-size: 24px; }
        .detail-item-content { flex: 1; }
        .detail-item-title {
            color: white; font-size: 15px; font-weight: 600; margin-bottom: 4px;
        }
        .detail-item-desc {
            color: rgba(255,255,255,0.6); font-size: 13px;
        }
        .detail-item-media {
            width: 80px; height: 60px; border-radius: 6px; object-fit: cover;
            background: rgba(255,255,255,0.1);
        }
        .detail-media-section {
            margin-top: 20px; display: flex; gap: 16px; justify-content: center;
            flex-wrap: wrap;
        }
        .detail-media-box {
            background: rgba(255,255,255,0.05); border-radius: 12px; padding: 16px;
            text-align: center; cursor: pointer; transition: all 0.2s ease;
            border: 2px solid transparent;
        }
        .detail-media-box:hover { background: rgba(255,255,255,0.1); border-color: var(--color-accent); }
        .detail-media-label {
            display: inline-block; padding: 4px 12px; border-radius: 12px;
            font-size: 11px; font-weight: 600; margin-bottom: 10px;
        }
        .detail-media-box.before .detail-media-label { background: #e74c3c; color: white; }
        .detail-media-box.after .detail-media-label { background: var(--color-success); color: white; }
        .detail-media-img {
            width: 300px; height: 240px; object-fit: cover; border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3); cursor: pointer;
            transition: transform 0.2s ease;
        }
        .detail-media-img:hover { transform: scale(1.02); }
        .detail-media-img.video { object-fit: contain; background: #000; }
        .detail-media-row {
            display: flex; gap: 20px; align-items: center; justify-content: center;
            flex-wrap: nowrap; overflow-x: auto; padding: 8px 0;
        }

        /* ÏÜåÎ∂ÑÎ•ò ÌÅ¥Î¶≠ Ïä§ÌÉÄÏùº */
        .sub-section-title { cursor: pointer; transition: all 0.2s ease; }
        .sub-section-title:hover { color: var(--color-accent); }
        body.presentation-mode .sub-section-title { cursor: pointer; }
        .toast {
            position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%);
            background: #333; color: white; padding: 12px 24px; border-radius: 8px;
            font-size: 14px; z-index: 9999; opacity: 0; transition: opacity 0.3s ease;
        }
        .toast.show { opacity: 1; }
    </style>
</head>
<body>
    <!-- Ìé∏Ïßë ÏôÑÎ£å & Í≥µÏú† ÎßÅÌÅ¨ Î≤ÑÌäº -->
    <div class="top-action-bar" id="topActionBar">
        <button class="top-action-btn save-btn" onclick="completeEditing()">
            <span>‚úì</span> Ìé∏Ïßë ÏôÑÎ£å
        </button>
        <button class="top-action-btn share-btn" onclick="openShareModal()">
            <span>üîó</span> Í≥µÏú† ÎßÅÌÅ¨
        </button>
    </div>

    <!-- Í≥µÏú† ÎßÅÌÅ¨ Î™®Îã¨ -->
    <div class="share-modal-overlay" id="shareModalOverlay">
        <div class="share-modal">
            <h3>üîó Í≥µÏú† ÎßÅÌÅ¨</h3>
            <p>ÏïÑÎûò ÎßÅÌÅ¨Î•º Í≥µÏú†ÌïòÎ©¥ ÌòÑÏû¨ Ìé∏ÏßëÌïú ÎÇ¥Ïö©ÏùÑ Îã§Î•∏ ÏÇ¨ÎûåÏù¥ Î≥º Ïàò ÏûàÏäµÎãàÎã§.</p>
            <div class="share-info">
                <div class="share-info-item"><span>üëÅ</span> ÏùΩÍ∏∞ Ï†ÑÏö©ÏúºÎ°ú Í≥µÏú†Îê©ÎãàÎã§</div>
                <div class="share-info-item"><span>üîÑ</span> Ï∂îÍ∞Ä Ìé∏Ïßë Ïãú Ïã§ÏãúÍ∞Ñ Î∞òÏòÅÎê©ÎãàÎã§</div>
                <div class="share-info-item"><span>üîê</span> ÎßÅÌÅ¨Î•º ÏïÑÎäî ÏÇ¨ÎûåÎßå Ï†ëÍ∑º Í∞ÄÎä•</div>
            </div>
            <div class="share-link-box">
                <input type="text" id="shareLinkInput" readonly placeholder="Í≥µÏú† ÎßÅÌÅ¨Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§">
                <div id="shareActions" style="display: none; gap: 6px;">
                    <button onclick="copyShareLink()">Î≥µÏÇ¨</button>
                </div>
                <button id="generateShareBtn" onclick="generateNewShareLink()" style="display: block;">ÏÉùÏÑ±</button>
            </div>
            <button class="share-modal-close" onclick="closeShareModal()">Îã´Í∏∞</button>
        </div>
    </div>

    <!-- ÏÉÅÏÑ∏ Î≥¥Í∏∞ Î™®Îã¨ -->
    <div class="detail-modal-overlay" id="detailModalOverlay">
        <div class="detail-modal">
            <button class="detail-modal-close" onclick="closeDetailModal()">‚úï</button>
            <div class="detail-modal-title" id="detailModalTitle"></div>
            <div class="detail-modal-desc" id="detailModalDesc"></div>
            <div id="detailModalContent"></div>
        </div>
    </div>

    <!-- Toast ÏïåÎ¶º -->
    <div class="toast" id="toast"></div>

    <!-- Î°úÎî© Ïò§Î≤ÑÎ†àÏù¥ -->
    <div id="loadingOverlay" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 9999; justify-content: center; align-items: center; flex-direction: column;">
        <div style="background: white; padding: 32px 48px; border-radius: 16px; text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
            <div style="width: 50px; height: 50px; border: 4px solid #e0e0e0; border-top-color: var(--color-accent); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 16px;"></div>
            <div id="loadingText" style="font-size: 16px; font-weight: 600; color: var(--color-primary);">Ï†ÄÏû• Ï§ë...</div>
            <div id="loadingSubText" style="font-size: 13px; color: var(--color-text-light); margin-top: 4px;">ÎØ∏ÎîîÏñ¥Î•º ÏóÖÎ°úÎìúÌïòÍ≥† ÏûàÏäµÎãàÎã§</div>
        </div>
    </div>
    <style>
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>

    <!-- Media Viewer Modal -->
    <div class="viewer-overlay" id="viewerOverlay">
        <div class="viewer-container" id="viewerContainer">
            <button class="viewer-close" onclick="closeViewer()">‚úï</button>
            <div class="viewer-mode-toggle" id="viewerModeToggle">
                <button class="viewer-mode-btn" data-mode="single" onclick="switchViewerMode('single')">üì∑ ÏùºÎ∞ò</button>
                <button class="viewer-mode-btn" data-mode="compare" onclick="switchViewerMode('compare')">‚ö° Ï†Ñ/ÌõÑ ÎπÑÍµê</button>
            </div>
            <div class="viewer-content-wrapper">
                <div class="viewer-single active" id="viewerSingle">
                    <div id="viewerSingleMedia"></div>
                    <div class="viewer-box-hint" id="singleHint" style="margin-top: 8px;">üîç ÌÅ¥Î¶≠ÌïòÏó¨ ÌÅ¨Í≤å Î≥¥Í∏∞</div>
                </div>
                <div class="viewer-compare" id="viewerCompare">
                    <div class="viewer-box before" onclick="openFullscreen('before', event)">
                        <div class="viewer-box-label">BEFORE</div>
                        <div id="viewerBeforeMedia"></div>
                        <div class="viewer-box-hint">üîç ÌÅ¥Î¶≠ÌïòÏó¨ ÌÅ¨Í≤å Î≥¥Í∏∞</div>
                    </div>
                    <div class="viewer-arrow">‚Üí</div>
                    <div class="viewer-box after" onclick="openFullscreen('after', event)">
                        <div class="viewer-box-label">AFTER</div>
                        <div id="viewerAfterMedia"></div>
                        <div class="viewer-box-hint">üîç ÌÅ¥Î¶≠ÌïòÏó¨ ÌÅ¨Í≤å Î≥¥Í∏∞</div>
                    </div>
                </div>
            </div>
            <div class="viewer-title" id="viewerTitle"></div>
            <div class="viewer-description" id="viewerDescription"></div>
            <div class="viewer-upload-hint">
                <button class="viewer-upload-btn" onclick="openEditFromViewer()">‚úèÔ∏è ÎØ∏ÎîîÏñ¥ Ìé∏ÏßëÌïòÍ∏∞</button>
            </div>
        </div>
    </div>

    <!-- Fullscreen Image Overlay -->
    <div class="fullscreen-overlay" id="fullscreenOverlay" onclick="closeFullscreen()">
        <div id="fullscreenContent"></div>
    </div>

    <!-- Item Viewer Modal (for per-item media in presentation mode) -->
    <div class="item-viewer-overlay" id="itemViewerOverlay">
        <div class="item-viewer-container">
            <button class="item-viewer-close" onclick="closeItemViewer()">‚úï</button>
            <div class="item-viewer-info">
                <h4 id="itemViewerTitle"></h4>
                <p id="itemViewerDesc"></p>
            </div>
            <div id="itemViewerContent" class="viewer-content-wrapper"></div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div class="modal-overlay" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Ìï≠Î™© ÏàòÏ†ï</h3>
                <button class="modal-close" onclick="closeModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="mode-selector">
                    <div class="mode-btn active" data-mode="single" onclick="selectEditMode('single')">
                        <div class="mode-btn-icon">üì∑</div>
                        <div class="mode-btn-title">ÏùºÎ∞ò ÏÑ§Î™Ö</div>
                        <div class="mode-btn-desc">Îã®Ïùº ÎØ∏ÎîîÏñ¥Î°ú ÏÑ§Î™Ö</div>
                    </div>
                    <div class="mode-btn" data-mode="compare" onclick="selectEditMode('compare')">
                        <div class="mode-btn-icon">‚ö°</div>
                        <div class="mode-btn-title">Ï†Ñ/ÌõÑ ÎπÑÍµê</div>
                        <div class="mode-btn-desc">Before/After ÎπÑÍµê</div>
                    </div>
                </div>

                <div id="singleUpload">
                    <div class="media-upload-section">
                        <label>ÎØ∏ÎîîÏñ¥ (ÌÅ¥Î¶≠ ÎòêÎäî Ctrl+VÎ°ú Î∂ôÏó¨ÎÑ£Í∏∞)</label>
                        <div class="media-preview-box" id="mediaPreview" onclick="document.getElementById('mediaInput').click()">
                            <span style="font-size: 32px;">üì∑</span>
                            <p class="media-preview-text">Ïù¥ÎØ∏ÏßÄ, ÏòÅÏÉÅ, GIF ÏóÖÎ°úÎìú</p>
                        </div>
                        <input type="file" id="mediaInput" accept="image/*,video/*" style="display: none;" onchange="handleMediaUpload(event, 'single')">
                    </div>
                </div>

                <div id="compareUpload" style="display: none;">
                    <div class="compare-uploads">
                        <div class="media-upload-section">
                            <label>üî¥ Before</label>
                            <div class="media-preview-box" id="beforePreview" onclick="document.getElementById('beforeInput').click()">
                                <span style="font-size: 24px;">üì∑</span>
                                <p class="media-preview-text">Before ÎØ∏ÎîîÏñ¥</p>
                            </div>
                            <input type="file" id="beforeInput" accept="image/*,video/*" style="display: none;" onchange="handleMediaUpload(event, 'before')">
                        </div>
                        <div class="media-upload-section">
                            <label>üü¢ After</label>
                            <div class="media-preview-box" id="afterPreview" onclick="document.getElementById('afterInput').click()">
                                <span style="font-size: 24px;">üì∑</span>
                                <p class="media-preview-text">After ÎØ∏ÎîîÏñ¥</p>
                            </div>
                            <input type="file" id="afterInput" accept="image/*,video/*" style="display: none;" onchange="handleMediaUpload(event, 'after')">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Ï†úÎ™©</label>
                    <input type="text" id="editTitle" placeholder="Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                </div>
                <div class="form-group" id="singleDescriptionSection">
                    <label>ÏÑ§Î™Ö</label>
                    <textarea id="editDescription" placeholder="ÏÑ§Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"></textarea>
                </div>

                <!-- Îã§Ï§ë ÏÑ§Î™Ö Ìé∏Ïßë ÏÑπÏÖò (ÌååÏù¥ÌîÑÎùºÏù∏Ïö©) -->
                <div class="form-group" id="descriptionsEditSection" style="display: none;">
                    <label>üìù ÏÑ§Î™Ö Î∏îÎ°ù <span style="font-size: 11px; color: var(--color-text-light);">(Í∞Å ÏÑ§Î™ÖÎ≥ÑÎ°ú Ïù¥ÎØ∏ÏßÄ/ÏòÅÏÉÅ Ï≤®Î∂Ä Í∞ÄÎä•)</span></label>
                    <div id="descriptionsList" class="descriptions-list"></div>
                    <button type="button" class="btn-add-item" onclick="addNewDescription()">+ ÏÑ§Î™Ö Ï∂îÍ∞Ä</button>
                </div>

                <!-- Ìï≠Î™© Ìé∏Ïßë ÏÑπÏÖò (Í∞Å Ìï≠Î™©Î≥Ñ ÎØ∏ÎîîÏñ¥ ÏßÄÏõê) -->
                <div class="form-group" id="itemsEditSection" style="display: none;">
                    <label>üìã ÏÑ∏Î∂Ä Ìï≠Î™© <span style="font-size: 11px; color: var(--color-text-light);">(Í∞Å Ìï≠Î™©Î≥ÑÎ°ú Ïù¥ÎØ∏ÏßÄ/ÏòÅÏÉÅ Ï≤®Î∂Ä Í∞ÄÎä•)</span></label>
                    <div id="itemsList" class="items-list"></div>
                    <button type="button" class="btn-add-item" onclick="addNewItem()">+ Ìï≠Î™© Ï∂îÍ∞Ä</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">Ï∑®ÏÜå</button>
                <button class="btn btn-primary" onclick="saveChanges()">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container hero-content">
            <span class="hero-badge">Î™®Ïó¨ÎùºÎîú ¬∑ 2025ÎÖÑ 1Ïõî ÏóÖÎ¨¥ Î≥¥Í≥†</span>
            <h1>ÏßÄÍ∏à ÏÑ±Í≥ºÎ≥¥Îã§,<br>Ïª§Ïßà Îïå Î≤ÑÌã∞Îäî Íµ¨Ï°∞Î•º Î®ºÏ†Ä ÎßåÎì§ÏóàÏäµÎãàÎã§</h1>
            <div class="hero-subtitle">
                <p>ÏÖÄÎü¨¬∑Í≥µÍ∏âÏÇ¨ ÏòÅÏóÖÏùÑ ÎäòÎ¶¨Í∏∞ Ï†Ñ</p>
                <p>ÏÇ¨ÎûåÏù¥ ÎäòÏñ¥ÎÇòÎèÑ Î¨¥ÎÑàÏßÄÏßÄ ÏïäÎäî MVP Íµ¨Ï∂ï</p>
            </div>
            <div class="summary-cards">
                <div class="summary-card" onclick="scrollToSection(1)">
                    <div class="summary-card-number">STEP 1</div>
                    <div class="summary-card-icon">üéØ</div>
                    <div class="summary-card-title">ÏÖÄÎü¨ ÏòÅÏóÖ</div>
                </div>
                <div class="summary-card" onclick="scrollToSection(2)">
                    <div class="summary-card-number">STEP 2</div>
                    <div class="summary-card-icon">üìä</div>
                    <div class="summary-card-title">ÏÖÄÎü¨ Í¥ÄÎ¶¨</div>
                </div>
                <div class="summary-card" onclick="scrollToSection(3)">
                    <div class="summary-card-number">STEP 3</div>
                    <div class="summary-card-icon">üì¶</div>
                    <div class="summary-card-title">Í≥µÍµ¨Í¥ÄÎ¶¨</div>
                </div>
                <div class="summary-card" onclick="scrollToSection(4)">
                    <div class="summary-card-number">STEP 4</div>
                    <div class="summary-card-icon">üß±</div>
                    <div class="summary-card-title">MVP Íµ¨Ï∂ï</div>
                </div>
                <div class="summary-card" onclick="scrollToSection(5)">
                    <div class="summary-card-number">STEP 5</div>
                    <div class="summary-card-icon">üì£</div>
                    <div class="summary-card-title">ÎßàÏºÄÌåÖ</div>
                </div>
                <div class="summary-card" onclick="scrollToSection(6)">
                    <div class="summary-card-number">STEP 6</div>
                    <div class="summary-card-icon">üåè</div>
                    <div class="summary-card-title">Ìï¥Ïô∏ ÏàòÏ∂ú</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 1: ÏÖÄÎü¨ ÏòÅÏóÖ -->
    <section class="section" id="section-1">
        <div class="container">
            <div class="section-header fade-in">
                <span class="section-number">1</span>
                <h2 class="section-title">ÏÖÄÎü¨ ÏòÅÏóÖ ‚Äì ÌíÄ ÌôïÎ≥¥</h2>
                <p class="section-desc">ÌåîÎ°úÏõå 5Ï≤ú~2Îßå ÏÖÄÎü¨ ÌíÄ ÌôïÎ≥¥ Î™©Ìëú</p>
            </div>
            <div class="pipeline fade-in">
                <div class="pipeline-step clickable-item" data-id="seller-pipeline-1">
                    <div class="item-buttons">
                        <button class="item-btn item-btn-view" onclick="openViewModal(event, 'seller-pipeline-1')">üëÅ Î≥¥Í∏∞</button>
                        <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'seller-pipeline-1')">‚úèÔ∏è Ìé∏Ïßë</button>
                    </div>
                    <div class="pipeline-number">100</div>
                    <div class="pipeline-label">Î¶¨Ïä§Ìä∏ÏóÖ</div>
                    <div class="pipeline-value">ÌÉÄÍ≤ü ÏÖÄÎü¨</div>
                </div>
                <div class="pipeline-step clickable-item" data-id="seller-pipeline-2">
                    <div class="item-buttons">
                        <button class="item-btn item-btn-view" onclick="openViewModal(event, 'seller-pipeline-2')">üëÅ Î≥¥Í∏∞</button>
                        <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'seller-pipeline-2')">‚úèÔ∏è Ìé∏Ïßë</button>
                    </div>
                    <div class="pipeline-number">26</div>
                    <div class="pipeline-label">Ï†úÏïàÏÑú Ï†ÑÎã¨</div>
                    <div class="pipeline-value">Ïª®ÌÉù ÏôÑÎ£å</div>
                </div>
                <div class="pipeline-step clickable-item" data-id="seller-pipeline-3">
                    <div class="item-buttons">
                        <button class="item-btn item-btn-view" onclick="openViewModal(event, 'seller-pipeline-3')">üëÅ Î≥¥Í∏∞</button>
                        <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'seller-pipeline-3')">‚úèÔ∏è Ìé∏Ïßë</button>
                    </div>
                    <div class="pipeline-number">9</div>
                    <div class="pipeline-label">Í≥µÍµ¨ ÏßÑÌñâ</div>
                    <div class="pipeline-value">Ïã§Ï†ú ÏßÑÌñâ</div>
                </div>
                <div class="pipeline-step clickable-item" data-id="seller-pipeline-4">
                    <div class="item-buttons">
                        <button class="item-btn item-btn-view" onclick="openViewModal(event, 'seller-pipeline-4')">üëÅ Î≥¥Í∏∞</button>
                        <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'seller-pipeline-4')">‚úèÔ∏è Ìé∏Ïßë</button>
                    </div>
                    <div class="pipeline-number">‚óã‚óã</div>
                    <div class="pipeline-label">ÏßÑÌñâ ÏòàÏ†ï</div>
                    <div class="pipeline-value">ÌòëÏùò Ï§ë</div>
                </div>
            </div>
            <div class="highlight-box fade-in" style="background: var(--color-card); color: var(--color-text); border: 2px solid var(--color-accent);">
                <p style="text-align: center;">Î¨¥ÏûëÏúÑ ÏòÅÏóÖÏù¥ ÏïÑÎãàÎùº<br><strong style="color: var(--color-accent);">Íµ¨Ï°∞ÌôîÎêú ÏÖÄÎü¨ ÌååÏù¥ÌîÑÎùºÏù∏Ïùò ÏãúÏûë</strong></p>
            </div>
        </div>
    </section>

    <div class="divider"></div>

    <!-- Section 2: ÏÖÄÎü¨ Í¥ÄÎ¶¨ -->
    <section class="section" id="section-2">
        <div class="container">
            <div class="section-header fade-in">
                <span class="section-number">2</span>
                <h2 class="section-title">ÏÖÄÎü¨ Í¥ÄÎ¶¨</h2>
                <p class="section-desc">"Ìïú Î≤à ÌåîÍ≥† ÎÅùÎÇòÎäî Í≥µÍµ¨"Í∞Ä ÏïÑÎãå Íµ¨Ï°∞</p>
            </div>
            <div class="sub-section fade-in">
                <div class="sub-section-title"><span class="sub-section-badge">2-1</span> ÏÖÄÎü¨ Îç∞Ïù¥ÌÑ∞ ÌôïÎ≥¥ Î∞è ÎÇ¥Ïû¨Ìôî</div>
                <div class="grid-2">
                    <div class="card clickable-item" data-id="seller-data-1">
                        <div class="item-buttons">
                            <button class="item-btn item-btn-view" onclick="openViewModal(event, 'seller-data-1')">üëÅ Î≥¥Í∏∞</button>
                            <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'seller-data-1')">‚úèÔ∏è Ìé∏Ïßë</button>
                        </div>
                        <div class="card-title"><span class="card-title-icon">üìä</span>Ïï°ÏÖò</div>
                        <div class="card-content">
                            <div class="problem-item"><span>üìà</span><div class="problem-text"><strong>Î©îÍ∞Ä ÏÖÄÎü¨ ÏÑ±Ïû• ÌçºÎÑê Î∂ÑÏÑù</strong><span>Ìñ•ÌõÑ Íµ¨Ï°∞ ÏÑ§Í≥Ñ Í∏∞Ï¥à Îç∞Ïù¥ÌÑ∞ ÏàòÏßë</span></div></div>
                            <div class="problem-item"><span>üóÇÔ∏è</span><div class="problem-text"><strong>ÏÖÄÎü¨ ÌîÑÎ°úÌïÑ DB Íµ¨Ï∂ï</strong><span>ÌåîÎ°úÏõå, Ïπ¥ÌÖåÍ≥†Î¶¨, Í≥µÍµ¨ ÌûàÏä§ÌÜ†Î¶¨ Ï∂ïÏ†Å</span></div></div>
                        </div>
                    </div>
                    <div class="card clickable-item" data-id="seller-data-2">
                        <div class="item-buttons">
                            <button class="item-btn item-btn-view" onclick="openViewModal(event, 'seller-data-2')">üëÅ Î≥¥Í∏∞</button>
                            <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'seller-data-2')">‚úèÔ∏è Ìé∏Ïßë</button>
                        </div>
                        <div class="card-title"><span class="card-title-icon">üéØ</span>Î™©Ìëú</div>
                        <div class="card-content">
                            <div class="problem-item"><span>üîç</span><div class="problem-text"><strong>ÏÖÄÎü¨ ÏÑ±Ïû• Ìå®ÌÑ¥ Î∂ÑÏÑù</strong><span>Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞ò ÏùòÏÇ¨Í≤∞Ï†ï Ï≤¥Í≥Ñ</span></div></div>
                            <div class="problem-item"><span>üí°</span><div class="problem-text"><strong>Ïù∏ÏÇ¨Ïù¥Ìä∏ ÎèÑÏ∂ú</strong><span>ÏÖÄÎü¨ ÏÑ†Ï†ï Í∏∞Ï§Ä Í≥†ÎèÑÌôî</span></div></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sub-section fade-in">
                <div class="sub-section-title"><span class="sub-section-badge">2-2</span> Îã®Î∞úÏÑ± ‚Üí Ïû•Í∏∞ Íµ¨Ï°∞</div>
                <div class="grid-2">
                    <div class="card clickable-item" data-id="seller-long-1">
                        <div class="item-buttons">
                            <button class="item-btn item-btn-view" onclick="openViewModal(event, 'seller-long-1')">üëÅ Î≥¥Í∏∞</button>
                            <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'seller-long-1')">‚úèÔ∏è Ìé∏Ïßë</button>
                        </div>
                        <div class="card-title"><span class="card-title-icon">üéØ</span>Ïï°ÏÖò</div>
                        <div class="card-content">
                            <div class="problem-item"><span>üè™</span><div class="problem-text"><strong>Í≥µÍµ¨ ÌõÑ ÏûÖÏ†ê Ï†úÏïà</strong><span>ÏùºÌöåÏÑ± ‚Üí ÏßÄÏÜçÏ†Å ÌååÌä∏ÎÑà Ï†ÑÌôò</span></div></div>
                            <div class="problem-item"><span>üìã</span><div class="problem-text"><strong>ÏÖÄÎü¨ NPS Ï°∞ÏÇ¨</strong><span>ÎßåÏ°±ÎèÑ Ï∏°Ï†ï Î∞è Í∞úÏÑ†Ï†ê ÌååÏïÖ</span></div></div>
                        </div>
                    </div>
                    <div class="card clickable-item" data-id="seller-long-2">
                        <div class="item-buttons">
                            <button class="item-btn item-btn-view" onclick="openViewModal(event, 'seller-long-2')">üëÅ Î≥¥Í∏∞</button>
                            <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'seller-long-2')">‚úèÔ∏è Ìé∏Ïßë</button>
                        </div>
                        <div class="card-title"><span class="card-title-icon">üìä</span>ÏßÄÌëú</div>
                        <div style="display: flex; gap: 16px; margin-top: 16px;">
                            <div class="stat-card" style="flex: 1; padding: 16px;"><div class="stat-value" style="font-size: 24px;">‚óã‚óã</div><div class="stat-label">ÏûÖÏ†ê ÏÖÄÎü¨</div></div>
                            <div class="stat-card" style="flex: 1; padding: 16px;"><div class="stat-value" style="font-size: 24px;">‚óã‚óã</div><div class="stat-label">Ïû¨ÏßÑÌñâ ÏÖÄÎü¨</div></div>
                            <div class="stat-card" style="flex: 1; padding: 16px;"><div class="stat-value" style="font-size: 24px;">‚óã‚óã</div><div class="stat-label">ÎßåÏ°±ÎèÑ Ï†êÏàò</div></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sub-section fade-in">
                <div class="sub-section-title"><span class="sub-section-badge" style="background: #fff3cd; color: #856404;">NEXT</span> Í∞úÏÑ† ÏòàÏ†ï ÏÇ¨Ìï≠</div>
                <div class="grid-2">
                    <div class="card clickable-item" data-id="seller-plan-1" style="border-left: 4px solid #f39c12;">
                        <div class="item-buttons">
                            <button class="item-btn item-btn-view" onclick="openViewModal(event, 'seller-plan-1')">üëÅ Î≥¥Í∏∞</button>
                            <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'seller-plan-1')">‚úèÔ∏è Ìé∏Ïßë</button>
                        </div>
                        <div class="card-title"><span class="card-title-icon" style="background: #fff3cd;">ü§ñ</span><span style="color: #f39c12; font-size: 12px;">ÏòàÏ†ï</span> ÏÖÄÎü¨ ÎßûÏ∂§ Ï±óÎ¥á</div>
                        <div class="card-content">
                            <div class="problem-item"><span>üí¨</span><div class="problem-text"><strong>ÌååÌä∏ÎÑàÌè¨ÌÑ∏Ïóê AI Ï±óÎ¥á ÌÉëÏû¨</strong><span>ÏÖÄÎü¨ ÎßûÏ∂§Ìòï Ï±óÎ¥áÏúºÎ°ú ÏßÄÏõê Í∞ïÌôî</span></div></div>
                            <div class="problem-item"><span>üìä</span><div class="problem-text"><strong>ÏÖÄÎü¨ DB Ïó∞Îèô</strong><span>ÏÑ±Î≥Ñ/ÎÇòÏù¥/ÏûêÎÖÄÏú†Î¨¥, Ïπ¥ÌÖåÍ≥†Î¶¨, Í≥µÍµ¨ÏßÑÌñâÍ±¥ Îì± ÏÖÄÎü¨ Îç∞Ïù¥ÌÑ∞ ÌôúÏö©</span></div></div>
                            <div class="problem-item"><span>üìù</span><div class="problem-text"><strong>ÏΩòÌÖêÏ∏† Ï†úÏûë ÏßÄÏõê</strong><span>ÏÖÄÎü¨Í∞Ä ÏΩòÌÖêÏ∏† Ï†úÏûë Ïãú ÎßûÏ∂§ ÎèÑÏõÄ Ï†úÍ≥µ</span></div></div>
                            <div class="problem-item"><span>üíÅ</span><div class="problem-text"><strong>Ïù∏ÏπúÍ¥ÄÎ¶¨(CS) ÏßÄÏõê</strong><span>ÏÖÄÎü¨Ïùò ÌåîÎ°úÏõå ÏùëÎåÄ Î∞è CS ÎèÑÏö∞ÎØ∏ Ïó≠Ìï†</span></div></div>
                        </div>
                    </div>
                    <div class="card clickable-item" data-id="seller-plan-2" style="border-left: 4px solid #f39c12;">
                        <div class="item-buttons">
                            <button class="item-btn item-btn-view" onclick="openViewModal(event, 'seller-plan-2')">üëÅ Î≥¥Í∏∞</button>
                            <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'seller-plan-2')">‚úèÔ∏è Ìé∏Ïßë</button>
                        </div>
                        <div class="card-title"><span class="card-title-icon" style="background: #fff3cd;">üìÖ</span><span style="color: #f39c12; font-size: 12px;">ÏòàÏ†ï</span> Í≥µÍµ¨ Í∞ÄÏù¥Îìú ÏûêÎèôÌôî</div>
                        <div class="card-content">
                            <div class="problem-item"><span>üìÜ</span><div class="problem-text"><strong>ÏùºÏ†ïÌëú Ïó∞Îèô</strong><span>ÌååÌä∏ÎÑàÌè¨ÌÑ∏ ÏùºÏ†ïÌëúÏóêÏÑú Í≥µÍµ¨ ÏÑ†ÌÉù Ïãú</span></div></div>
                            <div class="problem-item"><span>üìã</span><div class="problem-text"><strong>Í∞ÄÏù¥Îìú ÏûêÎèô Ï∂úÎ†•</strong><span>Ìï¥Îãπ Í≥µÍµ¨Ïùò Í∞ÄÏù¥ÎìúÍ∞Ä ÏûêÎèôÏúºÎ°ú ÌëúÏãú</span></div></div>
                            <div class="problem-item"><span>‚ö°</span><div class="problem-text"><strong>ÏóÖÎ¨¥ Ìö®Ïú®Ìôî</strong><span>Î≥ÑÎèÑ Í≤ÄÏÉâ ÏóÜÏù¥ Ï¶âÏãú ÌïÑÏöî Ï†ïÎ≥¥ ÌôïÏù∏</span></div></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="highlight-box fade-in"><p style="text-align: center;">ÏÖÄÎü¨Î•º 'ÏÜåÎπÑ'ÌïòÏßÄ ÏïäÍ≥†<br><strong>ÌîåÎû´Ìèº ÏûêÏÇ∞ÏúºÎ°ú Ï†ÑÌôò</strong>ÌïòÎäî Îã®Í≥Ñ</p></div>
        </div>
    </section>

    <div class="divider"></div>

    <!-- Section 3: Í≥µÍµ¨Í¥ÄÎ¶¨ -->
    <section class="section" id="section-3">
        <div class="container">
            <div class="section-header fade-in">
                <span class="section-number">3</span>
                <h2 class="section-title">Í≥µÍµ¨Í¥ÄÎ¶¨</h2>
                <p class="section-desc">Í≥µÍµ¨ ÏßÑÌñâ Ï†ÑÏ≤¥ ÌîÑÎ°úÏÑ∏Ïä§ Í¥ÄÎ¶¨</p>
            </div>
            <div class="grid-6 fade-in">
                <div class="step-card clickable-item" data-id="gonggu-1">
                    <div class="item-buttons">
                        <button class="item-btn item-btn-view" onclick="openViewModal(event, 'gonggu-1')">üëÅ</button>
                        <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'gonggu-1')">‚úèÔ∏è</button>
                    </div>
                    <div class="step-number">1</div>
                    <div class="step-title">ÏÖÄÎü¨ ÎßûÏ∂§ Í∞ÄÏù¥Îìú</div>
                    <div class="step-desc">Í∞ÄÏù¥Îìú Ï†ÑÎã¨</div>
                </div>
                <div class="step-card clickable-item" data-id="gonggu-2">
                    <div class="item-buttons">
                        <button class="item-btn item-btn-view" onclick="openViewModal(event, 'gonggu-2')">üëÅ</button>
                        <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'gonggu-2')">‚úèÔ∏è</button>
                    </div>
                    <div class="step-number">2</div>
                    <div class="step-title">Ïù¥Î≤§Ìä∏ ÏÉÅÌéò</div>
                    <div class="step-desc">ÏÉÅÏÑ∏ÌéòÏù¥ÏßÄ Ï†úÏûë</div>
                </div>
                <div class="step-card clickable-item" data-id="gonggu-3">
                    <div class="item-buttons">
                        <button class="item-btn item-btn-view" onclick="openViewModal(event, 'gonggu-3')">üëÅ</button>
                        <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'gonggu-3')">‚úèÔ∏è</button>
                    </div>
                    <div class="step-number">3</div>
                    <div class="step-title">Í≤∞Ï†úÎßÅÌÅ¨</div>
                    <div class="step-desc">ÏãúÌÅ¨Î¶øÎßÅÌÅ¨ Ï†ÑÎã¨</div>
                </div>
                <div class="step-card clickable-item" data-id="gonggu-4">
                    <div class="item-buttons">
                        <button class="item-btn item-btn-view" onclick="openViewModal(event, 'gonggu-4')">üëÅ</button>
                        <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'gonggu-4')">‚úèÔ∏è</button>
                    </div>
                    <div class="step-number">4</div>
                    <div class="step-title">Í≥µÍ∏âÏÇ¨ Ï†ÑÎã¨</div>
                    <div class="step-desc">Ï∞∏Ïó¨Ïûê/Ïª®ÌÖêÏ∏†/Î∞úÏ£ºÏÑú</div>
                </div>
                <div class="step-card clickable-item" data-id="gonggu-5">
                    <div class="item-buttons">
                        <button class="item-btn item-btn-view" onclick="openViewModal(event, 'gonggu-5')">üëÅ</button>
                        <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'gonggu-5')">‚úèÔ∏è</button>
                    </div>
                    <div class="step-number">5</div>
                    <div class="step-title">ÏÜ°Ïû• Í∏∞ÏûÖ</div>
                    <div class="step-desc">ÏÜ°Ïû• Î∞õÍ≥† ÏûÖÎ†•</div>
                </div>
                <div class="step-card clickable-item" data-id="gonggu-6">
                    <div class="item-buttons">
                        <button class="item-btn item-btn-view" onclick="openViewModal(event, 'gonggu-6')">üëÅ</button>
                        <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'gonggu-6')">‚úèÔ∏è</button>
                    </div>
                    <div class="step-badge">ÏÜ°Ìù¨Îãò Îã¥Îãπ</div>
                    <div class="step-number">6</div>
                    <div class="step-title">Ï†ïÏÇ∞</div>
                    <div class="step-desc">ÏµúÏ¢Ö Ï†ïÏÇ∞ Ï≤òÎ¶¨</div>
                </div>
            </div>
            <div class="highlight-box fade-in" style="background: linear-gradient(135deg, var(--color-orange) 0%, #d35400 100%);">
                <p style="text-align: center;">Í≥µÍµ¨ 1Í±¥Îãπ <strong>6Îã®Í≥Ñ ÌîÑÎ°úÏÑ∏Ïä§</strong>Î•º<br>Ï≤¥Í≥ÑÏ†ÅÏúºÎ°ú Í¥ÄÎ¶¨</p>
            </div>
        </div>
    </section>

    <div class="divider"></div>

    <!-- Section 4: MVP Íµ¨Ï∂ï -->
    <section class="section" id="section-4">
        <div class="container">
            <div class="section-header fade-in">
                <span class="section-number">4</span>
                <h2 class="section-title">MVP Íµ¨Ï∂ï ‚Äì Í¥ÄÎ¶¨Ïûê ÏãúÏä§ÌÖú Í≥†ÎèÑÌôî</h2>
                <p class="section-desc">ÏÇ¨ÎûåÏù¥ ÎäòÏñ¥ÎÇòÎèÑ Î≤ÑÌã∏ Ïàò ÏûàÎäî Ïö¥ÏòÅ Íµ¨Ï°∞ ÏÑ§Î¶Ω</p>
            </div>
            <div class="before-after fade-in">
                <div class="before-box">
                    <div class="ba-label">Before</div>
                    <ul class="ba-list">
                        <li class="clickable-item" data-id="mvp-before-1"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'mvp-before-1')">üëÅ</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'mvp-before-1')">‚úèÔ∏è</button></div>üìÑ Íµ¨Í∏Ä ÏãúÌä∏ Î∂ÑÏÇ∞</li>
                        <li class="clickable-item" data-id="mvp-before-2"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'mvp-before-2')">üëÅ</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'mvp-before-2')">‚úèÔ∏è</button></div>üìÖ Ï∫òÎ¶∞Îçî Î≥ÑÎèÑ Í¥ÄÎ¶¨</li>
                        <li class="clickable-item" data-id="mvp-before-3"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'mvp-before-3')">üëÅ</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'mvp-before-3')">‚úèÔ∏è</button></div>üìù Î©îÎ™®¬∑Ï±ÑÌåÖ Í∏∞Î°ù ÏùòÏ°¥</li>
                        <li class="clickable-item" data-id="mvp-before-4"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'mvp-before-4')">üëÅ</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'mvp-before-4')">‚úèÔ∏è</button></div>‚ùì ÌòÑÌô© ÌååÏïÖÏóê ÏãúÍ∞Ñ ÏÜåÏöî</li>
                    </ul>
                </div>
                <div class="arrow-divider">‚Üí</div>
                <div class="after-box">
                    <div class="ba-label">After<a href="https://partner-moyeoradeal.kr/admin/" target="_blank" class="admin-link">Í¥ÄÎ¶¨Ïûê ÏãúÏä§ÌÖú Î∞îÎ°úÍ∞ÄÍ∏∞ ‚Üí</a></div>
                    <ul class="ba-list">
                        <li class="clickable-item" data-id="mvp-after-1"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'mvp-after-1')">üëÅ</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'mvp-after-1')">‚úèÔ∏è</button></div>‚úì Í¥ÄÎ¶¨Ïûê ÏãúÏä§ÌÖú Ìïú ÌéòÏù¥ÏßÄ ÌÜµÌï©</li>
                        <li class="clickable-item" data-id="mvp-after-2"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'mvp-after-2')">üëÅ</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'mvp-after-2')">‚úèÔ∏è</button></div>‚úì Ïã§ÏãúÍ∞Ñ ÌòÑÌô© ÎåÄÏãúÎ≥¥Îìú</li>
                        <li class="clickable-item" data-id="mvp-after-3"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'mvp-after-3')">üëÅ</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'mvp-after-3')">‚úèÔ∏è</button></div>‚úì Îã®Í≥ÑÎ≥Ñ ÏßÑÌñâ ÏÉÅÌÉú Ï∂îÏ†Å</li>
                        <li class="clickable-item" data-id="mvp-after-4"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'mvp-after-4')">üëÅ</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'mvp-after-4')">‚úèÔ∏è</button></div>‚úì ÎàÑÍµ¨ÎÇò Ï¶âÏãú ÌååÏïÖ Í∞ÄÎä•</li>
                    </ul>
                </div>
            </div>
            <div class="grid-4 fade-in" style="margin-bottom: 24px;">
                <div class="card feature-card clickable-item" data-id="mvp-feature-1"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'mvp-feature-1')">üëÅ</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'mvp-feature-1')">‚úèÔ∏è</button></div><div class="feature-icon">üìä</div><div class="feature-title">ÏÖÄÎü¨ DB ÌÜµÌï©</div><div class="feature-desc">ÏÖÄÎü¨¬∑Í≥µÍµ¨ ÌòÑÌô©<br>ÌïúÎààÏóê ÌååÏïÖ</div></div>
                <div class="card feature-card clickable-item" data-id="mvp-feature-2"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'mvp-feature-2')">üëÅ</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'mvp-feature-2')">‚úèÔ∏è</button></div><div class="feature-icon">üí∞</div><div class="feature-title">ÎßàÏßÑ¬∑Îã®Í≥Ñ Í∞ÄÏãúÌôî</div><div class="feature-desc">ÏÖÄÎü¨Î≥Ñ ÏàòÏùµ Íµ¨Ï°∞<br>Ï¶âÏãú ÌôïÏù∏</div></div>
                <div class="card feature-card clickable-item" data-id="mvp-feature-3"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'mvp-feature-3')">üëÅ</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'mvp-feature-3')">‚úèÔ∏è</button></div><div class="feature-icon">‚ö°</div><div class="feature-title">ÏàòÍ∏∞ ‚Üí ÏûêÎèôÌôî</div><div class="feature-desc">Î∞òÎ≥µ ÏûëÏóÖ<br>ÏãúÏä§ÌÖú Ï≤òÎ¶¨</div></div>
                <div class="card feature-card clickable-item" data-id="mvp-feature-4"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'mvp-feature-4')">üëÅ</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'mvp-feature-4')">‚úèÔ∏è</button></div><div class="feature-icon">üìã</div><div class="feature-title">Îã®Í≥ÑÎ≥Ñ Í¥ÄÎ¶¨</div><div class="feature-desc">Ï§ÄÎπÑ‚ÜíÏßÑÌñâ‚ÜíÏ¢ÖÎ£å<br>ÌîÑÎ°úÏÑ∏Ïä§ Ï†ïÎ¶Ω</div></div>
            </div>
            <!-- Î†àÌçºÎü∞Ïä§ Î©îÎâ¥ Ï∂îÍ∞Ä -->
            <div class="card clickable-item fade-in" data-id="mvp-reference" style="background: linear-gradient(135deg, #f8f4ff 0%, #ede7f6 100%); border: 1px solid #d1c4e9;">
                <div class="item-buttons">
                    <button class="item-btn item-btn-view" onclick="openViewModal(event, 'mvp-reference')">üëÅ Î≥¥Í∏∞</button>
                    <button class="item-btn item-btn-edit" onclick="openEditModal(event, 'mvp-reference')">‚úèÔ∏è Ìé∏Ïßë</button>
                </div>
                <div class="card-title"><span class="card-title-icon" style="background: #ede7f6;">üìö</span><span style="color: #7b1fa2;">NEW</span> Î†àÌçºÎü∞Ïä§ Î©îÎâ¥ Ï∂îÍ∞Ä</div>
                <div class="card-content">
                    <div class="problem-item"><span>üóÇÔ∏è</span><div class="problem-text"><strong>ÏûêÎ£å Îç∞Ïù¥ÌÑ∞ ÏûêÏÇ∞Ìôî</strong><span>Î†àÌçºÎü∞Ïä§ ÏûêÎ£åÎ•º ÌïúÍ≥≥Ïóê Î™®ÏïÑ Í¥ÄÎ¶¨</span></div></div>
                    <div class="problem-item"><span>üîç</span><div class="problem-text"><strong>Îπ†Î•∏ Ï∞∏Í≥† Í∞ÄÎä•</strong><span>ÌïÑÏöîÌï† Îïå Ï¶âÏãú Ï∞æÏïÑÎ≥º Ïàò ÏûàÎäî Íµ¨Ï°∞</span></div></div>
                </div>
            </div>
            <div class="highlight-box fade-in"><p>Í≥µÍµ¨ ÏàòÍ∞Ä <strong>10Í±¥ ‚Üí 50Í±¥ ‚Üí 100Í±¥</strong>Ïù¥ ÎêòÏñ¥ÎèÑ<br>Ïö¥ÏòÅ ÌíàÏßàÏùÑ Ïú†ÏßÄÌï† Ïàò ÏûàÎäî <strong>ÏµúÏÜå Ï°∞Í±¥ ÌôïÎ≥¥</strong></p></div>
        </div>
    </section>

    <div class="divider"></div>

    <!-- Section 5: ÎßàÏºÄÌåÖ Ïù∏ÌîÑÎùº -->
    <section class="section" id="section-5">
        <div class="container">
            <div class="section-header fade-in">
                <span class="section-number">5</span>
                <h2 class="section-title">ÎßàÏºÄÌåÖ Ïù∏ÌîÑÎùº Íµ¨Ï∂ï</h2>
                <p class="section-desc">ÏÖÄÎü¨ ÏòÅÏóÖ¬∑Í≥µÍµ¨ ÏÑ±Í≥ºÎ•º ÏúÑÌïú Í∏∞Î≥∏ Ïù∏ÌîÑÎùº Íµ¨Ï∂ï</p>
            </div>
            <div class="grid-2 fade-in">
                <div class="card clickable-item" data-id="marketing-1"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'marketing-1')">üëÅ Î≥¥Í∏∞</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'marketing-1')">‚úèÔ∏è Ìé∏Ïßë</button></div><div class="card-title"><span class="card-title-icon">üé®</span>Ïï°ÏÖò</div><div class="card-content"><div class="problem-item"><span>üì±</span><div class="problem-text"><strong>Ïù∏Ïä§ÌÉÄÍ∑∏Îû® Î∏åÎûúÎìú Ïù¥ÎØ∏ÏßÄ Ï†úÏûë</strong><span>ÌïµÏã¨ Î©îÏãúÏßÄ Ï§ëÏã¨Ïùò ÎπÑÏ£ºÏñº Íµ¨Ï∂ï</span></div></div><div class="problem-item"><span>üì£</span><div class="problem-text"><strong>Î©îÌÉÄ Í¥ëÍ≥† ÏÑ∏ÌåÖ Î∞è ÏßëÌñâ</strong><span>Í¥ëÍ≥†Ïö© Ïù¥ÎØ∏ÏßÄ Ï†úÏûë, ÌÉÄÍ≤üÌåÖ ÌÖåÏä§Ìä∏</span></div></div></div></div>
                <div class="card clickable-item" data-id="marketing-2"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'marketing-2')">üëÅ Î≥¥Í∏∞</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'marketing-2')">‚úèÔ∏è Ìé∏Ïßë</button></div><div class="card-title"><span class="card-title-icon">üìà</span>Í≤∞Í≥º</div><div class="grid-2" style="margin-top: 16px;"><div class="stat-card" style="padding: 16px;"><div class="stat-value">3Í±¥</div><div class="stat-label">ÏÖÄÎü¨ Ïú†ÏûÖ</div></div><div class="stat-card" style="padding: 16px;"><div class="stat-value">1Í±¥</div><div class="stat-label">Í≥µÍ∏âÏÇ¨ Ïú†ÏûÖ</div></div></div></div>
            </div>
            <div class="highlight-box fade-in" style="background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);"><p>Ïà´ÏûêÎ≥¥Îã§ Ï§ëÏöîÌïú Í±¥<br><strong>"Ïö∞Î¶¨ Î©îÏãúÏßÄÏóê Î∞òÏùëÌïòÎäî ÏãúÏû•Ïù¥ Ï°¥Ïû¨Ìï®ÏùÑ ÌôïÏù∏"</strong></p></div>
        </div>
    </section>

    <div class="divider"></div>

    <!-- Section 6: Ìï¥Ïô∏ ÏàòÏ∂ú -->
    <section class="section" id="section-6">
        <div class="container">
            <div class="section-header fade-in">
                <span class="section-number">6</span>
                <h2 class="section-title">Ìï¥Ïô∏ ÏàòÏ∂ú</h2>
                <p class="section-desc">ÏáºÌîº ÏûÖÏ†êÏùÑ ÏúÑÌïú Ï§ÄÎπÑ ÏûëÏóÖ</p>
            </div>
            <div class="grid-2 fade-in">
                <div class="card mini-card clickable-item" data-id="export-1"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'export-1')">üëÅ Î≥¥Í∏∞</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'export-1')">‚úèÔ∏è Ìé∏Ïßë</button></div><div class="mini-icon">üåè</div><div class="mini-text"><div class="mini-title">ÏáºÌîº ÏûÖÏ†ê Ï†ïÎ≥¥ ÌååÏïÖ</div><div class="mini-desc">Ìï¥Ïô∏ ÌîåÎû´Ìèº ÏûÖÏ†ê ÏöîÍ±¥ Î∞è ÌîÑÎ°úÏÑ∏Ïä§ Ï°∞ÏÇ¨</div></div></div>
                <div class="card mini-card clickable-item" data-id="export-2"><div class="item-buttons"><button class="item-btn item-btn-view" onclick="openViewModal(event, 'export-2')">üëÅ Î≥¥Í∏∞</button><button class="item-btn item-btn-edit" onclick="openEditModal(event, 'export-2')">‚úèÔ∏è Ìé∏Ïßë</button></div><div class="mini-icon">üì±</div><div class="mini-text"><div class="mini-title">ÏóÖÎ¨¥Ìè∞ Í∞úÌÜµ</div><div class="mini-desc">Ìï¥Ïô∏ Ïª§ÎÆ§ÎãàÏºÄÏù¥ÏÖòÏö© ÌöåÏÑ† ÌôïÎ≥¥</div></div></div>
            </div>
            <div class="highlight-box fade-in" style="background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);"><p style="text-align: center;">Íµ≠ÎÇ¥ ÏãúÏû• ÏïàÏ†ïÌôî ÌõÑ<br><strong>ÎèôÎÇ®ÏïÑ ÏãúÏû• ÌôïÏû•</strong>ÏùÑ ÏúÑÌïú ÏÇ¨Ï†Ñ Ï§ÄÎπÑ</p></div>
        </div>
    </section>

    <!-- Final Section -->
    <section class="final-section">
        <div class="container">
            <div class="fade-in">
                <p class="final-quote">"ÏßÄÍ∏àÏùÄ ÏÜçÎèÑÎ≥¥Îã§<br>Î∞©Ìñ•ÏùÑ ÎßûÏ∂ò Îã®Í≥ÑÏûÖÎãàÎã§"</p>
                <div class="next-steps">
                    <div style="font-size: 13px; text-transform: uppercase; letter-spacing: 0.5px; opacity: 0.7; margin-bottom: 8px;">Îã§Ïùå Îã®Í≥Ñ</div>
                    <div class="next-step"><span class="next-step-icon">‚Üí</span>Ïù¥ Íµ¨Ï°∞ ÏúÑÏóêÏÑú ÏÖÄÎü¨¬∑Í≥µÍ∏âÏÇ¨ ÏòÅÏóÖ ÌôïÎåÄ</div>
                    <div class="next-step"><span class="next-step-icon">‚Üí</span>ÏûêÎèôÌôî Í≥†ÎèÑÌôî</div>
                    <div class="next-step"><span class="next-step-icon">‚Üí</span>ÏÑ±Í≥º Ïä§ÏºÄÏùºÎßÅ Í∞ÄÎä•</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Script Section -->
    <section class="script-section" id="script-section">
        <div class="container">
            <div class="script-header"><h2>üìú Î∞úÌëú ÎåÄÎ≥∏</h2><p>5~10Î∂Ñ Î∏åÎ¶¨ÌïëÏö© ¬∑ Ïù∏ÏáÑÌïòÏó¨ ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî</p></div>

            <div class="script-card"><div class="script-card-header"><span class="script-number">0</span><span class="script-title">Ïò§ÌîÑÎãù</span><span class="script-time">30Ï¥à</span></div><div class="script-content"><p>"ÏïàÎÖïÌïòÏÑ∏Ïöî, Î™®Ïó¨ÎùºÎîú 1Ïõî ÏóÖÎ¨¥ Î≥¥Í≥† ÎìúÎ¶¨Í≤†ÏäµÎãàÎã§."</p><p>"Ïù¥Î≤à Îã¨Ïùò ÌïµÏã¨ Î©îÏãúÏßÄÎäî <span class="script-highlight">'ÏßÄÍ∏à ÏÑ±Í≥ºÎ≥¥Îã§, Ïª§Ïßà Îïå Î≤ÑÌã∞Îäî Íµ¨Ï°∞Î•º Î®ºÏ†Ä ÎßåÎì§ÏóàÎã§'</span>ÏûÖÎãàÎã§."</p></div></div>

            <div class="script-card"><div class="script-card-header"><span class="script-number">1</span><span class="script-title">ÏÖÄÎü¨ ÏòÅÏóÖ ‚Äì ÌíÄ ÌôïÎ≥¥</span><span class="script-time">1Î∂Ñ</span></div><div class="script-content"><p>"Ï≤´ Î≤àÏß∏, ÏÖÄÎü¨ ÏòÅÏóÖÏûÖÎãàÎã§."</p><p><span class="script-action">[ÌååÏù¥ÌîÑÎùºÏù∏ Ïà´Ïûê Í∞ÄÎ¶¨ÌÇ§Î©∞]</span></p><p>"ÌÉÄÍ≤ü ÏÖÄÎü¨ 100Î™Ö Î¶¨Ïä§Ìä∏ÏóÖ ‚Üí 26Î™Ö Ïª®ÌÉù ‚Üí 9Í±¥ Ïã§Ï†ú ÏßÑÌñâ"</p><p>"<span class="script-highlight">Íµ¨Ï°∞ÌôîÎêú ÏÖÄÎü¨ ÌååÏù¥ÌîÑÎùºÏù∏</span>Ïù¥ ÏãúÏûëÎêêÏäµÎãàÎã§."</p></div></div>

            <div class="script-card"><div class="script-card-header"><span class="script-number">2</span><span class="script-title">ÏÖÄÎü¨ Í¥ÄÎ¶¨</span><span class="script-time">2Î∂Ñ</span></div><div class="script-content"><p>"Îëê Î≤àÏß∏, ÏÖÄÎü¨ Í¥ÄÎ¶¨ÏûÖÎãàÎã§."</p><p>"<span class="script-highlight">ÏÖÄÎü¨ Îç∞Ïù¥ÌÑ∞ ÌôïÎ≥¥</span>: Î©îÍ∞Ä ÏÖÄÎü¨ ÏÑ±Ïû• ÌçºÎÑê Î∂ÑÏÑù"</p><p>"<span class="script-highlight">Ïû•Í∏∞ Íµ¨Ï°∞ Ï†ÑÌôò</span>: Í≥µÍµ¨ ÌõÑ ÏûÖÏ†ê Ï†úÏïà, NPS Ï°∞ÏÇ¨"</p><p><span class="script-action">[Í∞úÏÑ† ÏòàÏ†ï ÏÇ¨Ìï≠ Í∞ÄÎ¶¨ÌÇ§Î©∞]</span></p><p>"Í∑∏Î¶¨Í≥† ÏïûÏúºÎ°ú ÌååÌä∏ÎÑàÌè¨ÌÑ∏Ïóê <span class="script-highlight">ÏÖÄÎü¨ ÎßûÏ∂§ AI Ï±óÎ¥á</span>ÏùÑ ÌÉëÏû¨Ìï† ÏòàÏ†ïÏûÖÎãàÎã§."</p><p>"Ï±óÎ¥áÏùÄ ÏÖÄÎü¨ DBÏùò Îç∞Ïù¥ÌÑ∞Î•º ÌôúÏö©Ìï¥ ÏΩòÌÖêÏ∏† Ï†úÏûëÍ≥º CSÎ•º ÏßÄÏõêÌï©ÎãàÎã§."</p><p>"ÎòêÌïú ÏùºÏ†ïÌëúÏóêÏÑú Í≥µÍµ¨ ÏÑ†ÌÉù Ïãú <span class="script-highlight">Í∞ÄÏù¥ÎìúÍ∞Ä ÏûêÎèôÏúºÎ°ú</span> ÎÇòÏò§ÎèÑÎ°ù Í∞úÏÑ†Ìï† ÏòàÏ†ïÏûÖÎãàÎã§."</p><p>"ÏÖÄÎü¨Î•º ÏÜåÎπÑÌïòÏßÄ ÏïäÍ≥† <span class="script-highlight">ÌîåÎû´Ìèº ÏûêÏÇ∞ÏúºÎ°ú Ï†ÑÌôò</span>Ìï©ÎãàÎã§."</p></div></div>

            <div class="script-card"><div class="script-card-header"><span class="script-number">3</span><span class="script-title">Í≥µÍµ¨Í¥ÄÎ¶¨</span><span class="script-time">1Î∂Ñ 30Ï¥à</span></div><div class="script-content"><p>"ÏÑ∏ Î≤àÏß∏, Í≥µÍµ¨Í¥ÄÎ¶¨ÏûÖÎãàÎã§."</p><p><span class="script-action">[6Îã®Í≥Ñ Í∞ÄÎ¶¨ÌÇ§Î©∞]</span></p><p>"Í≥µÍµ¨ 1Í±¥Îãπ 6Îã®Í≥Ñ ÌîÑÎ°úÏÑ∏Ïä§: ÏÖÄÎü¨ Í∞ÄÏù¥Îìú ‚Üí ÏÉÅÌéò Ï†úÏûë ‚Üí Í≤∞Ï†úÎßÅÌÅ¨ ‚Üí Í≥µÍ∏âÏÇ¨ Ï†ÑÎã¨ ‚Üí ÏÜ°Ïû• Í∏∞ÏûÖ ‚Üí Ï†ïÏÇ∞"</p><p>"Ïù¥ Î™®Îì† Í≥ºÏ†ïÏùÑ <span class="script-highlight">Ï≤¥Í≥ÑÏ†ÅÏúºÎ°ú Í¥ÄÎ¶¨</span>ÌïòÍ≥† ÏûàÏäµÎãàÎã§."</p></div></div>

            <div class="script-card"><div class="script-card-header"><span class="script-number">4</span><span class="script-title">MVP Íµ¨Ï∂ï</span><span class="script-time">2Î∂Ñ</span></div><div class="script-content"><p>"ÎÑ§ Î≤àÏß∏, MVP Íµ¨Ï∂ïÏûÖÎãàÎã§."</p><p><span class="script-action">[Before/After Í∞ÄÎ¶¨ÌÇ§Î©∞]</span></p><p>"Î∂ÑÏÇ∞Îêú Íµ¨Í∏Ä ÏãúÌä∏ ‚Üí <span class="script-highlight">Í¥ÄÎ¶¨Ïûê ÏãúÏä§ÌÖú Ìïú ÌéòÏù¥ÏßÄ ÌÜµÌï©</span>"</p><p>"Í∑∏Î¶¨Í≥† <span class="script-highlight">Î†àÌçºÎü∞Ïä§ Î©îÎâ¥</span>Î•º Ï∂îÍ∞ÄÌï¥ÏÑú ÏûêÎ£å Îç∞Ïù¥ÌÑ∞Î•º ÏûêÏÇ∞ÌôîÌñàÏäµÎãàÎã§."</p><p>"ÌïÑÏöîÌïú ÏûêÎ£åÎ•º ÌïúÍ≥≥ÏóêÏÑú Î∞îÎ°ú Ï∞∏Í≥†Ìï† Ïàò ÏûàÏäµÎãàÎã§."</p></div></div>

            <div class="script-card"><div class="script-card-header"><span class="script-number">5</span><span class="script-title">ÎßàÏºÄÌåÖ Ïù∏ÌîÑÎùº</span><span class="script-time">1Î∂Ñ</span></div><div class="script-content"><p>"Îã§ÏÑØ Î≤àÏß∏, ÎßàÏºÄÌåÖ Ïù∏ÌîÑÎùºÏûÖÎãàÎã§."</p><p>"Ïù∏Ïä§ÌÉÄÍ∑∏Îû® Î∏åÎûúÎìú Ïù¥ÎØ∏ÏßÄ, Î©îÌÉÄ Í¥ëÍ≥† ÏßëÌñâ ‚Üí ÏÖÄÎü¨ 3Í±¥, Í≥µÍ∏âÏÇ¨ 1Í±¥ Ïú†ÏûÖ"</p><p>"<span class="script-highlight">'Ïö∞Î¶¨ Î©îÏãúÏßÄÏóê Î∞òÏùëÌïòÎäî ÏãúÏû•Ïù¥ Ï°¥Ïû¨ÌïúÎã§'</span>Îäî Í±∏ ÌôïÏù∏ÌñàÏäµÎãàÎã§."</p></div></div>

            <div class="script-card"><div class="script-card-header"><span class="script-number">6</span><span class="script-title">Ìï¥Ïô∏ ÏàòÏ∂ú & ÌÅ¥Î°úÏßï</span><span class="script-time">30Ï¥à</span></div><div class="script-content"><p>"ÎßàÏßÄÎßâÏúºÎ°ú, ÏáºÌîº ÏûÖÏ†ê Ï§ÄÎπÑÏôÄ ÏóÖÎ¨¥Ìè∞ Í∞úÌÜµÏúºÎ°ú Ìï¥Ïô∏ ÌôïÏû•ÏùÑ Ï§ÄÎπÑÌïòÍ≥† ÏûàÏäµÎãàÎã§."</p><p>"<span class="script-highlight">ÏßÄÍ∏àÏùÄ ÏÜçÎèÑÎ≥¥Îã§ Î∞©Ìñ•ÏùÑ ÎßûÏ∂ò Îã®Í≥Ñ</span>ÏûÖÎãàÎã§. Í∞êÏÇ¨Ìï©ÎãàÎã§."</p></div></div>

            <div style="text-align: center;"><button class="print-btn" onclick="window.print()">üñ®Ô∏è ÎåÄÎ≥∏ Ïù∏ÏáÑÌïòÍ∏∞</button></div>
        </div>
    </section>

    <script>
        // Firebase Ï¥àÍ∏∞Ìôî
        const firebaseConfig = {
            apiKey: "AIzaSyAQf_Cu9wMji5QsMBQns5eg6nOD_vmrZMs",
            authDomain: "moyeora-deal-manager.firebaseapp.com",
            projectId: "moyeora-deal-manager",
            storageBucket: "moyeora-deal-manager.firebasestorage.app",
            messagingSenderId: "527148187832",
            appId: "1:527148187832:web:dc35b0413a7157db34744d"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const storage = firebase.storage();

        // Î¨∏ÏÑú ID (Í≥†Ï†ï - Îã®Ïùº growthboard Îç∞Ïù¥ÌÑ∞)
        const GROWTHBOARD_DOC_ID = 'main-growthboard';
        const SHARE_COLLECTION = 'growthboardReportShareLinks';

        // Firebase StorageÏóê ÎØ∏ÎîîÏñ¥ ÏóÖÎ°úÎìú
        async function uploadMediaToStorage(file, path) {
            try {
                const storageRef = storage.ref().child(path);
                const snapshot = await storageRef.put(file);
                const downloadUrl = await snapshot.ref.getDownloadURL();
                return downloadUrl;
            } catch (error) {
                console.error('Storage ÏóÖÎ°úÎìú Ïò§Î•ò:', error);
                throw error;
            }
        }

        // base64Î•º BlobÏúºÎ°ú Î≥ÄÌôò
        function base64ToBlob(base64, mimeType) {
            const byteCharacters = atob(base64.split(',')[1]);
            const byteNumbers = new Array(byteCharacters.length);
            for (let i = 0; i < byteCharacters.length; i++) {
                byteNumbers[i] = byteCharacters.charCodeAt(i);
            }
            const byteArray = new Uint8Array(byteNumbers);
            return new Blob([byteArray], { type: mimeType });
        }

        // ÎØ∏ÎîîÏñ¥ URLÏù¥ base64Ïù∏ÏßÄ ÌôïÏù∏
        function isBase64(str) {
            return str && str.startsWith('data:');
        }

        // base64 ÎØ∏ÎîîÏñ¥Î•º StorageÏóê ÏóÖÎ°úÎìúÌïòÍ≥† URLÎ°ú Î≥ÄÌôò
        async function convertBase64ToStorageUrl(base64Url, cardId, fieldName) {
            if (!isBase64(base64Url)) return base64Url;

            const mimeMatch = base64Url.match(/data:([^;]+);/);
            const mimeType = mimeMatch ? mimeMatch[1] : 'image/jpeg';
            const ext = mimeType.split('/')[1] || 'jpg';
            const blob = base64ToBlob(base64Url, mimeType);
            const path = `growthboard/${GROWTHBOARD_DOC_ID}/${cardId}_${fieldName}_${Date.now()}.${ext}`;

            return await uploadMediaToStorage(blob, path);
        }

        let itemData = {};
        let currentEditingId = null;
        let currentEditMode = 'single';
        let currentViewingId = null;
        let shareToken = new URLSearchParams(window.location.search).get('token');
        let isPresentationMode = new URLSearchParams(window.location.search).get('view') === 'presentation' || shareToken;

        // Apply presentation mode
        if (isPresentationMode) {
            document.body.classList.add('presentation-mode');
        }

        // FirestoreÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        async function loadDataFromFirestore() {
            try {
                console.log('loadDataFromFirestore ÏãúÏûë, shareToken:', shareToken);

                // Í≥µÏú† ÌÜ†ÌÅ∞Ïù¥ ÏûàÏúºÎ©¥ Ìï¥Îãπ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                if (shareToken) {
                    console.log('Í≥µÏú† ÌÜ†ÌÅ∞ÏúºÎ°ú Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏãúÎèÑ...');

                    const snapshot = await db.collection(SHARE_COLLECTION)
                        .where('token', '==', shareToken)
                        .where('isActive', '==', true)
                        .get();

                    console.log('Í≥µÏú† ÎßÅÌÅ¨ Ï°∞Ìöå Í≤∞Í≥º:', snapshot.empty ? 'ÏóÜÏùå' : 'ÏûàÏùå');

                    if (snapshot.empty) {
                        showToast('Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ Í≥µÏú† ÎßÅÌÅ¨ÏûÖÎãàÎã§');
                        return;
                    }

                    const linkDoc = snapshot.docs[0];
                    const linkData = linkDoc.data();
                    console.log('Í≥µÏú† ÎßÅÌÅ¨ Îç∞Ïù¥ÌÑ∞:', linkData);

                    // Ï°∞ÌöåÏàò Ï¶ùÍ∞Ä
                    try {
                        await linkDoc.ref.update({
                            viewCount: firebase.firestore.FieldValue.increment(1),
                            lastViewedAt: new Date().toISOString()
                        });
                    } catch (updateError) {
                        console.warn('Ï°∞ÌöåÏàò ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®:', updateError);
                    }

                    // Ïã§ÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞ Î°úÎìú (docIdÍ∞Ä ÏûàÏúºÎ©¥)
                    if (linkData.docId) {
                        console.log('docIdÎ°ú Î©îÏù∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìú:', linkData.docId);
                        const mainDoc = await db.collection('growthboardReportData').doc(linkData.docId).get();
                        console.log('Î©îÏù∏ Îç∞Ïù¥ÌÑ∞ Ï°¥Ïû¨:', mainDoc.exists);
                        if (mainDoc.exists) {
                            itemData = mainDoc.data().data || {};
                            console.log('Î°úÎìúÎêú itemData ÌÇ§:', Object.keys(itemData));
                        } else {
                            console.warn('Î©îÏù∏ Îç∞Ïù¥ÌÑ∞ Î¨∏ÏÑúÍ∞Ä Ï°¥Ïû¨ÌïòÏßÄ ÏïäÏùå');
                            showToast('ÏïÑÏßÅ Ï†ÄÏû•Îêú ÏΩòÌÖêÏ∏†Í∞Ä ÏóÜÏäµÎãàÎã§');
                        }
                    } else if (linkData.snapshotData) {
                        // Ïä§ÎÉÖÏÉ∑ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö© (ÌïòÏúÑ Ìò∏Ìôò)
                        itemData = linkData.snapshotData || {};
                        console.log('Ïä§ÎÉÖÏÉ∑ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©');
                    }
                } else {
                    // ÏùºÎ∞ò Î™®Îìú: Î©îÏù∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                    const doc = await db.collection('growthboardReportData').doc(GROWTHBOARD_DOC_ID).get();
                    if (doc.exists) {
                        itemData = doc.data().data || {};
                    } else {
                        // localStorageÏóêÏÑú ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò
                        const localData = localStorage.getItem('growthboardData');
                        if (localData) {
                            itemData = JSON.parse(localData);
                            await saveDataToFirestore(); // FirestoreÏóê Ï†ÄÏû•
                        }
                    }
                }

                restoreSavedContent();
                updateViewButtons();
            } catch (error) {
                console.error('Firestore Î°úÎìú Ïò§Î•ò:', error);
                // Ïò§ÌîÑÎùºÏù∏ fallback: localStorage
                const localData = localStorage.getItem('growthboardData');
                if (localData) {
                    itemData = JSON.parse(localData);
                    restoreSavedContent();
                    updateViewButtons();
                }
            }
        }

        // FirestoreÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
        // base64 ÎØ∏ÎîîÏñ¥Î•º Storage URLÎ°ú Î≥ÄÌôò (Ï†ÄÏû• Ï†Ñ)
        async function processMediaForStorage(data) {
            const processedData = JSON.parse(JSON.stringify(data)); // deep copy

            for (const cardId of Object.keys(processedData)) {
                const cardData = processedData[cardId];
                if (!cardData) continue;

                // Ïπ¥Îìú Î†àÎ≤® ÎØ∏ÎîîÏñ¥ Î≥ÄÌôò
                if (isBase64(cardData.mediaUrl)) {
                    cardData.mediaUrl = await convertBase64ToStorageUrl(cardData.mediaUrl, cardId, 'media');
                }
                if (isBase64(cardData.beforeMedia)) {
                    cardData.beforeMedia = await convertBase64ToStorageUrl(cardData.beforeMedia, cardId, 'before');
                }
                if (isBase64(cardData.afterMedia)) {
                    cardData.afterMedia = await convertBase64ToStorageUrl(cardData.afterMedia, cardId, 'after');
                }

                // ÏïÑÏù¥ÌÖú Î†àÎ≤® ÎØ∏ÎîîÏñ¥ Î≥ÄÌôò
                if (cardData.items && Array.isArray(cardData.items)) {
                    for (let i = 0; i < cardData.items.length; i++) {
                        const item = cardData.items[i];
                        if (isBase64(item.mediaUrl)) {
                            item.mediaUrl = await convertBase64ToStorageUrl(item.mediaUrl, `${cardId}_item${i}`, 'media');
                        }
                        if (isBase64(item.beforeMedia)) {
                            item.beforeMedia = await convertBase64ToStorageUrl(item.beforeMedia, `${cardId}_item${i}`, 'before');
                        }
                        if (isBase64(item.afterMedia)) {
                            item.afterMedia = await convertBase64ToStorageUrl(item.afterMedia, `${cardId}_item${i}`, 'after');
                        }
                    }
                }
            }

            return processedData;
        }

        // Î°úÎî© ÌëúÏãú
        function showLoading(show, text = 'Ï†ÄÏû• Ï§ë...', subText = 'ÎØ∏ÎîîÏñ¥Î•º ÏóÖÎ°úÎìúÌïòÍ≥† ÏûàÏäµÎãàÎã§') {
            const overlay = document.getElementById('loadingOverlay');
            if (show) {
                document.getElementById('loadingText').textContent = text;
                document.getElementById('loadingSubText').textContent = subText;
                overlay.style.display = 'flex';
            } else {
                overlay.style.display = 'none';
            }
        }

        async function saveDataToFirestore() {
            try {
                showLoading(true, 'Ï†ÄÏû• Ï§ë...', 'ÎØ∏ÎîîÏñ¥Î•º ÏóÖÎ°úÎìúÌïòÍ≥† ÏûàÏäµÎãàÎã§');
                console.log('Ï†ÄÏû• ÏãúÏûë, itemData ÌÇ§:', Object.keys(itemData));

                // base64 ÎØ∏ÎîîÏñ¥Î•º Storage URLÎ°ú Î≥ÄÌôò
                const processedData = await processMediaForStorage(itemData);
                console.log('ÎØ∏ÎîîÏñ¥ Ï≤òÎ¶¨ ÏôÑÎ£å, processedData ÌÇ§:', Object.keys(processedData));

                showLoading(true, 'Ï†ÄÏû• Ï§ë...', 'FirestoreÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ï§ë');

                // Î≥ÄÌôòÎêú URLÏùÑ itemDataÏóê Î∞òÏòÅ
                itemData = processedData;

                const savePayload = {
                    data: processedData,
                    updatedAt: new Date().toISOString()
                };

                await db.collection('growthboardReportData').doc(GROWTHBOARD_DOC_ID).set(savePayload, { merge: true });

                showLoading(false);
                console.log('Firestore Ï†ÄÏû• ÏôÑÎ£å!');
                showToast('Ï†ÄÏû• ÏôÑÎ£å!');
            } catch (error) {
                showLoading(false);
                console.error('Firestore Ï†ÄÏû• Ïò§Î•ò:', error);
                showToast('Ï†ÄÏû• Ïã§Ìå®: ' + error.message);
            }
        }

        function saveData() {
            saveDataToFirestore();
        }

        // ÌÜ†ÌÅ∞ ÏÉùÏÑ±
        function generateToken() {
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789';
            let token = '';
            for (let i = 0; i < 24; i++) {
                token += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return token;
        }

        // Í≥µÏú† ÎßÅÌÅ¨ ÏÉùÏÑ±
        async function createShareLink() {
            try {
                const token = generateToken();

                await db.collection(SHARE_COLLECTION).add({
                    token: token,
                    docId: GROWTHBOARD_DOC_ID,
                    isActive: true,
                    createdAt: new Date().toISOString(),
                    viewCount: 0
                });

                return token;
            } catch (error) {
                console.error('Í≥µÏú† ÎßÅÌÅ¨ ÏÉùÏÑ± Ïò§Î•ò:', error);
                throw error;
            }
        }

        // Check if URL is video
        function isVideo(url) {
            if (!url) return false;
            return url.includes('data:video') || url.includes('.mp4') || url.includes('.webm') || url.includes('.mov') || url.includes('.avi');
        }

        // Create media element
        function createMediaElement(url, className = 'viewer-media', clickable = false, clickHandler = '') {
            if (!url) {
                return `<div class="no-media-placeholder" onclick="openEditFromViewer()"><span>üì∑</span><p>ÌÅ¥Î¶≠ÌïòÏó¨ ÎØ∏ÎîîÏñ¥ Ï∂îÍ∞Ä</p></div>`;
            }
            const handler = clickable ? ` onclick="${clickHandler || "openFullscreen('single', event)"}"` : '';
            if (isVideo(url)) {
                return `<video class="${className}" src="${url}" autoplay loop muted playsinline${handler}></video>`;
            }
            return `<img class="${className}" src="${url}" alt="Media"${handler}>`;
        }

        // Open View Modal (ÏÉÅÏÑ∏ Î≥¥Í∏∞ Î™®Îã¨Î°ú Î≥ÄÍ≤Ω)
        function openViewModal(event, id) {
            event.stopPropagation();
            const data = itemData[id] || {};
            const item = document.querySelector(`[data-id="${id}"]`);
            const cardType = detectCardType(item);

            // ÏÉÅÏÑ∏ Î™®Îã¨ Ïó¥Í∏∞ (ÌÅ∞Îã®ÎùΩ + ÌïòÏúÑ Íµ¨Ï°∞)
            openDetailModal(event, id);
        }

        // Í∏∞Ï°¥ ÎØ∏ÎîîÏñ¥ Î∑∞Ïñ¥ Ïó¥Í∏∞ (ÎÇ¥Î∂Ä ÏÇ¨Ïö©)
        function openMediaViewer(event, id) {
            event.stopPropagation();
            const data = itemData[id] || {};
            const item = document.querySelector(`[data-id="${id}"]`);
            const cardType = detectCardType(item);

            // For card-items type, check if any item has media
            if (cardType === 'card-items' && data.items) {
                const itemsWithMedia = data.items.filter(i => i.mediaUrl || i.beforeMedia || i.afterMedia);
                if (itemsWithMedia.length > 0) {
                    openCardItemsViewer(event, id);
                    return;
                }
            }

            // Check if there's any card-level media
            const hasMedia = data.mediaUrl || data.beforeMedia || data.afterMedia;
            if (!hasMedia) {
                return;
            }

            currentViewingId = id;
            const mode = data.mode || 'single';

            // Update mode toggle
            document.querySelectorAll('.viewer-mode-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.mode === mode);
            });

            // Update content
            updateViewerContent(data, mode);

            document.getElementById('viewerTitle').textContent = data.title || '';
            document.getElementById('viewerDescription').textContent = data.description || '';
            document.getElementById('viewerOverlay').classList.add('active');

            setTimeout(() => {
                document.querySelectorAll('#viewerOverlay video').forEach(v => {
                    v.play().catch(() => {});
                });
            }, 100);
        }

        // Open card-items viewer (shows all items with their individual media)
        function openCardItemsViewer(event, id) {
            event.stopPropagation();
            const data = itemData[id] || {};
            currentViewingId = id;

            const container = document.getElementById('itemViewerContent');
            const items = data.items || [];

            let html = '<div style="display: flex; flex-direction: column; gap: 20px; max-height: 60vh; overflow-y: auto; padding: 10px;">';

            items.forEach((item, idx) => {
                const hasMedia = item.mediaUrl || item.beforeMedia || item.afterMedia;
                const mode = item.mode || 'single';

                html += `<div style="background: rgba(255,255,255,0.05); border-radius: 12px; padding: 16px;">`;
                html += `<div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">`;
                html += `<span style="font-size: 24px;">${item.emoji || 'üìå'}</span>`;
                html += `<div><strong style="color: white; font-size: 15px;">${escapeHtml(item.title || '')}</strong>`;
                html += `<p style="color: rgba(255,255,255,0.6); font-size: 12px; margin-top: 2px;">${escapeHtml(item.desc || '')}</p></div>`;
                html += `</div>`;

                if (hasMedia) {
                    if (mode === 'compare') {
                        html += `<div style="display: flex; gap: 16px; align-items: center; justify-content: center;">`;
                        html += `<div class="viewer-box before" onclick="openItemFullscreen('${id}', ${idx}, 'before', event)" style="flex: 1; max-width: 300px;">`;
                        html += `<div class="viewer-box-label">BEFORE</div>`;
                        html += createMediaElement(item.beforeMedia, 'viewer-media', false);
                        html += `</div>`;
                        html += `<div class="viewer-arrow">‚Üí</div>`;
                        html += `<div class="viewer-box after" onclick="openItemFullscreen('${id}', ${idx}, 'after', event)" style="flex: 1; max-width: 300px;">`;
                        html += `<div class="viewer-box-label">AFTER</div>`;
                        html += createMediaElement(item.afterMedia, 'viewer-media', false);
                        html += `</div>`;
                        html += `</div>`;
                    } else {
                        html += `<div style="text-align: center;" onclick="openItemFullscreen('${id}', ${idx}, 'single', event)">`;
                        html += createMediaElement(item.mediaUrl, 'viewer-media', false);
                        html += `<p style="font-size: 10px; color: rgba(255,255,255,0.4); margin-top: 8px;">üîç ÌÅ¥Î¶≠ÌïòÏó¨ ÌÅ¨Í≤å Î≥¥Í∏∞</p>`;
                        html += `</div>`;
                    }
                } else {
                    html += `<div style="text-align: center; padding: 20px; background: rgba(255,255,255,0.03); border-radius: 8px; color: rgba(255,255,255,0.4); font-size: 12px;">ÎØ∏ÎîîÏñ¥ ÏóÜÏùå</div>`;
                }

                html += `</div>`;
            });

            html += '</div>';
            container.innerHTML = html;

            document.getElementById('itemViewerTitle').textContent = data.title || 'Ìï≠Î™© ÏÉÅÏÑ∏ Î≥¥Í∏∞';
            document.getElementById('itemViewerDesc').textContent = data.description || '';
            document.getElementById('itemViewerOverlay').classList.add('active');

            setTimeout(() => {
                document.querySelectorAll('#itemViewerOverlay video').forEach(v => {
                    v.play().catch(() => {});
                });
            }, 100);
        }

        function openItemFullscreen(cardId, itemIdx, type, event) {
            if (event) event.stopPropagation();
            const data = itemData[cardId] || {};
            const items = data.items || [];
            const item = items[itemIdx];
            if (!item) return;

            let mediaUrl;
            if (type === 'before') mediaUrl = item.beforeMedia;
            else if (type === 'after') mediaUrl = item.afterMedia;
            else mediaUrl = item.mediaUrl;

            if (!mediaUrl) return;

            const fullscreenEl = document.getElementById('fullscreenContent');
            if (isVideo(mediaUrl)) {
                fullscreenEl.innerHTML = `<video class="fullscreen-media" src="${mediaUrl}" autoplay loop muted playsinline controls></video>`;
            } else {
                fullscreenEl.innerHTML = `<img class="fullscreen-media" src="${mediaUrl}" alt="Full size">`;
            }
            document.getElementById('fullscreenOverlay').classList.add('active');
        }

        function openDescFullscreen(cardId, descIdx, type, event) {
            if (event) event.stopPropagation();
            const data = itemData[cardId] || {};
            const descriptions = data.descriptions || [];
            const desc = descriptions[descIdx];
            if (!desc) return;

            let mediaUrl;
            if (type === 'before') mediaUrl = desc.beforeMedia;
            else if (type === 'after') mediaUrl = desc.afterMedia;
            else mediaUrl = desc.mediaUrl;

            if (!mediaUrl) return;

            const fullscreenEl = document.getElementById('fullscreenContent');
            if (isVideo(mediaUrl)) {
                fullscreenEl.innerHTML = `<video class="fullscreen-media" src="${mediaUrl}" autoplay loop muted playsinline controls></video>`;
            } else {
                fullscreenEl.innerHTML = `<img class="fullscreen-media" src="${mediaUrl}" alt="Full size">`;
            }
            document.getElementById('fullscreenOverlay').classList.add('active');
        }

        function closeItemViewer() {
            document.getElementById('itemViewerOverlay').classList.remove('active');
            document.querySelectorAll('#itemViewerOverlay video').forEach(v => v.pause());
        }

        function updateViewerContent(data, mode) {
            const singleEl = document.getElementById('viewerSingle');
            const compareEl = document.getElementById('viewerCompare');
            const container = document.getElementById('viewerContainer');
            const singleHint = document.getElementById('singleHint');

            if (mode === 'compare') {
                singleEl.classList.remove('active');
                compareEl.classList.add('active');
                container.classList.add('compare-mode');
                document.getElementById('viewerBeforeMedia').innerHTML = createMediaElement(data.beforeMedia);
                document.getElementById('viewerAfterMedia').innerHTML = createMediaElement(data.afterMedia);
            } else {
                compareEl.classList.remove('active');
                singleEl.classList.add('active');
                container.classList.remove('compare-mode');
                document.getElementById('viewerSingleMedia').innerHTML = createMediaElement(data.mediaUrl, 'viewer-media', true);
                if (singleHint) singleHint.style.display = data.mediaUrl ? 'block' : 'none';
            }
        }

        function switchViewerMode(mode) {
            document.querySelectorAll('.viewer-mode-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.mode === mode);
            });
            const data = itemData[currentViewingId] || {};
            updateViewerContent(data, mode);

            if (currentViewingId) {
                itemData[currentViewingId] = { ...data, mode };
                saveData();
            }
        }

        function closeViewer() {
            document.getElementById('viewerOverlay').classList.remove('active');
            document.getElementById('viewerContainer').classList.remove('compare-mode');
            document.querySelectorAll('#viewerOverlay video').forEach(v => v.pause());
        }

        // Fullscreen functions
        function openFullscreen(type, event) {
            if (event) event.stopPropagation();
            const data = itemData[currentViewingId] || {};
            let mediaUrl;

            if (type === 'before') mediaUrl = data.beforeMedia;
            else if (type === 'after') mediaUrl = data.afterMedia;
            else if (type === 'single') mediaUrl = data.mediaUrl;

            if (!mediaUrl) return;

            const fullscreenEl = document.getElementById('fullscreenContent');
            if (isVideo(mediaUrl)) {
                fullscreenEl.innerHTML = `<video class="fullscreen-media" src="${mediaUrl}" autoplay loop muted playsinline controls></video>`;
            } else {
                fullscreenEl.innerHTML = `<img class="fullscreen-media" src="${mediaUrl}" alt="Full size">`;
            }
            document.getElementById('fullscreenOverlay').classList.add('active');
        }

        function closeFullscreen() {
            document.getElementById('fullscreenOverlay').classList.remove('active');
            document.querySelectorAll('#fullscreenOverlay video').forEach(v => v.pause());
            document.getElementById('fullscreenContent').innerHTML = '';
        }

        function openEditFromViewer() {
            closeViewer();
            if (currentViewingId) {
                openEditModal({ stopPropagation: () => {} }, currentViewingId);
            }
        }

        // Detect card type
        function detectCardType(item) {
            if (!item) return 'unknown';
            if (item.querySelector('.step-title')) return 'step';
            if (item.querySelector('.pipeline-value')) return 'pipeline';
            if (item.querySelector('.feature-title')) return 'feature';
            if (item.querySelector('.mini-title')) return 'mini';
            if (item.querySelector('.card-content .problem-item')) return 'card-items';
            if (item.matches('.ba-list li')) return 'list-item';
            return 'unknown';
        }

        // Get items from card (with media support)
        function getCardItems(item, savedData) {
            const items = [];
            const problemItems = item.querySelectorAll('.problem-item');
            const savedItems = savedData?.items || [];

            problemItems.forEach((pi, idx) => {
                const emoji = pi.querySelector('span')?.textContent || 'üìå';
                const title = pi.querySelector('.problem-text strong')?.textContent || '';
                const desc = pi.querySelector('.problem-text span')?.textContent || '';

                // Merge with saved media data if available
                const savedItem = savedItems[idx] || {};
                items.push({
                    emoji,
                    title,
                    desc,
                    mode: savedItem.mode || 'single',
                    mediaUrl: savedItem.mediaUrl || '',
                    beforeMedia: savedItem.beforeMedia || '',
                    afterMedia: savedItem.afterMedia || ''
                });
            });
            return items;
        }

        // Render items editor with per-item media support
        function renderItemsEditor(items) {
            const container = document.getElementById('itemsList');
            container.innerHTML = items.map((item, idx) => `
                <div class="item-edit-row" data-idx="${idx}" data-mode="${item.mode || 'single'}">
                    <div class="item-edit-header">
                        <input type="text" class="item-edit-emoji" value="${item.emoji || 'üìå'}" maxlength="2">
                        <div class="item-edit-fields">
                            <input type="text" class="item-edit-title" value="${escapeHtml(item.title || '')}" placeholder="Ï†úÎ™©">
                            <input type="text" class="item-edit-desc" value="${escapeHtml(item.desc || '')}" placeholder="ÏÑ§Î™Ö">
                        </div>
                        <button type="button" class="item-edit-delete" onclick="deleteItem(${idx})">üóë</button>
                    </div>
                    <div class="item-media-section">
                        <div class="item-media-header">
                            <span class="item-media-label">üì∑ ÎØ∏ÎîîÏñ¥</span>
                            <div class="item-mode-toggle">
                                <button type="button" class="item-mode-btn ${(item.mode || 'single') === 'single' ? 'active' : ''}" onclick="switchItemMode(${idx}, 'single')">ÏùºÎ∞ò</button>
                                <button type="button" class="item-mode-btn ${item.mode === 'compare' ? 'active' : ''}" onclick="switchItemMode(${idx}, 'compare')">Ï†Ñ/ÌõÑÎπÑÍµê</button>
                            </div>
                        </div>
                        <div class="item-media-uploads" id="itemMedia-${idx}">
                            ${item.mode === 'compare' ? `
                                <div class="item-media-box before-box" onclick="triggerItemMediaUpload(${idx}, 'before')" id="itemBefore-${idx}" data-media-url="${item.beforeMedia || ''}">
                                    ${item.beforeMedia ? createItemMediaPreview(item.beforeMedia) : '<span>üî¥</span><p>Before</p>'}
                                </div>
                                <div class="item-media-box after-box" onclick="triggerItemMediaUpload(${idx}, 'after')" id="itemAfter-${idx}" data-media-url="${item.afterMedia || ''}">
                                    ${item.afterMedia ? createItemMediaPreview(item.afterMedia) : '<span>üü¢</span><p>After</p>'}
                                </div>
                            ` : `
                                <div class="item-media-box" onclick="triggerItemMediaUpload(${idx}, 'single')" id="itemSingle-${idx}" data-media-url="${item.mediaUrl || ''}">
                                    ${item.mediaUrl ? createItemMediaPreview(item.mediaUrl) : '<span>üì∑</span><p>ÌÅ¥Î¶≠ÌïòÏó¨ ÏóÖÎ°úÎìú</p>'}
                                </div>
                            `}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function createItemMediaPreview(url) {
            if (!url) return '<span>üì∑</span><p>ÏóÖÎ°úÎìú</p>';
            if (isVideo(url)) {
                return `<video src="${url}" muted style="max-width:100%;max-height:100%;"></video>`;
            }
            return `<img src="${url}" style="max-width:100%;max-height:100%;">`;
        }

        let currentItemMediaUpload = { idx: null, type: null };

        function triggerItemMediaUpload(idx, type) {
            currentItemMediaUpload = { idx, type };

            // Highlight selected box
            document.querySelectorAll('.item-media-box').forEach(b => b.classList.remove('paste-target'));
            const boxId = type === 'before' ? `itemBefore-${idx}` : type === 'after' ? `itemAfter-${idx}` : `itemSingle-${idx}`;
            const box = document.getElementById(boxId);
            if (box) box.classList.add('paste-target');

            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*,video/*';
            input.onchange = (e) => handleItemMediaUpload(e, idx, type);
            input.click();
        }

        function handleItemMediaUpload(event, idx, type) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const url = e.target.result;
                updateItemMediaPreview(idx, type, url);
            };
            reader.readAsDataURL(file);
        }

        function updateItemMediaPreview(idx, type, url) {
            let boxId;
            if (type === 'before') boxId = `itemBefore-${idx}`;
            else if (type === 'after') boxId = `itemAfter-${idx}`;
            else boxId = `itemSingle-${idx}`;

            const box = document.getElementById(boxId);
            if (box) {
                box.innerHTML = createItemMediaPreview(url);
                box.dataset.mediaUrl = url;
            }
        }

        function switchItemMode(idx, mode) {
            const row = document.querySelector(`[data-idx="${idx}"]`);
            if (!row) return;

            // Update buttons
            row.querySelectorAll('.item-mode-btn').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.includes(mode === 'single' ? 'ÏùºÎ∞ò' : 'Ï†Ñ/ÌõÑ'));
            });

            // Get current media data
            const currentSingle = document.getElementById(`itemSingle-${idx}`)?.dataset?.mediaUrl || '';
            const currentBefore = document.getElementById(`itemBefore-${idx}`)?.dataset?.mediaUrl || '';
            const currentAfter = document.getElementById(`itemAfter-${idx}`)?.dataset?.mediaUrl || '';

            const uploadsContainer = document.getElementById(`itemMedia-${idx}`);
            if (mode === 'compare') {
                uploadsContainer.innerHTML = `
                    <div class="item-media-box before-box" onclick="triggerItemMediaUpload(${idx}, 'before')" id="itemBefore-${idx}" data-media-url="${currentBefore}">
                        ${currentBefore ? createItemMediaPreview(currentBefore) : '<span>üî¥</span><p>Before</p>'}
                    </div>
                    <div class="item-media-box after-box" onclick="triggerItemMediaUpload(${idx}, 'after')" id="itemAfter-${idx}" data-media-url="${currentAfter}">
                        ${currentAfter ? createItemMediaPreview(currentAfter) : '<span>üü¢</span><p>After</p>'}
                    </div>
                `;
            } else {
                uploadsContainer.innerHTML = `
                    <div class="item-media-box" onclick="triggerItemMediaUpload(${idx}, 'single')" id="itemSingle-${idx}" data-media-url="${currentSingle}">
                        ${currentSingle ? createItemMediaPreview(currentSingle) : '<span>üì∑</span><p>ÌÅ¥Î¶≠ÌïòÏó¨ ÏóÖÎ°úÎìú</p>'}
                    </div>
                `;
            }

            // Store mode in row data
            row.dataset.mode = mode;
        }

        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function addNewItem() {
            const container = document.getElementById('itemsList');
            const idx = container.children.length;
            const newRow = document.createElement('div');
            newRow.className = 'item-edit-row';
            newRow.dataset.idx = idx;
            newRow.dataset.mode = 'single';
            newRow.innerHTML = `
                <div class="item-edit-header">
                    <input type="text" class="item-edit-emoji" value="üìå" maxlength="2">
                    <div class="item-edit-fields">
                        <input type="text" class="item-edit-title" value="" placeholder="Ï†úÎ™©">
                        <input type="text" class="item-edit-desc" value="" placeholder="ÏÑ§Î™Ö">
                    </div>
                    <button type="button" class="item-edit-delete" onclick="deleteItem(${idx})">üóë</button>
                </div>
                <div class="item-media-section">
                    <div class="item-media-header">
                        <span class="item-media-label">üì∑ ÎØ∏ÎîîÏñ¥</span>
                        <div class="item-mode-toggle">
                            <button type="button" class="item-mode-btn active" onclick="switchItemMode(${idx}, 'single')">ÏùºÎ∞ò</button>
                            <button type="button" class="item-mode-btn" onclick="switchItemMode(${idx}, 'compare')">Ï†Ñ/ÌõÑÎπÑÍµê</button>
                        </div>
                    </div>
                    <div class="item-media-uploads" id="itemMedia-${idx}">
                        <div class="item-media-box" onclick="triggerItemMediaUpload(${idx}, 'single')" id="itemSingle-${idx}" data-media-url="">
                            <span>üì∑</span><p>ÌÅ¥Î¶≠ÌïòÏó¨ ÏóÖÎ°úÎìú</p>
                        </div>
                    </div>
                </div>
            `;
            container.appendChild(newRow);
            newRow.querySelector('.item-edit-title').focus();
        }

        function deleteItem(idx) {
            const rows = document.querySelectorAll('#itemsList .item-edit-row');
            if (rows.length > 1) {
                rows[idx]?.remove();
                // Re-index all rows
                document.querySelectorAll('#itemsList .item-edit-row').forEach((row, i) => {
                    row.dataset.idx = i;
                    const deleteBtn = row.querySelector('.item-edit-delete');
                    if (deleteBtn) deleteBtn.onclick = () => deleteItem(i);

                    // Update media section IDs
                    const mediaUploads = row.querySelector('.item-media-uploads');
                    if (mediaUploads) mediaUploads.id = `itemMedia-${i}`;

                    const singleBox = row.querySelector('[id^="itemSingle-"]');
                    if (singleBox) {
                        singleBox.id = `itemSingle-${i}`;
                        singleBox.onclick = () => triggerItemMediaUpload(i, 'single');
                    }
                    const beforeBox = row.querySelector('[id^="itemBefore-"]');
                    if (beforeBox) {
                        beforeBox.id = `itemBefore-${i}`;
                        beforeBox.onclick = () => triggerItemMediaUpload(i, 'before');
                    }
                    const afterBox = row.querySelector('[id^="itemAfter-"]');
                    if (afterBox) {
                        afterBox.id = `itemAfter-${i}`;
                        afterBox.onclick = () => triggerItemMediaUpload(i, 'after');
                    }

                    // Update mode toggle buttons
                    row.querySelectorAll('.item-mode-btn').forEach(btn => {
                        if (btn.textContent.includes('ÏùºÎ∞ò')) {
                            btn.onclick = () => switchItemMode(i, 'single');
                        } else {
                            btn.onclick = () => switchItemMode(i, 'compare');
                        }
                    });
                });
            } else {
                alert('ÏµúÏÜå 1Í∞úÏùò Ìï≠Î™©Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
            }
        }

        function getEditedItems() {
            const items = [];
            document.querySelectorAll('#itemsList .item-edit-row').forEach(row => {
                const idx = parseInt(row.dataset.idx);
                const mode = row.dataset.mode || 'single';

                const singleBox = document.getElementById(`itemSingle-${idx}`);
                const beforeBox = document.getElementById(`itemBefore-${idx}`);
                const afterBox = document.getElementById(`itemAfter-${idx}`);

                items.push({
                    emoji: row.querySelector('.item-edit-emoji')?.value || 'üìå',
                    title: row.querySelector('.item-edit-title')?.value || '',
                    desc: row.querySelector('.item-edit-desc')?.value || '',
                    mode: mode,
                    mediaUrl: singleBox?.dataset?.mediaUrl || '',
                    beforeMedia: beforeBox?.dataset?.mediaUrl || '',
                    afterMedia: afterBox?.dataset?.mediaUrl || ''
                });
            });
            return items.filter(i => i.title.trim());
        }

        // Multiple Descriptions Support
        let currentDescMediaUpload = { idx: null, type: null };

        function renderDescriptionsEditor(descriptions) {
            const container = document.getElementById('descriptionsList');
            container.innerHTML = descriptions.map((desc, idx) => `
                <div class="desc-edit-row" data-idx="${idx}" data-mode="${desc.mode || 'single'}">
                    <div class="desc-edit-header">
                        <input type="text" class="desc-title-input" value="${escapeHtml(desc.title || `ÏÑ§Î™Ö ${idx + 1}`)}" placeholder="ÏÑ§Î™Ö Ï†úÎ™©">
                        <button type="button" class="desc-edit-delete" onclick="deleteDescription(${idx})">üóë</button>
                    </div>
                    <div class="desc-media-section">
                        <div class="desc-media-header">
                            <span class="desc-media-label">üì∑ ÎØ∏ÎîîÏñ¥</span>
                            <div class="desc-mode-toggle">
                                <button type="button" class="desc-mode-btn ${(desc.mode || 'single') === 'single' ? 'active' : ''}" onclick="switchDescMode(${idx}, 'single')">ÏùºÎ∞ò</button>
                                <button type="button" class="desc-mode-btn ${desc.mode === 'compare' ? 'active' : ''}" onclick="switchDescMode(${idx}, 'compare')">Ï†Ñ/ÌõÑÎπÑÍµê</button>
                            </div>
                        </div>
                        <div class="desc-media-uploads" id="descMedia-${idx}">
                            ${desc.mode === 'compare' ? `
                                <div class="desc-media-box before-box" onclick="triggerDescMediaUpload(${idx}, 'before')" id="descBefore-${idx}" data-media-url="${desc.beforeMedia || ''}">
                                    ${desc.beforeMedia ? createDescMediaPreview(desc.beforeMedia) : '<span>üî¥</span><p>Before</p>'}
                                </div>
                                <div class="desc-media-box after-box" onclick="triggerDescMediaUpload(${idx}, 'after')" id="descAfter-${idx}" data-media-url="${desc.afterMedia || ''}">
                                    ${desc.afterMedia ? createDescMediaPreview(desc.afterMedia) : '<span>üü¢</span><p>After</p>'}
                                </div>
                            ` : `
                                <div class="desc-media-box" onclick="triggerDescMediaUpload(${idx}, 'single')" id="descSingle-${idx}" data-media-url="${desc.mediaUrl || ''}">
                                    ${desc.mediaUrl ? createDescMediaPreview(desc.mediaUrl) : '<span>üì∑</span><p>ÌÅ¥Î¶≠ÌïòÏó¨ ÏóÖÎ°úÎìú</p>'}
                                </div>
                            `}
                        </div>
                    </div>
                    <textarea class="desc-text-area" placeholder="ÏÑ§Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">${escapeHtml(desc.text || '')}</textarea>
                </div>
            `).join('');
        }

        function createDescMediaPreview(url) {
            if (!url) return '<span>üì∑</span><p>ÏóÖÎ°úÎìú</p>';
            if (isVideo(url)) {
                return `<video src="${url}" muted style="max-width:100%;max-height:100%;"></video>`;
            }
            return `<img src="${url}" style="max-width:100%;max-height:100%;">`;
        }

        function triggerDescMediaUpload(idx, type) {
            currentDescMediaUpload = { idx, type };

            document.querySelectorAll('.desc-media-box').forEach(b => b.classList.remove('paste-target'));
            const boxId = type === 'before' ? `descBefore-${idx}` : type === 'after' ? `descAfter-${idx}` : `descSingle-${idx}`;
            const box = document.getElementById(boxId);
            if (box) box.classList.add('paste-target');

            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*,video/*';
            input.onchange = (e) => handleDescMediaUpload(e, idx, type);
            input.click();
        }

        function handleDescMediaUpload(event, idx, type) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const url = e.target.result;
                updateDescMediaPreview(idx, type, url);
            };
            reader.readAsDataURL(file);
        }

        function updateDescMediaPreview(idx, type, url) {
            let boxId;
            if (type === 'before') boxId = `descBefore-${idx}`;
            else if (type === 'after') boxId = `descAfter-${idx}`;
            else boxId = `descSingle-${idx}`;

            const box = document.getElementById(boxId);
            if (box) {
                box.innerHTML = createDescMediaPreview(url);
                box.dataset.mediaUrl = url;
            }
        }

        function switchDescMode(idx, mode) {
            const row = document.querySelector(`.desc-edit-row[data-idx="${idx}"]`);
            if (!row) return;

            row.dataset.mode = mode;

            row.querySelectorAll('.desc-mode-btn').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.includes(mode === 'single' ? 'ÏùºÎ∞ò' : 'Ï†Ñ/ÌõÑ'));
            });

            const currentSingle = document.getElementById(`descSingle-${idx}`)?.dataset?.mediaUrl || '';
            const currentBefore = document.getElementById(`descBefore-${idx}`)?.dataset?.mediaUrl || '';
            const currentAfter = document.getElementById(`descAfter-${idx}`)?.dataset?.mediaUrl || '';

            const uploadsContainer = document.getElementById(`descMedia-${idx}`);
            if (mode === 'compare') {
                uploadsContainer.innerHTML = `
                    <div class="desc-media-box before-box" onclick="triggerDescMediaUpload(${idx}, 'before')" id="descBefore-${idx}" data-media-url="${currentBefore}">
                        ${currentBefore ? createDescMediaPreview(currentBefore) : '<span>üî¥</span><p>Before</p>'}
                    </div>
                    <div class="desc-media-box after-box" onclick="triggerDescMediaUpload(${idx}, 'after')" id="descAfter-${idx}" data-media-url="${currentAfter}">
                        ${currentAfter ? createDescMediaPreview(currentAfter) : '<span>üü¢</span><p>After</p>'}
                    </div>
                `;
            } else {
                uploadsContainer.innerHTML = `
                    <div class="desc-media-box" onclick="triggerDescMediaUpload(${idx}, 'single')" id="descSingle-${idx}" data-media-url="${currentSingle}">
                        ${currentSingle ? createDescMediaPreview(currentSingle) : '<span>üì∑</span><p>ÌÅ¥Î¶≠ÌïòÏó¨ ÏóÖÎ°úÎìú</p>'}
                    </div>
                `;
            }
        }

        function addNewDescription() {
            const container = document.getElementById('descriptionsList');
            const idx = container.children.length;
            const newRow = document.createElement('div');
            newRow.className = 'desc-edit-row';
            newRow.dataset.idx = idx;
            newRow.dataset.mode = 'single';
            newRow.innerHTML = `
                <div class="desc-edit-header">
                    <input type="text" class="desc-title-input" value="ÏÑ§Î™Ö ${idx + 1}" placeholder="ÏÑ§Î™Ö Ï†úÎ™©">
                    <button type="button" class="desc-edit-delete" onclick="deleteDescription(${idx})">üóë</button>
                </div>
                <div class="desc-media-section">
                    <div class="desc-media-header">
                        <span class="desc-media-label">üì∑ ÎØ∏ÎîîÏñ¥</span>
                        <div class="desc-mode-toggle">
                            <button type="button" class="desc-mode-btn active" onclick="switchDescMode(${idx}, 'single')">ÏùºÎ∞ò</button>
                            <button type="button" class="desc-mode-btn" onclick="switchDescMode(${idx}, 'compare')">Ï†Ñ/ÌõÑÎπÑÍµê</button>
                        </div>
                    </div>
                    <div class="desc-media-uploads" id="descMedia-${idx}">
                        <div class="desc-media-box" onclick="triggerDescMediaUpload(${idx}, 'single')" id="descSingle-${idx}">
                            <span>üì∑</span><p>ÌÅ¥Î¶≠ÌïòÏó¨ ÏóÖÎ°úÎìú</p>
                        </div>
                    </div>
                </div>
                <textarea class="desc-text-area" placeholder="ÏÑ§Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"></textarea>
            `;
            container.appendChild(newRow);
            newRow.querySelector('.desc-title-input').focus();
        }

        function deleteDescription(idx) {
            const rows = document.querySelectorAll('#descriptionsList .desc-edit-row');
            if (rows.length > 1) {
                rows[idx]?.remove();
                // Re-index all rows
                document.querySelectorAll('#descriptionsList .desc-edit-row').forEach((row, i) => {
                    row.dataset.idx = i;
                    const deleteBtn = row.querySelector('.desc-edit-delete');
                    if (deleteBtn) deleteBtn.onclick = () => deleteDescription(i);

                    const mediaUploads = row.querySelector('.desc-media-uploads');
                    if (mediaUploads) mediaUploads.id = `descMedia-${i}`;

                    const singleBox = row.querySelector('[id^="descSingle-"]');
                    if (singleBox) {
                        singleBox.id = `descSingle-${i}`;
                        singleBox.onclick = () => triggerDescMediaUpload(i, 'single');
                    }
                    const beforeBox = row.querySelector('[id^="descBefore-"]');
                    if (beforeBox) {
                        beforeBox.id = `descBefore-${i}`;
                        beforeBox.onclick = () => triggerDescMediaUpload(i, 'before');
                    }
                    const afterBox = row.querySelector('[id^="descAfter-"]');
                    if (afterBox) {
                        afterBox.id = `descAfter-${i}`;
                        afterBox.onclick = () => triggerDescMediaUpload(i, 'after');
                    }

                    row.querySelectorAll('.desc-mode-btn').forEach(btn => {
                        if (btn.textContent.includes('ÏùºÎ∞ò')) {
                            btn.onclick = () => switchDescMode(i, 'single');
                        } else {
                            btn.onclick = () => switchDescMode(i, 'compare');
                        }
                    });
                });
            } else {
                alert('ÏµúÏÜå 1Í∞úÏùò ÏÑ§Î™ÖÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
            }
        }

        function getEditedDescriptions() {
            const descriptions = [];
            document.querySelectorAll('#descriptionsList .desc-edit-row').forEach(row => {
                const idx = parseInt(row.dataset.idx);
                const mode = row.dataset.mode || 'single';

                const singleBox = document.getElementById(`descSingle-${idx}`);
                const beforeBox = document.getElementById(`descBefore-${idx}`);
                const afterBox = document.getElementById(`descAfter-${idx}`);

                descriptions.push({
                    title: row.querySelector('.desc-title-input')?.value || `ÏÑ§Î™Ö ${idx + 1}`,
                    mode: mode,
                    text: row.querySelector('.desc-text-area')?.value || '',
                    mediaUrl: singleBox?.dataset?.mediaUrl || '',
                    beforeMedia: beforeBox?.dataset?.mediaUrl || '',
                    afterMedia: afterBox?.dataset?.mediaUrl || ''
                });
            });
            return descriptions;
        }

        let currentCardType = 'unknown';

        // Open Edit Modal
        function openEditModal(event, id) {
            if (isPresentationMode) return;
            event.stopPropagation();
            currentEditingId = id;
            const data = itemData[id] || {};
            currentEditMode = data.mode || 'single';

            const item = document.querySelector(`[data-id="${id}"]`);
            currentCardType = detectCardType(item);

            // Set mode buttons
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.mode === currentEditMode);
            });

            // Show/hide upload sections
            document.getElementById('singleUpload').style.display = currentEditMode === 'single' ? 'block' : 'none';
            document.getElementById('compareUpload').style.display = currentEditMode === 'compare' ? 'block' : 'none';

            // Get current text from DOM if no saved data
            let currentTitle = data.title || '';
            let currentDesc = data.description || '';

            if (item) {
                if (!currentTitle) {
                    const stepTitle = item.querySelector('.step-title');
                    const pipelineValue = item.querySelector('.pipeline-value');
                    const featureTitle = item.querySelector('.feature-title');
                    const miniTitle = item.querySelector('.mini-title');
                    const cardTitle = item.querySelector('.card-title');

                    if (stepTitle) currentTitle = stepTitle.textContent.trim();
                    else if (pipelineValue) currentTitle = pipelineValue.textContent.trim();
                    else if (featureTitle) currentTitle = featureTitle.textContent.trim();
                    else if (miniTitle) currentTitle = miniTitle.textContent.trim();
                    else if (cardTitle) {
                        currentTitle = Array.from(cardTitle.childNodes)
                            .filter(n => n.nodeType === 3 || (n.nodeType === 1 && !n.classList.contains('card-title-icon')))
                            .map(n => n.textContent).join('').trim();
                    }
                    else if (currentCardType === 'list-item') {
                        currentTitle = item.textContent.replace(/[üëÅ‚úèÔ∏è]/g, '').trim();
                    }
                }
                if (!currentDesc) {
                    const stepDesc = item.querySelector('.step-desc');
                    const pipelineLabel = item.querySelector('.pipeline-label');
                    const featureDesc = item.querySelector('.feature-desc');
                    const miniDesc = item.querySelector('.mini-desc');

                    currentDesc = (stepDesc?.textContent || pipelineLabel?.textContent || featureDesc?.textContent || miniDesc?.textContent || '').trim();
                }
            }

            // Fill form
            document.getElementById('editTitle').value = currentTitle;
            document.getElementById('editDescription').value = currentDesc;

            // Handle items section for card-items type
            const itemsSection = document.getElementById('itemsEditSection');
            const descriptionsSection = document.getElementById('descriptionsEditSection');
            const singleDescSection = document.getElementById('singleDescriptionSection');

            if (currentCardType === 'card-items' && item) {
                itemsSection.style.display = 'block';
                descriptionsSection.style.display = 'none';
                singleDescSection.style.display = 'block';
                // Hide card-level media upload for card-items type (use per-item media instead)
                document.getElementById('singleUpload').style.display = 'none';
                document.getElementById('compareUpload').style.display = 'none';
                document.querySelector('.mode-selector').style.display = 'none';

                const items = data.items && data.items.length > 0 ? data.items : getCardItems(item, data);
                renderItemsEditor(items.length ? items : [{ emoji: 'üìå', title: '', desc: '', mode: 'single' }]);
            } else if (currentCardType === 'pipeline') {
                // Pipeline type uses multiple descriptions
                itemsSection.style.display = 'none';
                descriptionsSection.style.display = 'block';
                singleDescSection.style.display = 'none';
                document.querySelector('.mode-selector').style.display = 'none';
                document.getElementById('singleUpload').style.display = 'none';
                document.getElementById('compareUpload').style.display = 'none';

                // Load existing descriptions or create default
                const descriptions = data.descriptions && data.descriptions.length > 0
                    ? data.descriptions
                    : [{ mode: currentEditMode, text: currentDesc, mediaUrl: data.mediaUrl || '', beforeMedia: data.beforeMedia || '', afterMedia: data.afterMedia || '' }];
                renderDescriptionsEditor(descriptions);
            } else {
                itemsSection.style.display = 'none';
                descriptionsSection.style.display = 'none';
                singleDescSection.style.display = 'block';
                document.querySelector('.mode-selector').style.display = 'flex';
            }

            // Set previews for non-card-items types
            updatePreview('mediaPreview', data.mediaUrl);
            updatePreview('beforePreview', data.beforeMedia);
            updatePreview('afterPreview', data.afterMedia);

            document.getElementById('editModal').classList.add('active');
        }

        function updatePreview(elementId, url) {
            const el = document.getElementById(elementId);
            if (!el) return;
            if (url) {
                if (isVideo(url)) {
                    el.innerHTML = `<video src="${url}" autoplay loop muted playsinline style="max-width:100%;max-height:100%;"></video>`;
                } else {
                    el.innerHTML = `<img src="${url}" style="max-width:100%;max-height:100%;">`;
                }
            } else {
                el.innerHTML = `<span style="font-size: 24px;">üì∑</span><p class="media-preview-text">ÎØ∏ÎîîÏñ¥ ÏóÖÎ°úÎìú</p>`;
            }
        }

        function selectEditMode(mode) {
            currentEditMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.mode === mode);
            });
            document.getElementById('singleUpload').style.display = mode === 'single' ? 'block' : 'none';
            document.getElementById('compareUpload').style.display = mode === 'compare' ? 'block' : 'none';
        }

        function closeModal() {
            document.getElementById('editModal').classList.remove('active');
            currentEditingId = null;
        }

        function handleMediaUpload(event, type) {
            const file = event.target.files[0];
            if (file) processMediaFile(file, type);
        }

        function processMediaFile(file, type) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const url = e.target.result;
                if (type === 'single') {
                    updatePreview('mediaPreview', url);
                    if (!itemData[currentEditingId]) itemData[currentEditingId] = {};
                    itemData[currentEditingId].mediaUrl = url;
                } else if (type === 'before') {
                    updatePreview('beforePreview', url);
                    if (!itemData[currentEditingId]) itemData[currentEditingId] = {};
                    itemData[currentEditingId].beforeMedia = url;
                } else if (type === 'after') {
                    updatePreview('afterPreview', url);
                    if (!itemData[currentEditingId]) itemData[currentEditingId] = {};
                    itemData[currentEditingId].afterMedia = url;
                }
            };
            reader.readAsDataURL(file);
        }

        // Paste handler
        document.addEventListener('paste', function(event) {
            if (!document.getElementById('editModal').classList.contains('active')) return;
            const items = event.clipboardData?.items;
            if (!items) return;
            for (let i = 0; i < items.length; i++) {
                if (items[i].type.startsWith('image/') || items[i].type.startsWith('video/')) {
                    event.preventDefault();
                    const file = items[i].getAsFile();
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const url = e.target.result;

                            // For card-items type
                            if (currentCardType === 'card-items') {
                                // Find active/focused media box or use first item
                                let targetIdx = currentItemMediaUpload.idx;
                                let targetType = currentItemMediaUpload.type || 'single';

                                // If no box selected, find first available box
                                if (targetIdx === null) {
                                    const firstRow = document.querySelector('#itemsList .item-edit-row');
                                    if (firstRow) {
                                        targetIdx = 0;
                                        const mode = firstRow.dataset.mode || 'single';
                                        targetType = mode === 'compare' ? 'before' : 'single';
                                    }
                                }

                                if (targetIdx !== null) {
                                    updateItemMediaPreview(targetIdx, targetType, url);
                                    // Visual feedback
                                    const box = document.getElementById(targetType === 'before' ? `itemBefore-${targetIdx}` : targetType === 'after' ? `itemAfter-${targetIdx}` : `itemSingle-${targetIdx}`);
                                    if (box) {
                                        box.style.transition = 'box-shadow 0.3s';
                                        box.style.boxShadow = '0 0 10px var(--color-accent)';
                                        setTimeout(() => box.style.boxShadow = '', 500);
                                    }
                                }
                            } else if (currentCardType === 'pipeline') {
                                // For pipeline type - paste to descriptions
                                let targetIdx = currentDescMediaUpload.idx;
                                let targetType = currentDescMediaUpload.type || 'single';

                                // If no box selected, find first available box
                                if (targetIdx === null) {
                                    const firstRow = document.querySelector('#descriptionsList .desc-edit-row');
                                    if (firstRow) {
                                        targetIdx = 0;
                                        const mode = firstRow.dataset.mode || 'single';
                                        targetType = mode === 'compare' ? 'before' : 'single';
                                    }
                                }

                                if (targetIdx !== null) {
                                    updateDescMediaPreview(targetIdx, targetType, url);
                                    // Visual feedback
                                    const box = document.getElementById(targetType === 'before' ? `descBefore-${targetIdx}` : targetType === 'after' ? `descAfter-${targetIdx}` : `descSingle-${targetIdx}`);
                                    if (box) {
                                        box.style.transition = 'box-shadow 0.3s';
                                        box.style.boxShadow = '0 0 10px var(--color-accent)';
                                        setTimeout(() => box.style.boxShadow = '', 500);
                                    }
                                }
                            } else {
                                // For non-card-items types
                                const type = currentEditMode === 'single' ? 'single' : 'before';
                                if (type === 'single') {
                                    updatePreview('mediaPreview', url);
                                    if (!itemData[currentEditingId]) itemData[currentEditingId] = {};
                                    itemData[currentEditingId].mediaUrl = url;
                                } else {
                                    updatePreview('beforePreview', url);
                                    if (!itemData[currentEditingId]) itemData[currentEditingId] = {};
                                    itemData[currentEditingId].beforeMedia = url;
                                }
                            }
                        };
                        reader.readAsDataURL(file);
                    }
                    return;
                }
            }
        });

        function saveChanges() {
            if (!currentEditingId) return;
            const newTitle = document.getElementById('editTitle').value;
            const newDesc = document.getElementById('editDescription').value;

            // Get items if card-items type
            let editedItems = null;
            if (currentCardType === 'card-items') {
                editedItems = getEditedItems();
            }

            // Get descriptions if pipeline type
            let editedDescriptions = null;
            if (currentCardType === 'pipeline') {
                editedDescriptions = getEditedDescriptions();
            }

            itemData[currentEditingId] = {
                ...itemData[currentEditingId],
                mode: currentEditMode,
                title: newTitle,
                description: newDesc,
                ...(editedItems && { items: editedItems }),
                ...(editedDescriptions && { descriptions: editedDescriptions })
            };
            saveData();

            // Update DOM element content directly
            const item = document.querySelector(`[data-id="${currentEditingId}"]`);
            if (item) {
                const stepTitle = item.querySelector('.step-title');
                const stepDesc = item.querySelector('.step-desc');
                if (stepTitle && newTitle) stepTitle.textContent = newTitle;
                if (stepDesc && newDesc) stepDesc.textContent = newDesc;

                const pipelineValue = item.querySelector('.pipeline-value');
                const pipelineLabel = item.querySelector('.pipeline-label');
                if (pipelineValue && newTitle) pipelineValue.textContent = newTitle;
                if (pipelineLabel && newDesc) pipelineLabel.textContent = newDesc;

                const featureTitle = item.querySelector('.feature-title');
                const featureDesc = item.querySelector('.feature-desc');
                if (featureTitle && newTitle) featureTitle.textContent = newTitle;
                if (featureDesc && newDesc) featureDesc.innerHTML = newDesc.replace(/\n/g, '<br>');

                const miniTitle = item.querySelector('.mini-title');
                const miniDesc = item.querySelector('.mini-desc');
                if (miniTitle && newTitle) miniTitle.textContent = newTitle;
                if (miniDesc && newDesc) miniDesc.textContent = newDesc;

                // Update card-items type
                if (currentCardType === 'card-items' && editedItems) {
                    const cardContent = item.querySelector('.card-content');
                    if (cardContent) {
                        cardContent.innerHTML = editedItems.map((i, idx) => `
                            <div class="problem-item" data-item-idx="${idx}" style="cursor: ${i.mediaUrl || i.beforeMedia || i.afterMedia ? 'pointer' : 'default'};" onclick="${i.mediaUrl || i.beforeMedia || i.afterMedia ? `showSingleItemMedia('${currentEditingId}', ${idx})` : ''}">
                                <span>${i.emoji}</span>
                                <div class="problem-text">
                                    <strong>${escapeHtml(i.title)}</strong>
                                    <span>${escapeHtml(i.desc)}</span>
                                </div>
                                ${i.mediaUrl || i.beforeMedia || i.afterMedia ? '<span style="margin-left: auto; opacity: 0.5;">üì∑</span>' : ''}
                            </div>
                        `).join('');
                    }
                }

                // Update list-item type
                if (currentCardType === 'list-item' && newTitle) {
                    const buttons = item.querySelector('.item-buttons');
                    const emoji = item.textContent.match(/^[^\w\s]/)?.[0] || '‚úì';
                    item.innerHTML = '';
                    if (buttons) item.appendChild(buttons);
                    item.appendChild(document.createTextNode(emoji + ' ' + newTitle));
                }
            }

            updateViewButtons();
            closeModal();
            showToast('Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!');
        }

        // Show single item media in viewer
        function showSingleItemMedia(cardId, itemIdx) {
            const data = itemData[cardId] || {};
            const items = data.items || [];
            const item = items[itemIdx];
            if (!item) return;

            const hasMedia = item.mediaUrl || item.beforeMedia || item.afterMedia;
            if (!hasMedia) return;

            currentViewingId = cardId;

            document.getElementById('itemViewerTitle').textContent = item.title || '';
            document.getElementById('itemViewerDesc').textContent = item.desc || '';

            const container = document.getElementById('itemViewerContent');
            const mode = item.mode || 'single';

            if (mode === 'compare') {
                container.innerHTML = `
                    <div style="display: flex; gap: 16px; align-items: center; justify-content: center;">
                        <div class="viewer-box before" onclick="openItemFullscreen('${cardId}', ${itemIdx}, 'before', event)">
                            <div class="viewer-box-label">BEFORE</div>
                            ${createMediaElement(item.beforeMedia)}
                            <div class="viewer-box-hint">üîç ÌÅ¥Î¶≠ÌïòÏó¨ ÌÅ¨Í≤å Î≥¥Í∏∞</div>
                        </div>
                        <div class="viewer-arrow">‚Üí</div>
                        <div class="viewer-box after" onclick="openItemFullscreen('${cardId}', ${itemIdx}, 'after', event)">
                            <div class="viewer-box-label">AFTER</div>
                            ${createMediaElement(item.afterMedia)}
                            <div class="viewer-box-hint">üîç ÌÅ¥Î¶≠ÌïòÏó¨ ÌÅ¨Í≤å Î≥¥Í∏∞</div>
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div style="text-align: center;" onclick="openItemFullscreen('${cardId}', ${itemIdx}, 'single', event)">
                        ${createMediaElement(item.mediaUrl)}
                        <p style="font-size: 10px; color: rgba(255,255,255,0.4); margin-top: 8px;">üîç ÌÅ¥Î¶≠ÌïòÏó¨ ÌÅ¨Í≤å Î≥¥Í∏∞</p>
                    </div>
                `;
            }

            document.getElementById('itemViewerOverlay').classList.add('active');

            setTimeout(() => {
                document.querySelectorAll('#itemViewerOverlay video').forEach(v => {
                    v.play().catch(() => {});
                });
            }, 100);
        }

        function updateViewButtons() {
            document.querySelectorAll('.clickable-item').forEach(item => {
                const id = item.dataset.id;
                const viewBtn = item.querySelector('.item-btn-view');
                if (viewBtn) {
                    const data = itemData[id];
                    const cardType = detectCardType(item);

                    // Check both card-level media and item-level media
                    let hasMedia = data && (data.mediaUrl || data.beforeMedia || data.afterMedia);
                    if (!hasMedia && data?.items) {
                        hasMedia = data.items.some(i => i.mediaUrl || i.beforeMedia || i.afterMedia);
                    }
                    // Check descriptions-level media for pipeline type
                    if (!hasMedia && data?.descriptions) {
                        hasMedia = data.descriptions.some(d => d.mediaUrl || d.beforeMedia || d.afterMedia);
                    }

                    viewBtn.classList.toggle('no-media', !hasMedia);
                }
            });
        }

        function scrollToSection(num) {
            const section = document.getElementById('section-' + num);
            if (section) section.scrollIntoView({ behavior: 'smooth' });
        }

        // Keyboard
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (document.getElementById('fullscreenOverlay').classList.contains('active')) {
                    closeFullscreen();
                } else if (document.getElementById('itemViewerOverlay').classList.contains('active')) {
                    closeItemViewer();
                } else if (document.getElementById('viewerOverlay').classList.contains('active')) {
                    closeViewer();
                } else if (document.getElementById('editModal').classList.contains('active')) {
                    closeModal();
                }
            }
        });

        // Click outside
        document.getElementById('viewerOverlay').addEventListener('click', (e) => {
            if (e.target.id === 'viewerOverlay') closeViewer();
        });
        document.getElementById('editModal').addEventListener('click', (e) => {
            if (e.target.id === 'editModal') closeModal();
        });
        document.getElementById('itemViewerOverlay').addEventListener('click', (e) => {
            if (e.target.id === 'itemViewerOverlay') closeItemViewer();
        });

        // Fade-in animation
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) entry.target.classList.add('visible');
            });
        }, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });
        document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

        // Restore saved content on page load
        function restoreSavedContent() {
            Object.keys(itemData).forEach(id => {
                const data = itemData[id];
                if (!data) return;

                const item = document.querySelector(`[data-id="${id}"]`);
                if (!item) return;

                const cardType = detectCardType(item);

                if (data.title) {
                    const stepTitle = item.querySelector('.step-title');
                    const pipelineValue = item.querySelector('.pipeline-value');
                    const featureTitle = item.querySelector('.feature-title');
                    const miniTitle = item.querySelector('.mini-title');

                    if (stepTitle) stepTitle.textContent = data.title;
                    if (pipelineValue) pipelineValue.textContent = data.title;
                    if (featureTitle) featureTitle.textContent = data.title;
                    if (miniTitle) miniTitle.textContent = data.title;

                    if (cardType === 'list-item') {
                        const buttons = item.querySelector('.item-buttons');
                        const emoji = item.textContent.match(/^[^\w\s]/)?.[0] || '‚úì';
                        item.innerHTML = '';
                        if (buttons) item.appendChild(buttons);
                        item.appendChild(document.createTextNode(emoji + ' ' + data.title));
                    }
                }

                if (data.description) {
                    const stepDesc = item.querySelector('.step-desc');
                    const pipelineLabel = item.querySelector('.pipeline-label');
                    const featureDesc = item.querySelector('.feature-desc');
                    const miniDesc = item.querySelector('.mini-desc');

                    if (stepDesc) stepDesc.textContent = data.description;
                    if (pipelineLabel) pipelineLabel.textContent = data.description;
                    if (featureDesc) featureDesc.innerHTML = data.description.replace(/\n/g, '<br>');
                    if (miniDesc) miniDesc.textContent = data.description;
                }

                // Restore items for card-items type with click handlers for items with media
                if (data.items && cardType === 'card-items') {
                    const cardContent = item.querySelector('.card-content');
                    if (cardContent) {
                        cardContent.innerHTML = data.items.map((i, idx) => `
                            <div class="problem-item" data-item-idx="${idx}" style="cursor: ${i.mediaUrl || i.beforeMedia || i.afterMedia ? 'pointer' : 'default'};" onclick="${i.mediaUrl || i.beforeMedia || i.afterMedia ? `showSingleItemMedia('${id}', ${idx})` : ''}">
                                <span>${i.emoji}</span>
                                <div class="problem-text">
                                    <strong>${escapeHtml(i.title)}</strong>
                                    <span>${escapeHtml(i.desc)}</span>
                                </div>
                                ${i.mediaUrl || i.beforeMedia || i.afterMedia ? '<span style="margin-left: auto; opacity: 0.5;">üì∑</span>' : ''}
                            </div>
                        `).join('');
                    }
                }
            });
        }

        // Init - FirestoreÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        loadDataFromFirestore().then(() => {
            // ÌîÑÎ†àÏ††ÌÖåÏù¥ÏÖò/Í≥µÏú† Î™®ÎìúÏóêÏÑúÎäî Ìé∏Ïßë Î≤ÑÌäº Ïà®Í∏∞Í∏∞
            if (isPresentationMode) {
                console.log('Presentation mode active - edit features disabled');
                document.getElementById('topActionBar').classList.add('hidden');

                // Ïπ¥Îìú ÌÅ¥Î¶≠ Ïãú ÏÉÅÏÑ∏Î≥¥Í∏∞ Ïó¥Í∏∞ (presentation mode)
                document.querySelectorAll('.clickable-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        const id = item.dataset.id;
                        console.log('Ïπ¥Îìú ÌÅ¥Î¶≠:', id);
                        if (id) {
                            openDetailModal(e, id);
                        }
                    });
                });

                // ÏÜåÎ∂ÑÎ•ò(2-1, 2-2 Îì±) ÌÅ¥Î¶≠ Ïãú Ï†ÑÏ≤¥ Ïπ¥Îìú ÌëúÏãú
                document.querySelectorAll('.sub-section-title').forEach(title => {
                    title.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const subSection = title.closest('.sub-section');
                        if (subSection) {
                            openSubSectionModal(subSection);
                        }
                    });
                });
                console.log('Ïπ¥Îìú/ÏÜåÎ∂ÑÎ•ò ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏ Îì±Î°ù ÏôÑÎ£å');
            }
        });

        // Toast ÏïåÎ¶º
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // Ìé∏Ïßë ÏôÑÎ£å
        async function completeEditing() {
            await saveDataToFirestore();
            showToast('Ìé∏Ïßë ÎÇ¥Ïö©Ïù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!');
        }

        // Í≥µÏú† ÎßÅÌÅ¨ Î™®Îã¨
        async function openShareModal() {
            await saveDataToFirestore(); // Î®ºÏ†Ä Ï†ÄÏû•

            const shareLinkInput = document.getElementById('shareLinkInput');
            const generateBtn = document.getElementById('generateShareBtn');
            const shareActions = document.getElementById('shareActions');

            // Í∏∞Ï°¥ Í≥µÏú† ÎßÅÌÅ¨ ÌôïÏù∏ (Ïù∏Îç±Ïä§ ÏóÜÏù¥ Îã®Ïàú ÏøºÎ¶¨)
            try {
                const existingLinks = await db.collection(SHARE_COLLECTION)
                    .where('docId', '==', GROWTHBOARD_DOC_ID)
                    .where('isActive', '==', true)
                    .get();

                if (!existingLinks.empty) {
                    // ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ÏóêÏÑú ÏµúÏã†Ïàú Ï†ïÎ†¨
                    const sortedDocs = existingLinks.docs.sort((a, b) =>
                        (b.data().createdAt || '').localeCompare(a.data().createdAt || '')
                    );
                    const linkData = sortedDocs[0].data();
                    const shareUrl = window.location.origin + '/growthboard/?token=' + linkData.token;
                    shareLinkInput.value = shareUrl;
                    generateBtn.style.display = 'none';
                    shareActions.style.display = 'flex';
                } else {
                    shareLinkInput.value = 'ÏÉà Í≥µÏú† ÎßÅÌÅ¨Î•º ÏÉùÏÑ±ÌïòÏÑ∏Ïöî';
                    generateBtn.style.display = 'block';
                    shareActions.style.display = 'none';
                }
            } catch (error) {
                console.error('Í∏∞Ï°¥ ÎßÅÌÅ¨ Ï°∞Ìöå Ïò§Î•ò:', error);
                shareLinkInput.value = 'ÏÉà Í≥µÏú† ÎßÅÌÅ¨Î•º ÏÉùÏÑ±ÌïòÏÑ∏Ïöî';
                generateBtn.style.display = 'block';
                shareActions.style.display = 'none';
            }

            document.getElementById('shareModalOverlay').classList.add('active');
        }

        // ÏÉà Í≥µÏú† ÎßÅÌÅ¨ ÏÉùÏÑ±
        async function generateNewShareLink() {
            try {
                const token = await createShareLink();
                const shareUrl = window.location.origin + '/growthboard/?token=' + token;

                document.getElementById('shareLinkInput').value = shareUrl;
                document.getElementById('generateShareBtn').style.display = 'none';
                document.getElementById('shareActions').style.display = 'flex';

                showToast('Í≥µÏú† ÎßÅÌÅ¨Í∞Ä ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§!');
            } catch (error) {
                console.error('ÎßÅÌÅ¨ ÏÉùÏÑ± Ïò§Î•ò:', error);
                showToast('ÎßÅÌÅ¨ ÏÉùÏÑ±Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§');
            }
        }

        function closeShareModal() {
            document.getElementById('shareModalOverlay').classList.remove('active');
        }

        function copyShareLink() {
            const input = document.getElementById('shareLinkInput');
            input.select();
            document.execCommand('copy');
            showToast('ÎßÅÌÅ¨Í∞Ä Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!');
        }

        // ÌÅ¥Î¶≠ Ïô∏Î∂Ä Îã´Í∏∞
        document.getElementById('shareModalOverlay').addEventListener('click', (e) => {
            if (e.target.id === 'shareModalOverlay') closeShareModal();
        });

        // ÏÉÅÏÑ∏ Î≥¥Í∏∞ Î™®Îã¨ (ÌÅ∞Îã®ÎùΩ + ÌïòÏúÑ Íµ¨Ï°∞)
        function openDetailModal(event, id) {
            event.stopPropagation();
            console.log('openDetailModal Ìò∏Ï∂ú, id:', id);
            console.log('itemData[id]:', itemData[id]);
            console.log('Ï†ÑÏ≤¥ itemData ÌÇ§:', Object.keys(itemData));

            const data = itemData[id] || {};
            const item = document.querySelector(`[data-id="${id}"]`);
            if (!item) {
                console.log('item ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏùå');
                return;
            }

            // Î∂ÄÎ™® ÏÑπÏÖò Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞
            const section = item.closest('.section');
            const sectionHeader = section ? section.querySelector('.section-header') : null;
            const sectionNumber = sectionHeader ? sectionHeader.querySelector('.section-number')?.textContent : '';
            const sectionTitle = sectionHeader ? sectionHeader.querySelector('.section-title')?.textContent : '';

            // ÏÑúÎ∏åÏÑπÏÖò Ï†ïÎ≥¥
            const subSection = item.closest('.sub-section');
            const subSectionTitle = subSection ? subSection.querySelector('.sub-section-title')?.textContent : '';

            // Ïπ¥Îìú Ï†ïÎ≥¥
            const cardTitle = item.querySelector('.card-title')?.textContent || data.title || '';
            const cardType = detectCardType(item);

            document.getElementById('detailModalTitle').textContent = cardTitle;
            document.getElementById('detailModalDesc').textContent = data.description || '';

            let content = '';

            // ÏÑπÏÖò Ï†ïÎ≥¥ ÌëúÏãú
            if (sectionTitle) {
                content += `
                    <div class="detail-section">
                        <div class="detail-section-header">
                            ${sectionNumber ? `<span class="detail-section-badge">${sectionNumber}</span>` : ''}
                            <span class="detail-section-title">${sectionTitle}</span>
                        </div>
                        ${subSectionTitle ? `<p style="color: rgba(255,255,255,0.6); font-size: 13px; margin-top: -8px;">${subSectionTitle}</p>` : ''}
                    </div>
                `;
            }

            // Îã§Ï§ë ÏÑ§Î™Ö ÌëúÏãú (ÌååÏù¥ÌîÑÎùºÏù∏ ÌÉÄÏûÖ)
            if (data.descriptions && data.descriptions.length > 0) {
                data.descriptions.forEach((desc, idx) => {
                    const hasMedia = desc.mediaUrl || desc.beforeMedia || desc.afterMedia;
                    const mode = desc.mode || 'single';

                    content += `
                        <div class="detail-section" style="margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                                <span style="font-size: 28px; background: rgba(255,255,255,0.1); padding: 8px; border-radius: 8px;">üìù</span>
                                <div>
                                    <div style="color: white; font-size: 17px; font-weight: 600;">${escapeHtml(desc.title || `ÏÑ§Î™Ö ${idx + 1}`)}</div>
                                    ${desc.text ? `<div style="color: rgba(255,255,255,0.6); font-size: 13px; margin-top: 2px; white-space: pre-wrap;">${escapeHtml(desc.text)}</div>` : ''}
                                </div>
                            </div>
                    `;

                    // ÎØ∏ÎîîÏñ¥ ÌëúÏãú (Before/After ÎòêÎäî Single)
                    if (hasMedia) {
                        if (mode === 'compare' && (desc.beforeMedia || desc.afterMedia)) {
                            content += `
                                <div style="display: flex; gap: 16px; align-items: center; justify-content: center; flex-wrap: wrap;">
                                    ${desc.beforeMedia ? `
                                        <div class="detail-media-box before" onclick="openDescFullscreen('${id}', ${idx}, 'before', event)" style="flex: 1; min-width: 200px; max-width: 350px;">
                                            <div class="detail-media-label">BEFORE</div>
                                            ${createMediaElement(desc.beforeMedia, 'detail-media-img', false)}
                                        </div>
                                    ` : ''}
                                    <div style="font-size: 28px; color: var(--color-accent);">‚Üí</div>
                                    ${desc.afterMedia ? `
                                        <div class="detail-media-box after" onclick="openDescFullscreen('${id}', ${idx}, 'after', event)" style="flex: 1; min-width: 200px; max-width: 350px;">
                                            <div class="detail-media-label">AFTER</div>
                                            ${createMediaElement(desc.afterMedia, 'detail-media-img', false)}
                                        </div>
                                    ` : ''}
                                </div>
                            `;
                        } else if (desc.mediaUrl) {
                            content += `
                                <div style="text-align: center;">
                                    <div class="detail-media-box" onclick="openDescFullscreen('${id}', ${idx}, 'single', event)" style="display: inline-block;">
                                        ${createMediaElement(desc.mediaUrl, 'detail-media-img', false)}
                                    </div>
                                </div>
                            `;
                        }
                    }

                    content += `</div>`;
                });
            }

            // ÏïÑÏù¥ÌÖú Î™©Î°ù ÌëúÏãú (Í∏∞Ï°¥ Ïä§ÌÉÄÏùº: Ïπ¥Îìú + Before/After Ïù¥ÎØ∏ÏßÄ)
            if (data.items && data.items.length > 0) {
                data.items.forEach((i, idx) => {
                    const hasMedia = i.mediaUrl || i.beforeMedia || i.afterMedia;
                    const mode = i.mode || 'single';

                    content += `
                        <div class="detail-section" style="margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                                <span style="font-size: 28px; background: rgba(255,255,255,0.1); padding: 8px; border-radius: 8px;">${i.emoji || 'üìå'}</span>
                                <div>
                                    <div style="color: white; font-size: 17px; font-weight: 600;">${escapeHtml(i.title || '')}</div>
                                    <div style="color: rgba(255,255,255,0.6); font-size: 13px; margin-top: 2px;">${escapeHtml(i.desc || '')}</div>
                                </div>
                            </div>
                    `;

                    // ÎØ∏ÎîîÏñ¥ ÌëúÏãú (Before/After ÎòêÎäî Single)
                    if (hasMedia) {
                        if (mode === 'compare' && (i.beforeMedia || i.afterMedia)) {
                            content += `
                                <div style="display: flex; gap: 16px; align-items: center; justify-content: center; flex-wrap: wrap;">
                                    ${i.beforeMedia ? `
                                        <div class="detail-media-box before" onclick="openItemFullscreen('${id}', ${idx}, 'before', event)" style="flex: 1; min-width: 200px; max-width: 350px;">
                                            <div class="detail-media-label">BEFORE</div>
                                            ${createMediaElement(i.beforeMedia, 'detail-media-img', false)}
                                        </div>
                                    ` : ''}
                                    <div style="font-size: 28px; color: var(--color-accent);">‚Üí</div>
                                    ${i.afterMedia ? `
                                        <div class="detail-media-box after" onclick="openItemFullscreen('${id}', ${idx}, 'after', event)" style="flex: 1; min-width: 200px; max-width: 350px;">
                                            <div class="detail-media-label">AFTER</div>
                                            ${createMediaElement(i.afterMedia, 'detail-media-img', false)}
                                        </div>
                                    ` : ''}
                                </div>
                            `;
                        } else if (i.mediaUrl) {
                            content += `
                                <div style="text-align: center;">
                                    <div class="detail-media-box" onclick="openItemFullscreen('${id}', ${idx}, 'single', event)" style="display: inline-block;">
                                        ${createMediaElement(i.mediaUrl, 'detail-media-img', false)}
                                    </div>
                                </div>
                            `;
                        }
                    }

                    content += `</div>`;
                });
            }

            // Ïπ¥Îìú Î†àÎ≤® ÎØ∏ÎîîÏñ¥ ÌëúÏãú (ÏïÑÏù¥ÌÖúÏù¥ ÏóÜÎäî Í≤ΩÏö∞)
            const hasCardMedia = data.mediaUrl || data.beforeMedia || data.afterMedia;
            if (hasCardMedia) {
                content += '<div class="detail-section" style="margin-bottom: 20px;">';

                // ÌÉÄÏù¥ÌãÄÍ≥º ÏÑ§Î™Ö ÌëúÏãú
                if (data.title || data.description) {
                    content += `
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                            <span style="font-size: 28px; background: rgba(255,255,255,0.1); padding: 8px; border-radius: 8px;">üì∏</span>
                            <div>
                                ${data.title ? `<div style="color: white; font-size: 17px; font-weight: 600;">${escapeHtml(data.title)}</div>` : ''}
                                ${data.description ? `<div style="color: rgba(255,255,255,0.6); font-size: 13px; margin-top: 2px;">${escapeHtml(data.description)}</div>` : ''}
                            </div>
                        </div>
                    `;
                }

                // ÎØ∏ÎîîÏñ¥ ÌëúÏãú
                content += '<div style="display: flex; gap: 16px; align-items: center; justify-content: center; flex-wrap: wrap;">';
                if (data.mode === 'compare') {
                    if (data.beforeMedia) {
                        content += `
                            <div class="detail-media-box before" onclick="openFullscreenFromDetail('${id}', 'before')" style="flex: 1; min-width: 200px; max-width: 400px;">
                                <div class="detail-media-label">BEFORE</div>
                                ${createMediaElement(data.beforeMedia, 'detail-media-img', false)}
                            </div>
                        `;
                    }
                    if (data.beforeMedia && data.afterMedia) {
                        content += '<div style="font-size: 28px; color: var(--color-accent);">‚Üí</div>';
                    }
                    if (data.afterMedia) {
                        content += `
                            <div class="detail-media-box after" onclick="openFullscreenFromDetail('${id}', 'after')" style="flex: 1; min-width: 200px; max-width: 400px;">
                                <div class="detail-media-label">AFTER</div>
                                ${createMediaElement(data.afterMedia, 'detail-media-img', false)}
                            </div>
                        `;
                    }
                } else if (data.mediaUrl) {
                    content += `
                        <div class="detail-media-box" onclick="openFullscreenFromDetail('${id}', 'single')" style="max-width: 600px;">
                            ${createMediaElement(data.mediaUrl, 'detail-media-img', false)}
                        </div>
                    `;
                }
                content += '</div></div>';
            }

            document.getElementById('detailModalContent').innerHTML = content;
            document.getElementById('detailModalOverlay').classList.add('active');

            setTimeout(() => {
                document.querySelectorAll('#detailModalOverlay video').forEach(v => v.play().catch(() => {}));
            }, 100);
        }

        function closeDetailModal() {
            document.getElementById('detailModalOverlay').classList.remove('active');
            document.querySelectorAll('#detailModalOverlay video').forEach(v => v.pause());
        }

        // ÏÜåÎ∂ÑÎ•ò Ï†ÑÏ≤¥ Ïπ¥Îìú ÌëúÏãú Î™®Îã¨
        function openSubSectionModal(subSection) {
            const titleEl = subSection.querySelector('.sub-section-title');
            const subTitle = titleEl ? titleEl.textContent.trim() : '';

            // Î∂ÄÎ™® ÏÑπÏÖò Ï†ïÎ≥¥
            const section = subSection.closest('.section');
            const sectionHeader = section ? section.querySelector('.section-header') : null;
            const sectionNumber = sectionHeader ? sectionHeader.querySelector('.section-number')?.textContent : '';
            const sectionTitle = sectionHeader ? sectionHeader.querySelector('.section-title')?.textContent : '';

            document.getElementById('detailModalTitle').textContent = subTitle;
            document.getElementById('detailModalDesc').textContent = sectionTitle || '';

            // Ìï¥Îãπ ÏÜåÎ∂ÑÎ•ò ÎÇ¥Ïùò Î™®Îì† Ïπ¥Îìú Ï∞æÍ∏∞
            const cards = subSection.querySelectorAll('.clickable-item');
            let content = '';

            // ÏÑπÏÖò Ìó§Îçî
            content += `
                <div class="detail-section" style="margin-bottom: 24px;">
                    <div class="detail-section-header">
                        ${sectionNumber ? `<span class="detail-section-badge">${sectionNumber}</span>` : ''}
                        <span class="detail-section-title">${sectionTitle}</span>
                    </div>
                    <p style="color: rgba(255,255,255,0.6); font-size: 14px;">${subTitle}</p>
                </div>
            `;

            // Í∞Å Ïπ¥Îìú ÌëúÏãú
            cards.forEach(card => {
                const cardId = card.dataset.id;
                const data = itemData[cardId] || {};
                const cardTitleEl = card.querySelector('.card-title');
                const cardTitle = cardTitleEl ? cardTitleEl.textContent.trim() : data.title || '';

                content += `<div style="margin-bottom: 32px; background: rgba(255,255,255,0.03); border-radius: 12px; padding: 20px;">`;
                content += `<div style="color: var(--color-accent); font-size: 16px; font-weight: 700; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                    <span style="width: 4px; height: 20px; background: var(--color-accent); border-radius: 2px;"></span>
                    ${cardTitle}
                </div>`;

                // ÏïÑÏù¥ÌÖú ÌëúÏãú
                if (data.items && data.items.length > 0) {
                    data.items.forEach((item, idx) => {
                        const hasMedia = item.mediaUrl || item.beforeMedia || item.afterMedia;
                        const mode = item.mode || 'single';

                        content += `<div style="margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1);">`;

                        // Ï†úÎ™© + ÏÑ§Î™Ö
                        content += `
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                                <span style="font-size: 24px;">${item.emoji || 'üìå'}</span>
                                <div>
                                    <div style="color: white; font-size: 15px; font-weight: 600;">${escapeHtml(item.title || '')}</div>
                                    <div style="color: rgba(255,255,255,0.5); font-size: 13px; margin-top: 2px;">${escapeHtml(item.desc || '')}</div>
                                </div>
                            </div>
                        `;

                        // ÎØ∏ÎîîÏñ¥ (Í∞ÄÎ°ú Î∞∞Ïπò - nowrap)
                        if (hasMedia) {
                            content += `<div class="detail-media-row">`;
                            if (mode === 'compare' && (item.beforeMedia || item.afterMedia)) {
                                if (item.beforeMedia) {
                                    content += `
                                        <div class="detail-media-box before" onclick="openItemFullscreen('${cardId}', ${idx}, 'before', event)">
                                            <div class="detail-media-label">BEFORE</div>
                                            ${createMediaElement(item.beforeMedia, 'detail-media-img', false)}
                                        </div>
                                    `;
                                }
                                content += `<span style="font-size: 32px; color: var(--color-accent); flex-shrink: 0;">‚Üí</span>`;
                                if (item.afterMedia) {
                                    content += `
                                        <div class="detail-media-box after" onclick="openItemFullscreen('${cardId}', ${idx}, 'after', event)">
                                            <div class="detail-media-label">AFTER</div>
                                            ${createMediaElement(item.afterMedia, 'detail-media-img', false)}
                                        </div>
                                    `;
                                }
                            } else if (item.mediaUrl) {
                                content += `
                                    <div class="detail-media-box" onclick="openItemFullscreen('${cardId}', ${idx}, 'single', event)">
                                        ${createMediaElement(item.mediaUrl, 'detail-media-img', false)}
                                    </div>
                                `;
                            }
                            content += `</div>`;
                        }

                        content += `</div>`;
                    });
                }

                // Ïπ¥Îìú Î†àÎ≤® ÎØ∏ÎîîÏñ¥
                const hasCardMedia = data.mediaUrl || data.beforeMedia || data.afterMedia;
                if (hasCardMedia) {
                    content += `<div class="detail-media-row" style="margin-top: 16px;">`;
                    if (data.mode === 'compare') {
                        if (data.beforeMedia) {
                            content += `
                                <div class="detail-media-box before" onclick="openFullscreenFromDetail('${cardId}', 'before')" style="text-align: center;">
                                    <div class="detail-media-label">BEFORE</div>
                                    ${createMediaElement(data.beforeMedia, 'detail-media-img', false)}
                                </div>
                            `;
                        }
                        if (data.beforeMedia && data.afterMedia) {
                            content += '<span style="font-size: 24px; color: var(--color-accent);">‚Üí</span>';
                        }
                        if (data.afterMedia) {
                            content += `
                                <div class="detail-media-box after" onclick="openFullscreenFromDetail('${cardId}', 'after')" style="text-align: center;">
                                    <div class="detail-media-label">AFTER</div>
                                    ${createMediaElement(data.afterMedia, 'detail-media-img', false)}
                                </div>
                            `;
                        }
                    } else if (data.mediaUrl) {
                        content += `
                            <div class="detail-media-box" onclick="openFullscreenFromDetail('${cardId}', 'single')" style="text-align: center;">
                                ${createMediaElement(data.mediaUrl, 'detail-media-img', false)}
                            </div>
                        `;
                    }
                    content += `</div>`;
                }

                content += `</div>`;
            });

            document.getElementById('detailModalContent').innerHTML = content;
            document.getElementById('detailModalOverlay').classList.add('active');

            setTimeout(() => {
                document.querySelectorAll('#detailModalOverlay video').forEach(v => v.play().catch(() => {}));
            }, 100);
        }

        function showItemMediaInDetail(cardId, itemIdx) {
            const data = itemData[cardId] || {};
            const items = data.items || [];
            const item = items[itemIdx];
            if (!item) return;

            const hasMedia = item.mediaUrl || item.beforeMedia || item.afterMedia;
            if (!hasMedia) return;

            let mediaUrl;
            if (item.mode === 'compare' && item.afterMedia) {
                mediaUrl = item.afterMedia;
            } else {
                mediaUrl = item.mediaUrl || item.beforeMedia || item.afterMedia;
            }

            if (!mediaUrl) return;

            const fullscreenEl = document.getElementById('fullscreenContent');
            if (isVideo(mediaUrl)) {
                fullscreenEl.innerHTML = `<video class="fullscreen-media" src="${mediaUrl}" autoplay loop muted playsinline controls></video>`;
            } else {
                fullscreenEl.innerHTML = `<img class="fullscreen-media" src="${mediaUrl}" alt="Full size">`;
            }
            document.getElementById('fullscreenOverlay').classList.add('active');
        }

        function openFullscreenFromDetail(id, type) {
            const data = itemData[id] || {};
            let mediaUrl;

            if (type === 'before') mediaUrl = data.beforeMedia;
            else if (type === 'after') mediaUrl = data.afterMedia;
            else mediaUrl = data.mediaUrl;

            if (!mediaUrl) return;

            const fullscreenEl = document.getElementById('fullscreenContent');
            if (isVideo(mediaUrl)) {
                fullscreenEl.innerHTML = `<video class="fullscreen-media" src="${mediaUrl}" autoplay loop muted playsinline controls></video>`;
            } else {
                fullscreenEl.innerHTML = `<img class="fullscreen-media" src="${mediaUrl}" alt="Full size">`;
            }
            document.getElementById('fullscreenOverlay').classList.add('active');
        }

        // ESC ÌÇ§Î°ú ÏÉÅÏÑ∏ Î™®Îã¨ Îã´Í∏∞
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (document.getElementById('detailModalOverlay').classList.contains('active')) {
                    closeDetailModal();
                }
                if (document.getElementById('shareModalOverlay').classList.contains('active')) {
                    closeShareModal();
                }
            }
        });

        document.getElementById('detailModalOverlay').addEventListener('click', (e) => {
            if (e.target.id === 'detailModalOverlay') closeDetailModal();
        });
    </script>
</body>
</html>