<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì „ëµì„¼í„° - ëª¨ì—¬ë¼ë”œ</title>
  <link rel="manifest" href="/admin/manifest.json">
  <meta name="theme-color" content="#3182f6">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="ì „ëµì„¼í„°">
  <link rel="apple-touch-icon" href="/admin/icon-192.png">
  <meta name="description" content="ëª¨ì—¬ë¼ë”œ ì „ëµì„¼í„° - ì˜ì—…í˜„í™©, OKR, ì „ëµê¸°íš">
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
  <style>
    :root {
      --primary: #3182f6;
      --primary-light: #eef4ff;
      --primary-dark: #1b64da;
      --white: #ffffff;
      --gray-900: #191f28;
      --gray-800: #333d4b;
      --gray-700: #4e5968;
      --gray-600: #6b7684;
      --gray-500: #8b95a1;
      --gray-400: #b0b8c1;
      --gray-300: #d1d6db;
      --gray-200: #e5e8eb;
      --gray-100: #f2f4f6;
      --gray-50: #f9fafb;
      --success: #00c073;
      --success-light: #e8f7f0;
      --warning: #fc9600;
      --warning-light: #fff8f0;
      --danger: #f04452;
      --danger-light: #fff0f1;
      --info: #3182f6;
      --info-light: #eef4ff;
      --card-radius: 16px;
      --card-shadow: 0 2px 8px rgba(0,0,0,0.06);
      --btn-radius: 8px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      min-height: 100vh;
      background: var(--gray-100);
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
      color: var(--gray-900);
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
    }

    /* ë¡œê·¸ì¸ í™”ë©´ */
    .login-screen {
      min-height: 100vh;
      background: var(--gray-100);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .login-container { width: 100%; max-width: 400px; }

    .login-logo {
      text-align: center;
      margin-bottom: 32px;
    }

    .login-logo img { height: 48px; }

    .login-logo-desc {
      font-size: 14px;
      color: var(--gray-500);
      margin-top: 8px;
    }

    .login-card {
      background: var(--white);
      border-radius: 16px;
      padding: 32px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.04);
    }

    .login-title {
      font-size: 18px;
      font-weight: 700;
      text-align: center;
      margin-bottom: 24px;
      color: var(--gray-900);
    }

    .login-error {
      background: var(--danger-light);
      border: 1px solid #fecaca;
      color: var(--danger);
      padding: 12px 16px;
      border-radius: 8px;
      font-size: 14px;
      margin-bottom: 20px;
      display: none;
    }

    .login-error.show { display: block; }

    .login-input {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid var(--gray-300);
      border-radius: 8px;
      font-size: 15px;
      font-family: inherit;
      transition: all 0.15s ease;
      background: var(--white);
      margin-bottom: 12px;
    }

    .login-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px var(--primary-light);
    }

    .login-btn {
      width: 100%;
      padding: 14px;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      background: var(--primary);
      color: var(--white);
      font-family: inherit;
      transition: all 0.15s ease;
    }

    .login-btn:hover { background: var(--primary-dark); }

    /* ë ˆì´ì•„ì›ƒ */
    .app-container {
      display: flex;
      min-height: 100vh;
    }

    /* ì‚¬ì´ë“œë°” */
    .sidebar {
      width: 260px;
      background: var(--white);
      border-right: 1px solid var(--gray-200);
      padding: 24px 0;
      position: fixed;
      height: 100vh;
      overflow-y: auto;
      z-index: 100;
      transition: transform 0.3s ease;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 8px 20px;
      margin-bottom: 32px;
    }

    .logo-icon {
      width: 36px;
      height: 36px;
      background: var(--primary);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }

    .logo-text {
      font-size: 18px;
      font-weight: 700;
      color: var(--gray-900);
    }

    .nav-section { margin-bottom: 32px; }

    .nav-label {
      font-size: 12px;
      font-weight: 700;
      color: var(--gray-500);
      letter-spacing: -0.2px;
      padding: 0 20px;
      margin-bottom: 12px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 20px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 15px;
      font-weight: 500;
      color: var(--gray-700);
      position: relative;
    }

    .nav-item:hover {
      background: var(--gray-50);
      color: var(--gray-900);
    }

    .nav-item.active {
      background: var(--primary-light);
      color: var(--primary);
      font-weight: 600;
    }

    .nav-item.active::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: var(--primary);
    }

    .nav-item .icon {
      width: 20px;
      text-align: center;
      font-size: 16px;
    }

    .center-links {
      padding: 16px 20px;
      border-top: 1px solid var(--gray-200);
      margin-top: auto;
    }

    .center-link {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 8px;
      font-size: 13px;
      color: var(--gray-600);
      text-decoration: none;
      transition: all 0.2s;
      margin-bottom: 4px;
    }

    .center-link:hover {
      background: var(--gray-100);
      color: var(--gray-900);
    }

    .center-link.active {
      background: var(--primary-light);
      color: var(--primary);
      font-weight: 600;
    }

    /* ë©”ì¸ ì»¨í…ì¸  */
    .main-content {
      flex: 1;
      margin-left: 260px;
      padding: 28px 32px;
      max-width: 1400px;
    }

    /* ëª¨ë°”ì¼ ë©”ë‰´ */
    .mobile-menu-btn {
      display: none;
      position: fixed;
      top: 16px;
      left: 16px;
      z-index: 150;
      background: var(--primary);
      color: var(--white);
      border: none;
      width: 44px;
      height: 44px;
      border-radius: 10px;
      cursor: pointer;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }

    .sidebar-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 90;
    }

    /* í—¤ë” */
    .page-header { margin-bottom: 24px; }

    .page-title {
      font-size: 22px;
      font-weight: 700;
      color: var(--gray-900);
      margin-bottom: 4px;
    }

    .page-desc {
      font-size: 14px;
      color: var(--gray-500);
    }

    /* ë²„íŠ¼ */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 10px 16px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: all 0.15s ease;
      font-family: inherit;
    }

    .btn-primary {
      background: var(--primary);
      color: var(--white);
    }

    .btn-primary:hover { background: var(--primary-dark); }

    .btn-secondary {
      background: var(--white);
      color: var(--gray-700);
      border: 1px solid var(--gray-300);
    }

    .btn-secondary:hover { background: var(--gray-50); }

    /* ì¹´ë“œ */
    .card {
      background: var(--white);
      border-radius: var(--card-radius);
      box-shadow: var(--card-shadow);
      padding: 24px;
      margin-bottom: 20px;
    }

    .card-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--gray-900);
      margin-bottom: 16px;
    }

    /* KPI ì¹´ë“œ */
    .kpi-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }

    .kpi-card {
      background: var(--white);
      border-radius: var(--card-radius);
      padding: 20px;
      box-shadow: var(--card-shadow);
    }

    .kpi-card.highlight {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
    }

    .kpi-label {
      font-size: 13px;
      color: var(--gray-500);
      margin-bottom: 8px;
    }

    .kpi-card.highlight .kpi-label {
      color: rgba(255,255,255,0.8);
    }

    .kpi-value {
      font-size: 28px;
      font-weight: 700;
      color: var(--gray-900);
    }

    .kpi-card.highlight .kpi-value {
      color: white;
    }

    .kpi-change {
      font-size: 12px;
      margin-top: 4px;
    }

    .kpi-change.positive { color: var(--success); }
    .kpi-change.negative { color: var(--danger); }

    /* í…Œì´ë¸” */
    .table-wrapper {
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid var(--gray-200);
    }

    th {
      font-size: 13px;
      font-weight: 600;
      color: var(--gray-500);
      background: var(--gray-50);
    }

    td {
      font-size: 14px;
      color: var(--gray-700);
    }

    /* ì°¨íŠ¸ í”Œë ˆì´ìŠ¤í™€ë” */
    .chart-placeholder {
      height: 300px;
      background: var(--gray-50);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--gray-500);
      font-size: 14px;
    }

    /* OKR ìŠ¤íƒ€ì¼ */
    .okr-section {
      margin-bottom: 24px;
    }

    .okr-objective {
      background: var(--white);
      border-radius: var(--card-radius);
      padding: 20px;
      margin-bottom: 16px;
      box-shadow: var(--card-shadow);
    }

    .okr-objective-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--gray-900);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .okr-key-result {
      background: var(--gray-50);
      border-radius: 8px;
      padding: 12px 16px;
      margin-bottom: 8px;
    }

    .okr-kr-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .okr-kr-title {
      font-size: 14px;
      color: var(--gray-700);
    }

    .okr-kr-progress {
      font-size: 14px;
      font-weight: 600;
      color: var(--primary);
    }

    .okr-progress-bar {
      height: 6px;
      background: var(--gray-200);
      border-radius: 3px;
      overflow: hidden;
    }

    .okr-progress-fill {
      height: 100%;
      background: var(--primary);
      border-radius: 3px;
      transition: width 0.3s ease;
    }

    /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
    .tab-nav {
      display: flex;
      gap: 4px;
      background: var(--gray-100);
      padding: 4px;
      border-radius: 10px;
      margin-bottom: 24px;
    }

    .tab-btn {
      flex: 1;
      padding: 10px 16px;
      border: none;
      background: transparent;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      color: var(--gray-600);
      cursor: pointer;
      transition: all 0.2s;
    }

    .tab-btn.active {
      background: var(--white);
      color: var(--gray-900);
      font-weight: 600;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* í† ìŠ¤íŠ¸ */
    #toast {
      position: fixed;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--gray-900);
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      display: none;
      z-index: 9999;
    }

    /* ëª¨ë‹¬ */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .modal.show {
      display: flex;
    }

    .modal-content {
      background: var(--white);
      border-radius: 16px;
      width: 100%;
      max-width: 500px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 24px;
      border-bottom: 1px solid var(--gray-200);
    }

    .modal-title {
      font-size: 18px;
      font-weight: 700;
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--gray-500);
      padding: 4px;
    }

    .modal-close:hover {
      color: var(--gray-900);
    }

    /* ë°˜ì‘í˜• */
    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .mobile-menu-btn {
        display: flex;
      }

      .sidebar-overlay.show {
        display: block;
      }

      .main-content {
        margin-left: 0;
        padding: 70px 16px 24px;
      }

      .kpi-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
</head>
<body>
  <!-- ë¡œê·¸ì¸ í™”ë©´ -->
  <div id="loginScreen" class="login-screen">
    <div class="login-container">
      <div class="login-logo">
        <img src="/admin/moyeora-logo.png" alt="ëª¨ì—¬ë¼ë”œ" onerror="this.style.display='none'">
        <div class="login-logo-desc">ì „ëµì„¼í„°</div>
      </div>
      <div class="login-card">
        <div class="login-title">ê´€ë¦¬ì ë¡œê·¸ì¸</div>
        <div id="loginError" class="login-error"></div>
        <input type="password" id="loginPassword" class="login-input" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" onkeypress="if(event.key==='Enter')handleLogin()">
        <button class="login-btn" onclick="handleLogin()">ë¡œê·¸ì¸</button>
      </div>
    </div>
  </div>

  <!-- ì•± í™”ë©´ -->
  <div id="appScreen" class="app-container" style="display:none;">
    <!-- ëª¨ë°”ì¼ ë©”ë‰´ ë²„íŠ¼ -->
    <button class="mobile-menu-btn" onclick="toggleSidebar()">â˜°</button>
    <div class="sidebar-overlay" onclick="toggleSidebar()"></div>

    <!-- ì‚¬ì´ë“œë°” -->
    <aside class="sidebar">
      <div class="logo">
        <div class="logo-icon">ğŸ“Š</div>
        <span class="logo-text">ì „ëµì„¼í„°</span>
      </div>

      <nav>
        <div class="nav-section">
          <div class="nav-label">ì „ëµ ê´€ë¦¬</div>
          <div class="nav-item active" onclick="switchTab('dashboard')">
            <span class="icon">ğŸ“ˆ</span>
            <span>ì˜ì—…í˜„í™©</span>
          </div>
          <div class="nav-item" onclick="switchTab('okr')">
            <span class="icon">ğŸ¯</span>
            <span>OKR</span>
          </div>
          <div class="nav-item" onclick="switchTab('planning')">
            <span class="icon">ğŸ“‹</span>
            <span>ì „ëµê¸°íš</span>
          </div>
          <div class="nav-item" onclick="switchTab('growth')">
            <span class="icon">ğŸš€</span>
            <span>ê·¸ë¡œìŠ¤ë³´ë“œ</span>
          </div>
          <div class="nav-item" onclick="switchTab('guide')">
            <span class="icon">ğŸ“š</span>
            <span>ì—…ë¬´ê°€ì´ë“œ</span>
          </div>
          <div class="nav-item" onclick="switchTab('reference')">
            <span class="icon">ğŸ“‚</span>
            <span>ë ˆí¼ëŸ°ìŠ¤</span>
          </div>
        </div>

        <!-- ì„¼í„° ì´ë™ -->
        <div class="center-links">
          <div class="nav-label">ì„¼í„° ì´ë™</div>
          <a href="/admin/" class="center-link">
            <span>âš™ï¸</span>
            <span>ìš´ì˜ì„¼í„°</span>
          </a>
          <a href="/admin/crm/" class="center-link">
            <span>ğŸ’¼</span>
            <span>CRMì„¼í„°</span>
          </a>
          <a href="/admin/strategy/" class="center-link active">
            <span>ğŸ“Š</span>
            <span>ì „ëµì„¼í„°</span>
          </a>
        </div>
      </nav>
    </aside>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <main class="main-content">
      <!-- ìƒë‹¨ ì„¼í„° ë°”ë¡œê°€ê¸° -->
      <div style="display: flex; gap: 8px; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid var(--gray-200);">
        <a href="/admin/" style="display: flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--gray-100); border-radius: 8px; text-decoration: none; color: var(--gray-700); font-size: 13px; font-weight: 500; transition: all 0.2s;">
          <span>âš™ï¸</span> ìš´ì˜ì„¼í„°
        </a>
        <a href="/admin/strategy/" style="display: flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--primary); border-radius: 8px; text-decoration: none; color: white; font-size: 13px; font-weight: 600;">
          <span>ğŸ“Š</span> ì „ëµì„¼í„°
        </a>
        <a href="/admin/crm/" style="display: flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--gray-100); border-radius: 8px; text-decoration: none; color: var(--gray-700); font-size: 13px; font-weight: 500; transition: all 0.2s;">
          <span>ğŸ’¼</span> CRMì„¼í„°
        </a>
      </div>

      <!-- ì˜ì—…í˜„í™© -->
      <div id="tab-dashboard" class="tab-content active">
        <div class="page-header">
          <h1 class="page-title">ì˜ì—…í˜„í™©</h1>
          <p class="page-desc">ì‹¤ì‹œê°„ ì˜ì—… ì„±ê³¼ ëª¨ë‹ˆí„°ë§</p>
        </div>

        <div class="kpi-grid">
          <div class="kpi-card highlight">
            <div class="kpi-label">ì´ë²ˆ ë‹¬ ë§¤ì¶œ</div>
            <div class="kpi-value" id="monthlyRevenue">-</div>
            <div class="kpi-change positive" id="revenueChange">ê³„ì‚° ì¤‘...</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">ì§„í–‰ì¤‘ ê³µêµ¬</div>
            <div class="kpi-value" id="activeDeals">-</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">í˜‘ì˜ì¤‘ ê³µêµ¬</div>
            <div class="kpi-value" id="negotiatingDeals">-</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">ë“±ë¡ ê³µê¸‰ì‚¬</div>
            <div class="kpi-value" id="totalSuppliers">-</div>
          </div>
        </div>

        <div class="card">
          <div class="card-title">ì›”ë³„ ë§¤ì¶œ ì¶”ì´</div>
          <div class="chart-placeholder" id="revenueChart">
            ì°¨íŠ¸ ë°ì´í„° ë¡œë”© ì¤‘...
          </div>
        </div>

        <div class="card">
          <div class="card-title">ìµœê·¼ ì™„ë£Œ ê³µêµ¬</div>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>ìƒí’ˆëª…</th>
                  <th>ê³µê¸‰ì‚¬</th>
                  <th>ë§¤ì¶œ</th>
                  <th>ê¸°ê°„</th>
                </tr>
              </thead>
              <tbody id="recentDealsTable">
                <tr><td colspan="4" style="text-align:center;color:var(--gray-500)">ë°ì´í„° ë¡œë”© ì¤‘...</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- OKR -->
      <div id="tab-okr" class="tab-content">
        <div class="page-header">
          <h1 class="page-title">OKR</h1>
          <p class="page-desc">ëª©í‘œ ë° í•µì‹¬ ê²°ê³¼ ê´€ë¦¬</p>
        </div>

        <div class="tab-nav">
          <button class="tab-btn active" onclick="switchOkrPeriod('quarterly')">ë¶„ê¸°ë³„</button>
          <button class="tab-btn" onclick="switchOkrPeriod('monthly')">ì›”ë³„</button>
          <button class="tab-btn" onclick="switchOkrPeriod('weekly')">ì£¼ê°„</button>
        </div>

        <div class="okr-section" id="okrContent">
          <div class="okr-objective">
            <div class="okr-objective-title">
              <span>ğŸ¯</span>
              <span>Q1 ë§¤ì¶œ ëª©í‘œ ë‹¬ì„±</span>
            </div>
            <div class="okr-key-result">
              <div class="okr-kr-header">
                <span class="okr-kr-title">ì›” ë§¤ì¶œ 1ì–µì› ë‹¬ì„±</span>
                <span class="okr-kr-progress">65%</span>
              </div>
              <div class="okr-progress-bar">
                <div class="okr-progress-fill" style="width: 65%"></div>
              </div>
            </div>
            <div class="okr-key-result">
              <div class="okr-kr-header">
                <span class="okr-kr-title">ì‹ ê·œ ê³µê¸‰ì‚¬ 20ê°œ í™•ë³´</span>
                <span class="okr-kr-progress">40%</span>
              </div>
              <div class="okr-progress-bar">
                <div class="okr-progress-fill" style="width: 40%"></div>
              </div>
            </div>
            <div class="okr-key-result">
              <div class="okr-kr-header">
                <span class="okr-kr-title">ê³µêµ¬ ì „í™˜ìœ¨ 15% ë‹¬ì„±</span>
                <span class="okr-kr-progress">80%</span>
              </div>
              <div class="okr-progress-bar">
                <div class="okr-progress-fill" style="width: 80%"></div>
              </div>
            </div>
          </div>

          <div class="okr-objective">
            <div class="okr-objective-title">
              <span>ğŸš€</span>
              <span>íŒŒíŠ¸ë„ˆ ìƒíƒœê³„ í™•ì¥</span>
            </div>
            <div class="okr-key-result">
              <div class="okr-kr-header">
                <span class="okr-kr-title">ì…€ëŸ¬ ë„¤íŠ¸ì›Œí¬ 50ê°œ í™•ë³´</span>
                <span class="okr-kr-progress">55%</span>
              </div>
              <div class="okr-progress-bar">
                <div class="okr-progress-fill" style="width: 55%"></div>
              </div>
            </div>
            <div class="okr-key-result">
              <div class="okr-kr-header">
                <span class="okr-kr-title">íŒŒíŠ¸ë„ˆ ë§Œì¡±ë„ 4.5ì  ì´ìƒ</span>
                <span class="okr-kr-progress">90%</span>
              </div>
              <div class="okr-progress-bar">
                <div class="okr-progress-fill" style="width: 90%"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ì „ëµê¸°íš (í”„ë¡œì íŠ¸ ê¸°ë°˜) -->
      <div id="tab-planning" class="tab-content">
        <div class="page-header" style="display: flex; justify-content: space-between; align-items: center;">
          <div>
            <h1 class="page-title">í”„ë¡œì íŠ¸ ì „ëµ</h1>
            <p class="page-desc">í”„ë¡œì íŠ¸ë³„ ëª©í‘œ ë° KPI ê´€ë¦¬</p>
          </div>
          <button class="btn btn-primary" onclick="openProjectModal()">+ í”„ë¡œì íŠ¸ ì¶”ê°€</button>
        </div>

        <!-- ì „ì²´ ëª©í‘œ ìš”ì•½ -->
        <div id="projectSummary" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px;">
          <div style="background: linear-gradient(135deg, var(--primary), var(--primary-dark)); border-radius: 16px; padding: 20px; color: white;">
            <div style="font-size: 13px; opacity: 0.9;">ì „ì²´ ë§¤ì¶œ ëª©í‘œ</div>
            <div id="totalRevenueGoal" style="font-size: 28px; font-weight: 800;">0ì›</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">ì§„í–‰ì¤‘ í”„ë¡œì íŠ¸</div>
            <div id="activeProjects" class="kpi-value">0</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">ì™„ë£Œëœ KPI</div>
            <div id="completedKPIs" class="kpi-value">0/0</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">ì´ë²ˆ ì£¼ ì—…ë¬´</div>
            <div id="weeklyTasks" class="kpi-value">0ê±´</div>
          </div>
        </div>

        <!-- í”„ë¡œì íŠ¸ ëª©ë¡ -->
        <div id="projectList" style="display: grid; gap: 20px;">
          <div style="text-align: center; padding: 60px; background: var(--gray-50); border-radius: 16px; border: 2px dashed var(--gray-300);">
            <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“‹</div>
            <div style="font-size: 16px; color: var(--gray-600); margin-bottom: 16px;">ì•„ì§ ë“±ë¡ëœ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤</div>
            <button class="btn btn-primary" onclick="openProjectModal()">+ ì²« í”„ë¡œì íŠ¸ ë§Œë“¤ê¸°</button>
          </div>
        </div>
      </div>

      <!-- í”„ë¡œì íŠ¸ ëª¨ë‹¬ -->
      <div id="projectModal" class="modal">
        <div class="modal-content" style="max-width: 700px; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column;">
          <div class="modal-header" style="background: var(--primary); color: white;">
            <h2 id="projectModalTitle" class="modal-title" style="color: white;">í”„ë¡œì íŠ¸ ì¶”ê°€</h2>
            <button class="modal-close" onclick="closeProjectModal()" style="color: white;">Ã—</button>
          </div>
          <div style="flex: 1; overflow-y: auto; padding: 24px;">
            <input type="hidden" id="projectId">

            <!-- ê¸°ë³¸ ì •ë³´ -->
            <div style="margin-bottom: 24px;">
              <div style="font-weight: 600; margin-bottom: 12px;">ğŸ“Œ ê¸°ë³¸ ì •ë³´</div>
              <div style="display: grid; gap: 12px;">
                <div>
                  <label style="font-size: 13px; color: var(--gray-600); display: block; margin-bottom: 4px;">í”„ë¡œì íŠ¸ëª… *</label>
                  <input type="text" id="projectName" placeholder="ì˜ˆ: ì¼ë³¸ ì§ìˆ˜ì… ëŸ°ì¹­" style="width: 100%; padding: 12px; border: 1px solid var(--gray-300); border-radius: 8px; font-size: 15px;">
                </div>
                <div>
                  <label style="font-size: 13px; color: var(--gray-600); display: block; margin-bottom: 4px;">ì„¤ëª…</label>
                  <textarea id="projectDesc" placeholder="í”„ë¡œì íŠ¸ ëª©í‘œ ë° ì„¤ëª…" rows="2" style="width: 100%; padding: 12px; border: 1px solid var(--gray-300); border-radius: 8px; font-size: 14px; resize: none;"></textarea>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                  <div>
                    <label style="font-size: 13px; color: var(--gray-600); display: block; margin-bottom: 4px;">ë§¤ì¶œ ëª©í‘œ (ì›)</label>
                    <input type="number" id="projectRevenueGoal" placeholder="100000000" style="width: 100%; padding: 12px; border: 1px solid var(--gray-300); border-radius: 8px;">
                  </div>
                  <div>
                    <label style="font-size: 13px; color: var(--gray-600); display: block; margin-bottom: 4px;">ì‹œì‘ì¼</label>
                    <input type="date" id="projectStartDate" style="width: 100%; padding: 12px; border: 1px solid var(--gray-300); border-radius: 8px;">
                  </div>
                  <div>
                    <label style="font-size: 13px; color: var(--gray-600); display: block; margin-bottom: 4px;">ì¢…ë£Œì¼</label>
                    <input type="date" id="projectEndDate" style="width: 100%; padding: 12px; border: 1px solid var(--gray-300); border-radius: 8px;">
                  </div>
                </div>
                <div>
                  <label style="font-size: 13px; color: var(--gray-600); display: block; margin-bottom: 4px;">ìƒíƒœ</label>
                  <select id="projectStatus" style="width: 100%; padding: 12px; border: 1px solid var(--gray-300); border-radius: 8px;">
                    <option value="active">ğŸŸ¢ ì§„í–‰ì¤‘</option>
                    <option value="paused">ğŸŸ¡ ì¼ì‹œì •ì§€</option>
                    <option value="completed">âœ… ì™„ë£Œ</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- íŒ€ KPI -->
            <div style="margin-bottom: 24px;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                <div style="font-weight: 600;">ğŸ¯ íŒ€ KPI</div>
                <button type="button" onclick="addTeamKPI()" style="background: var(--primary-light); color: var(--primary); border: none; padding: 6px 12px; border-radius: 6px; font-size: 13px; cursor: pointer;">+ ì¶”ê°€</button>
              </div>
              <div id="teamKPIList" style="display: grid; gap: 8px;">
                <!-- ë™ì ìœ¼ë¡œ ì¶”ê°€ -->
              </div>
            </div>

            <!-- ê°œë³„ KPI -->
            <div style="margin-bottom: 24px;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                <div style="font-weight: 600;">ğŸ‘¤ ê°œë³„ KPI (ë‹´ë‹¹ìë³„)</div>
                <button type="button" onclick="addMemberKPI()" style="background: var(--info-light); color: var(--info); border: none; padding: 6px 12px; border-radius: 6px; font-size: 13px; cursor: pointer;">+ ì¶”ê°€</button>
              </div>
              <div id="memberKPIList" style="display: grid; gap: 8px;">
                <!-- ë™ì ìœ¼ë¡œ ì¶”ê°€ -->
              </div>
            </div>
          </div>
          <div style="padding: 16px 24px; border-top: 1px solid var(--gray-200); display: flex; justify-content: space-between;">
            <button id="deleteProjectBtn" type="button" onclick="deleteProject()" style="background: var(--danger-light); color: var(--danger); border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; display: none;">ì‚­ì œ</button>
            <div style="display: flex; gap: 12px; margin-left: auto;">
              <button type="button" onclick="closeProjectModal()" class="btn btn-secondary">ì·¨ì†Œ</button>
              <button type="button" onclick="saveProject()" class="btn btn-primary">ì €ì¥</button>
            </div>
          </div>
        </div>
      </div>

      <!-- ê·¸ë¡œìŠ¤ë³´ë“œ -->
      <div id="tab-growth" class="tab-content">
        <div class="page-header">
          <h1 class="page-title">ê·¸ë¡œìŠ¤ë³´ë“œ</h1>
          <p class="page-desc">ì„±ì¥ ì§€í‘œ ë° ì‹¤í—˜ í˜„í™©</p>
        </div>

        <div class="kpi-grid">
          <div class="kpi-card">
            <div class="kpi-label">ê³µêµ¬ ì „í™˜ìœ¨</div>
            <div class="kpi-value" id="conversionRate">-</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">í‰ê·  ê³µêµ¬ ê¸°ê°„</div>
            <div class="kpi-value" id="avgDealDays">-</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">ì¬êµ¬ë§¤ìœ¨</div>
            <div class="kpi-value" id="repeatRate">-</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-label">NPS ì ìˆ˜</div>
            <div class="kpi-value" id="npsScore">-</div>
          </div>
        </div>

        <div class="card">
          <div class="card-title">ì§„í–‰ì¤‘ ì‹¤í—˜</div>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>ì‹¤í—˜ëª…</th>
                  <th>ìƒíƒœ</th>
                  <th>ê¸°ê°„</th>
                  <th>ê²°ê³¼</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>ì‹ ê·œ ìƒí’ˆ í˜ì´ì§€ A/B í…ŒìŠ¤íŠ¸</td>
                  <td><span style="color: var(--success);">ì§„í–‰ì¤‘</span></td>
                  <td>01.01 ~ 01.31</td>
                  <td>ì „í™˜ìœ¨ +12%</td>
                </tr>
                <tr>
                  <td>í‘¸ì‹œ ì•Œë¦¼ ìµœì í™”</td>
                  <td><span style="color: var(--info);">ë¶„ì„ì¤‘</span></td>
                  <td>12.15 ~ 12.31</td>
                  <td>í´ë¦­ë¥  +8%</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- ì—…ë¬´ê°€ì´ë“œ -->
      <div id="tab-guide" class="tab-content">
        <div class="page-header">
          <h1 class="page-title">ì—…ë¬´ê°€ì´ë“œ</h1>
          <p class="page-desc">í‘œì¤€ ì—…ë¬´ í”„ë¡œì„¸ìŠ¤ ë° ê°€ì´ë“œë¼ì¸</p>
        </div>

        <div class="card">
          <div class="card-title">ê³µêµ¬ ì§„í–‰ í”„ë¡œì„¸ìŠ¤</div>
          <div style="display: flex; gap: 16px; overflow-x: auto; padding: 8px 0;">
            <div style="flex: 0 0 150px; text-align: center; padding: 16px; background: var(--primary-light); border-radius: 12px;">
              <div style="font-size: 24px; margin-bottom: 8px;">1ï¸âƒ£</div>
              <div style="font-weight: 600; color: var(--primary);">ê³µê¸‰ì‚¬ í˜‘ì˜</div>
              <div style="font-size: 12px; color: var(--gray-600); margin-top: 4px;">ìƒí’ˆ/ê°€ê²© í˜‘ìƒ</div>
            </div>
            <div style="flex: 0 0 150px; text-align: center; padding: 16px; background: var(--gray-100); border-radius: 12px;">
              <div style="font-size: 24px; margin-bottom: 8px;">2ï¸âƒ£</div>
              <div style="font-weight: 600;">ì…€ëŸ¬ ë§¤ì¹­</div>
              <div style="font-size: 12px; color: var(--gray-600); margin-top: 4px;">íŒë§¤ì±„ë„ í™•ì •</div>
            </div>
            <div style="flex: 0 0 150px; text-align: center; padding: 16px; background: var(--gray-100); border-radius: 12px;">
              <div style="font-size: 24px; margin-bottom: 8px;">3ï¸âƒ£</div>
              <div style="font-weight: 600;">ê³µêµ¬ ì§„í–‰</div>
              <div style="font-size: 12px; color: var(--gray-600); margin-top: 4px;">íŒë§¤ ë° CS</div>
            </div>
            <div style="flex: 0 0 150px; text-align: center; padding: 16px; background: var(--success-light); border-radius: 12px;">
              <div style="font-size: 24px; margin-bottom: 8px;">4ï¸âƒ£</div>
              <div style="font-weight: 600; color: var(--success);">ì •ì‚° ì™„ë£Œ</div>
              <div style="font-size: 12px; color: var(--gray-600); margin-top: 4px;">ëŒ€ê¸ˆ ì§€ê¸‰</div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-title">ì£¼ìš” ì—…ë¬´ ê°€ì´ë“œ</div>
          <div style="display: grid; gap: 12px;">
            <a href="#" style="display: block; padding: 16px; background: var(--gray-50); border-radius: 8px; text-decoration: none; color: inherit;">
              <div style="font-weight: 600;">ğŸ“„ ê³µê¸‰ì‚¬ ê³„ì•½ ì²´í¬ë¦¬ìŠ¤íŠ¸</div>
              <div style="font-size: 13px; color: var(--gray-500); margin-top: 4px;">í•„ìˆ˜ í™•ì¸ ì‚¬í•­ ë° ê³„ì•½ì„œ ì–‘ì‹</div>
            </a>
            <a href="#" style="display: block; padding: 16px; background: var(--gray-50); border-radius: 8px; text-decoration: none; color: inherit;">
              <div style="font-weight: 600;">ğŸ’° ì •ì‚° í”„ë¡œì„¸ìŠ¤ ê°€ì´ë“œ</div>
              <div style="font-size: 13px; color: var(--gray-500); margin-top: 4px;">ì…€ëŸ¬/ê³µê¸‰ì‚¬ ì •ì‚° ì ˆì°¨</div>
            </a>
            <a href="#" style="display: block; padding: 16px; background: var(--gray-50); border-radius: 8px; text-decoration: none; color: inherit;">
              <div style="font-weight: 600;">ğŸ¯ ì˜ì—… ìŠ¤í¬ë¦½íŠ¸</div>
              <div style="font-size: 13px; color: var(--gray-500); margin-top: 4px;">ì‹ ê·œ íŒŒíŠ¸ë„ˆ ì»¨íƒ ì‹œ í™œìš©</div>
            </a>
          </div>
        </div>
      </div>

      <!-- ë ˆí¼ëŸ°ìŠ¤ -->
      <div id="tab-reference" class="tab-content">
        <div class="page-header" style="display: flex; justify-content: space-between; align-items: center;">
          <div>
            <h1 class="page-title">ë ˆí¼ëŸ°ìŠ¤</h1>
            <p class="page-desc">ì°¸ê³  ìë£Œ ë° ë¬¸ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬</p>
          </div>
          <button class="btn btn-primary" onclick="openReferenceModal()">+ ìë£Œ ì¶”ê°€</button>
        </div>

        <!-- ë ˆí¼ëŸ°ìŠ¤ ëª©ë¡ -->
        <div id="referenceList" class="card">
          <div style="text-align: center; padding: 40px; color: var(--gray-500);">
            ë ˆí¼ëŸ°ìŠ¤ ë°ì´í„° ë¡œë”©ì¤‘...
          </div>
        </div>
      </div>

      <!-- ë ˆí¼ëŸ°ìŠ¤ ëª¨ë‹¬ -->
      <div id="referenceModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
          <div class="modal-header">
            <h2 id="referenceModalTitle" class="modal-title">ìë£Œ ì¶”ê°€</h2>
            <button class="modal-close" onclick="closeReferenceModal()">Ã—</button>
          </div>
          <div style="padding: 24px;">
            <input type="hidden" id="referenceId">
            <div style="display: grid; gap: 16px;">
              <div>
                <label style="font-size: 13px; color: var(--gray-600); display: block; margin-bottom: 4px;">ì œëª© *</label>
                <input type="text" id="referenceTitle" placeholder="ìë£Œ ì œëª©" style="width: 100%; padding: 12px; border: 1px solid var(--gray-300); border-radius: 8px;">
              </div>
              <div>
                <label style="font-size: 13px; color: var(--gray-600); display: block; margin-bottom: 4px;">ì¹´í…Œê³ ë¦¬</label>
                <select id="referenceCategory" style="width: 100%; padding: 12px; border: 1px solid var(--gray-300); border-radius: 8px;">
                  <option value="document">ğŸ“„ ë¬¸ì„œ</option>
                  <option value="template">ğŸ“‹ í…œí”Œë¦¿</option>
                  <option value="guide">ğŸ“š ê°€ì´ë“œ</option>
                  <option value="link">ğŸ”— ì™¸ë¶€ ë§í¬</option>
                  <option value="other">ğŸ“ ê¸°íƒ€</option>
                </select>
              </div>
              <div>
                <label style="font-size: 13px; color: var(--gray-600); display: block; margin-bottom: 4px;">URL / ë§í¬</label>
                <input type="text" id="referenceUrl" placeholder="https://..." style="width: 100%; padding: 12px; border: 1px solid var(--gray-300); border-radius: 8px;">
              </div>
              <div>
                <label style="font-size: 13px; color: var(--gray-600); display: block; margin-bottom: 4px;">ì„¤ëª…</label>
                <textarea id="referenceDesc" placeholder="ìë£Œ ì„¤ëª…" rows="3" style="width: 100%; padding: 12px; border: 1px solid var(--gray-300); border-radius: 8px; resize: none;"></textarea>
              </div>
            </div>
          </div>
          <div style="padding: 16px 24px; border-top: 1px solid var(--gray-200); display: flex; justify-content: space-between;">
            <button id="deleteReferenceBtn" type="button" onclick="deleteReference()" style="background: var(--danger-light); color: var(--danger); border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; display: none;">ì‚­ì œ</button>
            <div style="display: flex; gap: 12px; margin-left: auto;">
              <button type="button" onclick="closeReferenceModal()" class="btn btn-secondary">ì·¨ì†Œ</button>
              <button type="button" onclick="saveReference()" class="btn btn-primary">ì €ì¥</button>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- í† ìŠ¤íŠ¸ -->
  <div id="toast"></div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <script>
    // Firebase ì„¤ì •
    const firebaseConfig = {
      apiKey: "AIzaSyAQf_Cu9wMji5QsMBQns5eg6nOD_vmrZMs",
      authDomain: "moyeora-deal-manager.firebaseapp.com",
      projectId: "moyeora-deal-manager",
      storageBucket: "moyeora-deal-manager.firebasestorage.app",
      messagingSenderId: "527148187832",
      appId: "1:527148187832:web:dc35b0413a7157db34744d"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ìƒíƒœ ê´€ë¦¬
    let state = {
      currentTab: 'dashboard',
      deals: [],
      suppliers: [],
      sellers: [],
      projects: [],
      references: [],
      isLoggedIn: false
    };

    let adminPassword = 'admin1234';

    // ë¹„ë°€ë²ˆí˜¸ ë¡œë“œ
    async function loadAdminPassword() {
      try {
        const doc = await db.collection('settings').doc('admin').get();
        if (doc.exists && doc.data().password) {
          adminPassword = doc.data().password;
        }
      } catch (e) {
        console.error('ë¹„ë°€ë²ˆí˜¸ ë¡œë“œ ì‹¤íŒ¨:', e);
      }
    }

    // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
    function checkLoginStatus() {
      const isLoggedIn = sessionStorage.getItem('moyeora_admin_logged_in') === 'true';
      if (isLoggedIn) {
        state.isLoggedIn = true;
        showApp();
      } else {
        showLogin();
      }
    }

    // ë¡œê·¸ì¸ ì²˜ë¦¬
    async function handleLogin() {
      const password = document.getElementById('loginPassword').value;
      const errorEl = document.getElementById('loginError');

      if (password === adminPassword) {
        state.isLoggedIn = true;
        sessionStorage.setItem('moyeora_admin_logged_in', 'true');
        showApp();
      } else {
        errorEl.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
        errorEl.classList.add('show');
      }
    }

    // ë¡œê·¸ì¸ í™”ë©´ í‘œì‹œ
    function showLogin() {
      document.getElementById('loginScreen').style.display = 'flex';
      document.getElementById('appScreen').style.display = 'none';
    }

    // ì•± í™”ë©´ í‘œì‹œ
    function showApp() {
      document.getElementById('loginScreen').style.display = 'none';
      document.getElementById('appScreen').style.display = 'flex';
      setupListeners();
    }

    // Firebase ë¦¬ìŠ¤ë„ˆ
    function setupListeners() {
      db.collection('deals').orderBy('startDate', 'desc').onSnapshot(snapshot => {
        state.deals = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
        render();
      });

      db.collection('suppliers').orderBy('name').onSnapshot(snapshot => {
        state.suppliers = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
        render();
      });

      db.collection('projects').orderBy('createdAt', 'desc').onSnapshot(snapshot => {
        state.projects = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
        render();
      });

      db.collection('references').orderBy('createdAt', 'desc').onSnapshot(snapshot => {
        state.references = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
        renderReferences();
      });

      db.collection('sellers').orderBy('name').onSnapshot(snapshot => {
        state.sellers = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
        render();
      });
    }

    // íƒ­ ì „í™˜
    function switchTab(tabId) {
      state.currentTab = tabId;

      // ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™”
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });
      event.currentTarget.classList.add('active');

      // íƒ­ ì»¨í…ì¸  í‘œì‹œ
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      document.getElementById(`tab-${tabId}`).classList.add('active');

      render();
    }

    // OKR ê¸°ê°„ ì „í™˜
    function switchOkrPeriod(period) {
      document.querySelectorAll('.tab-nav .tab-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.currentTarget.classList.add('active');
      // TODO: ê¸°ê°„ë³„ OKR ë°ì´í„° ë¡œë“œ
    }

    // ì‚¬ì´ë“œë°” í† ê¸€
    function toggleSidebar() {
      document.querySelector('.sidebar').classList.toggle('open');
      document.querySelector('.sidebar-overlay').classList.toggle('show');
    }

    // ë Œë”ë§
    function render() {
      const today = new Date();
      today.setHours(0, 0, 0, 0);

      // ì§„í–‰ì¤‘ ê³µêµ¬ ìˆ˜
      const activeDeals = state.deals.filter(deal => {
        const start = new Date(deal.startDate);
        const end = new Date(deal.endDate);
        return today >= start && today <= end;
      });
      document.getElementById('activeDeals').textContent = activeDeals.length;

      // í˜‘ì˜ì¤‘ ê³µêµ¬ ìˆ˜
      const negotiatingDeals = state.deals.filter(d => d.status === 'negotiating');
      document.getElementById('negotiatingDeals').textContent = negotiatingDeals.length;

      // ê³µê¸‰ì‚¬ ìˆ˜
      document.getElementById('totalSuppliers').textContent = state.suppliers.length;

      // ì´ë²ˆ ë‹¬ ë§¤ì¶œ ê³„ì‚°
      const thisMonth = today.getMonth();
      const thisYear = today.getFullYear();
      const monthlyDeals = state.deals.filter(deal => {
        const end = new Date(deal.endDate);
        return end.getMonth() === thisMonth && end.getFullYear() === thisYear;
      });

      const monthlyRevenue = monthlyDeals.reduce((sum, deal) => {
        return sum + (deal.totalRevenue || 0);
      }, 0);

      document.getElementById('monthlyRevenue').textContent =
        monthlyRevenue > 0 ? `${(monthlyRevenue / 10000).toFixed(0)}ë§Œì›` : '0ì›';
      document.getElementById('revenueChange').textContent =
        monthlyRevenue > 0 ? 'ì „ì›” ëŒ€ë¹„ ê³„ì‚° ì¤‘' : 'ë°ì´í„° ìˆ˜ì§‘ ì¤‘';

      // ìµœê·¼ ì™„ë£Œ ê³µêµ¬ í…Œì´ë¸”
      const completedDeals = state.deals.filter(deal => {
        const end = new Date(deal.endDate);
        return today > end;
      }).slice(0, 5);

      const tableBody = document.getElementById('recentDealsTable');
      if (completedDeals.length === 0) {
        tableBody.innerHTML = '<tr><td colspan="4" style="text-align:center;color:var(--gray-500)">ì™„ë£Œëœ ê³µêµ¬ê°€ ì—†ìŠµë‹ˆë‹¤</td></tr>';
      } else {
        tableBody.innerHTML = completedDeals.map(deal => `
          <tr>
            <td>${deal.product || '-'}</td>
            <td>${deal.supplier || '-'}</td>
            <td>${deal.totalRevenue ? (deal.totalRevenue / 10000).toFixed(0) + 'ë§Œì›' : '-'}</td>
            <td>${deal.startDate} ~ ${deal.endDate}</td>
          </tr>
        `).join('');
      }

      // ê·¸ë¡œìŠ¤ë³´ë“œ ì§€í‘œ
      document.getElementById('conversionRate').textContent =
        state.deals.length > 0 ? `${((activeDeals.length / state.deals.length) * 100).toFixed(1)}%` : '-';
      document.getElementById('avgDealDays').textContent = '7ì¼';
      document.getElementById('repeatRate').textContent = '-';
      document.getElementById('npsScore').textContent = '-';

      // í”„ë¡œì íŠ¸ ëª©ë¡ ë Œë”ë§
      renderProjects();
    }

    // ========================================
    // í”„ë¡œì íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œ
    // ========================================

    // í”„ë¡œì íŠ¸ ëª¨ë‹¬ ì—´ê¸°
    function openProjectModal(project = null) {
      const modal = document.getElementById('projectModal');
      const title = document.getElementById('projectModalTitle');
      const deleteBtn = document.getElementById('deleteProjectBtn');

      // í¼ ì´ˆê¸°í™”
      document.getElementById('projectId').value = project?.id || '';
      document.getElementById('projectName').value = project?.name || '';
      document.getElementById('projectDesc').value = project?.description || '';
      document.getElementById('projectRevenueGoal').value = project?.revenueGoal || '';
      document.getElementById('projectStartDate').value = project?.startDate || '';
      document.getElementById('projectEndDate').value = project?.endDate || '';
      document.getElementById('projectStatus').value = project?.status || 'active';

      // KPI ì´ˆê¸°í™”
      document.getElementById('teamKPIList').innerHTML = '';
      document.getElementById('memberKPIList').innerHTML = '';

      if (project) {
        title.textContent = 'í”„ë¡œì íŠ¸ ìˆ˜ì •';
        deleteBtn.style.display = 'block';
        // ê¸°ì¡´ íŒ€ KPI ë¡œë“œ
        (project.teamKPIs || []).forEach(kpi => addTeamKPI(kpi));
        // ê¸°ì¡´ ê°œë³„ KPI ë¡œë“œ
        (project.memberKPIs || []).forEach(kpi => addMemberKPI(kpi));
      } else {
        title.textContent = 'í”„ë¡œì íŠ¸ ì¶”ê°€';
        deleteBtn.style.display = 'none';
        // ê¸°ë³¸ KPI í•˜ë‚˜ì”© ì¶”ê°€
        addTeamKPI();
      }

      modal.classList.add('show');
    }

    function closeProjectModal() {
      document.getElementById('projectModal').classList.remove('show');
    }

    // íŒ€ KPI ì¶”ê°€
    function addTeamKPI(kpi = null) {
      const list = document.getElementById('teamKPIList');
      const idx = list.children.length;
      const div = document.createElement('div');
      div.style.cssText = 'display: grid; grid-template-columns: 1fr 80px 80px 40px; gap: 8px; align-items: center; background: var(--gray-50); padding: 12px; border-radius: 8px;';
      div.innerHTML = `
        <input type="text" class="team-kpi-name" placeholder="KPI í•­ëª© (ì˜ˆ: ê³µê¸‰ì‚¬ ê³„ì•½)" value="${kpi?.name || ''}" style="padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
        <input type="number" class="team-kpi-target" placeholder="ëª©í‘œ" value="${kpi?.target || ''}" style="padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
        <input type="number" class="team-kpi-current" placeholder="í˜„ì¬" value="${kpi?.current || 0}" style="padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
        <button type="button" onclick="this.parentElement.remove()" style="background: var(--danger-light); color: var(--danger); border: none; padding: 8px; border-radius: 6px; cursor: pointer;">âœ•</button>
      `;
      list.appendChild(div);
    }

    // ê°œë³„ KPI ì¶”ê°€
    function addMemberKPI(kpi = null) {
      const list = document.getElementById('memberKPIList');
      const div = document.createElement('div');
      div.style.cssText = 'display: grid; grid-template-columns: 100px 1fr 70px 70px 40px; gap: 8px; align-items: center; background: var(--info-light); padding: 12px; border-radius: 8px;';
      div.innerHTML = `
        <select class="member-kpi-member" style="padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
          <option value="songhee" ${kpi?.memberId === 'songhee' ? 'selected' : ''}>ê¹€ì†¡í¬</option>
          <option value="chaeeun" ${kpi?.memberId === 'chaeeun' ? 'selected' : ''}>ì´ì±„ì€</option>
        </select>
        <input type="text" class="member-kpi-name" placeholder="KPI í•­ëª©" value="${kpi?.name || ''}" style="padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
        <input type="number" class="member-kpi-target" placeholder="ëª©í‘œ" value="${kpi?.target || ''}" style="padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
        <input type="number" class="member-kpi-current" placeholder="í˜„ì¬" value="${kpi?.current || 0}" style="padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
        <button type="button" onclick="this.parentElement.remove()" style="background: var(--danger-light); color: var(--danger); border: none; padding: 8px; border-radius: 6px; cursor: pointer;">âœ•</button>
      `;
      list.appendChild(div);
    }

    // í”„ë¡œì íŠ¸ ì €ì¥
    async function saveProject() {
      const id = document.getElementById('projectId').value;
      const name = document.getElementById('projectName').value.trim();

      if (!name) {
        showToast('í”„ë¡œì íŠ¸ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
        return;
      }

      // íŒ€ KPI ìˆ˜ì§‘
      const teamKPIs = [];
      document.querySelectorAll('#teamKPIList > div').forEach(row => {
        const kpiName = row.querySelector('.team-kpi-name').value.trim();
        const target = parseInt(row.querySelector('.team-kpi-target').value) || 0;
        const current = parseInt(row.querySelector('.team-kpi-current').value) || 0;
        if (kpiName) {
          teamKPIs.push({ name: kpiName, target, current });
        }
      });

      // ê°œë³„ KPI ìˆ˜ì§‘
      const memberKPIs = [];
      document.querySelectorAll('#memberKPIList > div').forEach(row => {
        const memberId = row.querySelector('.member-kpi-member').value;
        const kpiName = row.querySelector('.member-kpi-name').value.trim();
        const target = parseInt(row.querySelector('.member-kpi-target').value) || 0;
        const current = parseInt(row.querySelector('.member-kpi-current').value) || 0;
        if (kpiName) {
          memberKPIs.push({ memberId, name: kpiName, target, current });
        }
      });

      const projectData = {
        name,
        description: document.getElementById('projectDesc').value.trim(),
        revenueGoal: parseInt(document.getElementById('projectRevenueGoal').value) || 0,
        startDate: document.getElementById('projectStartDate').value,
        endDate: document.getElementById('projectEndDate').value,
        status: document.getElementById('projectStatus').value,
        teamKPIs,
        memberKPIs,
        updatedAt: new Date().toISOString()
      };

      try {
        if (id) {
          await db.collection('projects').doc(id).update(projectData);
        } else {
          projectData.createdAt = new Date().toISOString();
          await db.collection('projects').add(projectData);
        }
        showToast('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤');
        closeProjectModal();
      } catch (e) {
        console.error(e);
        showToast('ì €ì¥ ì‹¤íŒ¨');
      }
    }

    // í”„ë¡œì íŠ¸ ì‚­ì œ
    async function deleteProject() {
      const id = document.getElementById('projectId').value;
      if (!id) return;

      if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

      try {
        await db.collection('projects').doc(id).delete();
        showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
        closeProjectModal();
      } catch (e) {
        showToast('ì‚­ì œ ì‹¤íŒ¨');
      }
    }

    // KPI ë¹ ë¥¸ ì—…ë°ì´íŠ¸
    async function quickUpdateKPI(projectId, kpiType, kpiIndex, newValue) {
      const project = state.projects.find(p => p.id === projectId);
      if (!project) return;

      const kpiList = kpiType === 'team' ? project.teamKPIs : project.memberKPIs;
      if (kpiList && kpiList[kpiIndex]) {
        kpiList[kpiIndex].current = parseInt(newValue) || 0;

        try {
          await db.collection('projects').doc(projectId).update({
            [kpiType === 'team' ? 'teamKPIs' : 'memberKPIs']: kpiList
          });
          showToast('ì—…ë°ì´íŠ¸ ì™„ë£Œ');
        } catch (e) {
          showToast('ì—…ë°ì´íŠ¸ ì‹¤íŒ¨');
        }
      }
    }

    // í”„ë¡œì íŠ¸ ëª©ë¡ ë Œë”ë§
    function renderProjects() {
      const list = document.getElementById('projectList');
      if (!list) return;

      const projects = state.projects || [];
      const activeProjects = projects.filter(p => p.status === 'active');

      // ìš”ì•½ ì—…ë°ì´íŠ¸
      const totalGoal = projects.reduce((sum, p) => sum + (p.revenueGoal || 0), 0);
      document.getElementById('totalRevenueGoal').textContent = totalGoal >= 100000000
        ? (totalGoal / 100000000).toFixed(1) + 'ì–µì›'
        : (totalGoal / 10000).toLocaleString() + 'ë§Œì›';
      document.getElementById('activeProjects').textContent = activeProjects.length;

      // KPI ì™„ë£Œ ê³„ì‚°
      let totalKPIs = 0, completedKPIs = 0;
      projects.forEach(p => {
        (p.teamKPIs || []).forEach(k => {
          totalKPIs++;
          if (k.current >= k.target) completedKPIs++;
        });
        (p.memberKPIs || []).forEach(k => {
          totalKPIs++;
          if (k.current >= k.target) completedKPIs++;
        });
      });
      document.getElementById('completedKPIs').textContent = `${completedKPIs}/${totalKPIs}`;

      if (projects.length === 0) {
        list.innerHTML = `
          <div style="text-align: center; padding: 60px; background: var(--gray-50); border-radius: 16px; border: 2px dashed var(--gray-300);">
            <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“‹</div>
            <div style="font-size: 16px; color: var(--gray-600); margin-bottom: 16px;">ì•„ì§ ë“±ë¡ëœ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤</div>
            <button class="btn btn-primary" onclick="openProjectModal()">+ ì²« í”„ë¡œì íŠ¸ ë§Œë“¤ê¸°</button>
          </div>
        `;
        return;
      }

      list.innerHTML = projects.map(project => {
        const statusColors = {
          active: { bg: '#dcfce7', text: '#16a34a', icon: 'ğŸŸ¢' },
          paused: { bg: '#fef3c7', text: '#d97706', icon: 'ğŸŸ¡' },
          completed: { bg: '#dbeafe', text: '#2563eb', icon: 'âœ…' }
        };
        const status = statusColors[project.status] || statusColors.active;

        // íŒ€ KPI ì§„í–‰ë¥ 
        const teamKPIs = project.teamKPIs || [];
        const memberKPIs = project.memberKPIs || [];
        const allKPIs = [...teamKPIs, ...memberKPIs];
        const kpiProgress = allKPIs.length > 0
          ? Math.round(allKPIs.reduce((sum, k) => sum + Math.min(100, (k.current / k.target) * 100), 0) / allKPIs.length)
          : 0;

        return `
          <div class="card" style="cursor: pointer;" onclick="openProjectModal(state.projects.find(p=>p.id==='${project.id}'))">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
              <div>
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                  <span style="font-size: 20px; font-weight: 700;">${project.name}</span>
                  <span style="background: ${status.bg}; color: ${status.text}; padding: 2px 8px; border-radius: 12px; font-size: 11px;">${status.icon} ${project.status === 'active' ? 'ì§„í–‰ì¤‘' : project.status === 'paused' ? 'ì¼ì‹œì •ì§€' : 'ì™„ë£Œ'}</span>
                </div>
                <div style="font-size: 13px; color: var(--gray-500);">${project.description || ''}</div>
              </div>
              <div style="text-align: right;">
                <div style="font-size: 24px; font-weight: 800; color: var(--primary);">${project.revenueGoal >= 100000000 ? (project.revenueGoal/100000000).toFixed(1) + 'ì–µ' : (project.revenueGoal/10000).toLocaleString() + 'ë§Œ'}</div>
                <div style="font-size: 11px; color: var(--gray-500);">ë§¤ì¶œ ëª©í‘œ</div>
              </div>
            </div>

            <!-- KPI ì§„í–‰ë¥  ë°” -->
            <div style="margin-bottom: 16px;">
              <div style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 4px;">
                <span style="color: var(--gray-600);">KPI ì§„í–‰ë¥ </span>
                <span style="font-weight: 600; color: ${kpiProgress >= 70 ? 'var(--success)' : kpiProgress >= 40 ? 'var(--warning)' : 'var(--gray-600)'};">${kpiProgress}%</span>
              </div>
              <div style="background: var(--gray-200); height: 8px; border-radius: 4px;">
                <div style="background: ${kpiProgress >= 70 ? 'var(--success)' : kpiProgress >= 40 ? 'var(--warning)' : 'var(--primary)'}; height: 100%; width: ${kpiProgress}%; border-radius: 4px; transition: width 0.3s;"></div>
              </div>
            </div>

            <!-- íŒ€ KPI -->
            ${teamKPIs.length > 0 ? `
            <div style="margin-bottom: 12px;">
              <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 8px;">ğŸ¯ íŒ€ KPI</div>
              <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                ${teamKPIs.map((kpi, idx) => {
                  const progress = Math.min(100, Math.round((kpi.current / kpi.target) * 100));
                  return `
                    <div style="background: var(--gray-50); padding: 8px 12px; border-radius: 8px; display: flex; align-items: center; gap: 8px;" onclick="event.stopPropagation()">
                      <span style="font-size: 13px;">${kpi.name}</span>
                      <span style="font-weight: 700; color: ${progress >= 100 ? 'var(--success)' : 'var(--gray-900)'};">${kpi.current}/${kpi.target}</span>
                      <button onclick="event.stopPropagation(); quickUpdateKPI('${project.id}', 'team', ${idx}, ${kpi.current + 1})" style="background: var(--primary); color: white; border: none; width: 24px; height: 24px; border-radius: 4px; cursor: pointer; font-size: 14px;">+</button>
                    </div>
                  `;
                }).join('')}
              </div>
            </div>
            ` : ''}

            <!-- ê°œë³„ KPI -->
            ${memberKPIs.length > 0 ? `
            <div>
              <div style="font-size: 12px; font-weight: 600; color: var(--gray-600); margin-bottom: 8px;">ğŸ‘¤ ê°œë³„ KPI</div>
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                ${memberKPIs.map((kpi, idx) => {
                  const progress = Math.min(100, Math.round((kpi.current / kpi.target) * 100));
                  const memberName = kpi.memberId === 'songhee' ? 'ê¹€ì†¡í¬' : 'ì´ì±„ì€';
                  return `
                    <div style="background: var(--info-light); padding: 8px 12px; border-radius: 8px; display: flex; align-items: center; justify-content: space-between;" onclick="event.stopPropagation()">
                      <div>
                        <span style="font-size: 11px; color: var(--info);">${memberName}</span>
                        <div style="font-size: 13px;">${kpi.name}</div>
                      </div>
                      <div style="display: flex; align-items: center; gap: 6px;">
                        <span style="font-weight: 700; color: ${progress >= 100 ? 'var(--success)' : 'var(--gray-900)'};">${kpi.current}/${kpi.target}</span>
                        <button onclick="event.stopPropagation(); quickUpdateKPI('${project.id}', 'member', ${idx}, ${kpi.current + 1})" style="background: var(--info); color: white; border: none; width: 22px; height: 22px; border-radius: 4px; cursor: pointer; font-size: 12px;">+</button>
                      </div>
                    </div>
                  `;
                }).join('')}
              </div>
            </div>
            ` : ''}

            <!-- ê¸°ê°„ -->
            ${project.startDate || project.endDate ? `
            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--gray-200); font-size: 12px; color: var(--gray-500);">
              ğŸ“… ${project.startDate || '?'} ~ ${project.endDate || '?'}
            </div>
            ` : ''}
          </div>
        `;
      }).join('');
    }

    // ========================================
    // ë ˆí¼ëŸ°ìŠ¤ ê´€ë¦¬ ì‹œìŠ¤í…œ
    // ========================================

    // ë ˆí¼ëŸ°ìŠ¤ ëª©ë¡ ë Œë”ë§
    function renderReferences() {
      const list = document.getElementById('referenceList');
      if (!list) return;

      const references = state.references || [];

      if (references.length === 0) {
        list.innerHTML = `
          <div style="text-align: center; padding: 60px; color: var(--gray-500);">
            <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“‚</div>
            <div style="font-size: 16px; margin-bottom: 16px;">ë“±ë¡ëœ ë ˆí¼ëŸ°ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤</div>
            <button class="btn btn-primary" onclick="openReferenceModal()">+ ì²« ìë£Œ ë“±ë¡í•˜ê¸°</button>
          </div>
        `;
        return;
      }

      // ì¹´í…Œê³ ë¦¬ë³„ ì•„ì´ì½˜
      const categoryIcons = {
        document: 'ğŸ“„',
        template: 'ğŸ“‹',
        guide: 'ğŸ“š',
        link: 'ğŸ”—',
        other: 'ğŸ“'
      };

      const categoryNames = {
        document: 'ë¬¸ì„œ',
        template: 'í…œí”Œë¦¿',
        guide: 'ê°€ì´ë“œ',
        link: 'ì™¸ë¶€ ë§í¬',
        other: 'ê¸°íƒ€'
      };

      list.innerHTML = `
        <div style="display: grid; gap: 12px;">
          ${references.map(ref => `
            <div style="display: flex; align-items: center; gap: 16px; padding: 16px; background: var(--gray-50); border-radius: 12px; cursor: pointer; transition: all 0.2s;"
                 onclick="openReferenceModal(state.references.find(r=>r.id==='${ref.id}'))"
                 onmouseover="this.style.background='var(--gray-100)'"
                 onmouseout="this.style.background='var(--gray-50)'">
              <div style="width: 48px; height: 48px; background: var(--primary-light); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px;">
                ${categoryIcons[ref.category] || 'ğŸ“'}
              </div>
              <div style="flex: 1; min-width: 0;">
                <div style="font-weight: 600; color: var(--gray-900); margin-bottom: 2px;">${ref.title}</div>
                <div style="font-size: 13px; color: var(--gray-500); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                  ${ref.description || 'ì„¤ëª… ì—†ìŒ'}
                </div>
              </div>
              <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 4px;">
                <span style="background: var(--gray-200); padding: 2px 8px; border-radius: 10px; font-size: 11px; color: var(--gray-600);">
                  ${categoryNames[ref.category] || 'ê¸°íƒ€'}
                </span>
                ${ref.url ? `
                  <a href="${ref.url}" target="_blank" onclick="event.stopPropagation()" style="font-size: 12px; color: var(--primary); text-decoration: none;">
                    ë§í¬ ì—´ê¸° â†’
                  </a>
                ` : ''}
              </div>
            </div>
          `).join('')}
        </div>
      `;
    }

    // ë ˆí¼ëŸ°ìŠ¤ ëª¨ë‹¬ ì—´ê¸°
    function openReferenceModal(ref = null) {
      const modal = document.getElementById('referenceModal');
      const title = document.getElementById('referenceModalTitle');
      const deleteBtn = document.getElementById('deleteReferenceBtn');

      // í¼ ì´ˆê¸°í™”
      document.getElementById('referenceId').value = ref?.id || '';
      document.getElementById('referenceTitle').value = ref?.title || '';
      document.getElementById('referenceCategory').value = ref?.category || 'document';
      document.getElementById('referenceUrl').value = ref?.url || '';
      document.getElementById('referenceDesc').value = ref?.description || '';

      if (ref) {
        title.textContent = 'ìë£Œ ìˆ˜ì •';
        deleteBtn.style.display = 'block';
      } else {
        title.textContent = 'ìë£Œ ì¶”ê°€';
        deleteBtn.style.display = 'none';
      }

      modal.classList.add('show');
    }

    // ë ˆí¼ëŸ°ìŠ¤ ëª¨ë‹¬ ë‹«ê¸°
    function closeReferenceModal() {
      document.getElementById('referenceModal').classList.remove('show');
    }

    // ë ˆí¼ëŸ°ìŠ¤ ì €ì¥
    async function saveReference() {
      const id = document.getElementById('referenceId').value;
      const title = document.getElementById('referenceTitle').value.trim();

      if (!title) {
        showToast('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
        return;
      }

      const refData = {
        title,
        category: document.getElementById('referenceCategory').value,
        url: document.getElementById('referenceUrl').value.trim(),
        description: document.getElementById('referenceDesc').value.trim(),
        updatedAt: new Date().toISOString()
      };

      try {
        if (id) {
          await db.collection('references').doc(id).update(refData);
        } else {
          refData.createdAt = new Date().toISOString();
          await db.collection('references').add(refData);
        }
        showToast('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤');
        closeReferenceModal();
      } catch (e) {
        console.error(e);
        showToast('ì €ì¥ ì‹¤íŒ¨');
      }
    }

    // ë ˆí¼ëŸ°ìŠ¤ ì‚­ì œ
    async function deleteReference() {
      const id = document.getElementById('referenceId').value;
      if (!id) return;

      if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

      try {
        await db.collection('references').doc(id).delete();
        showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
        closeReferenceModal();
      } catch (e) {
        showToast('ì‚­ì œ ì‹¤íŒ¨');
      }
    }

    // í† ìŠ¤íŠ¸ ë©”ì‹œì§€
    function showToast(msg) {
      const toast = document.getElementById('toast');
      toast.textContent = msg;
      toast.style.display = 'block';
      setTimeout(() => toast.style.display = 'none', 2500);
    }

    // ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', () => {
      loadAdminPassword();
      checkLoginStatus();
    });
  </script>
</body>
</html>
