<!DOCTYPE html>
<html lang="ko">
<head>
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì…€ëŸ¬ ì œì•ˆ ê´€ë¦¬ - ëª¨ì—¬ë¼ë”œ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #f5f5f5; font-family: 'Noto Sans KR', sans-serif; min-height: 100vh; }

        .header { background: linear-gradient(135deg, #ff6b35 0%, #ff9500 100%); padding: 16px 24px; color: #fff; }
        .header-inner { max-width: 1400px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; }
        .logo { font-size: 18px; font-weight: 700; text-decoration: none; color: #fff; display: flex; align-items: center; gap: 8px; }
        .nav-menu { display: flex; gap: 4px; }
        .nav-item { padding: 8px 16px; border-radius: 8px; text-decoration: none; color: rgba(255,255,255,0.9); font-size: 14px; font-weight: 500; transition: all 0.2s; }
        .nav-item:hover { background: rgba(255,255,255,0.15); }
        .nav-item.active { background: rgba(255,255,255,0.25); color: #fff; font-weight: 600; }

        .container { max-width: 1400px; margin: 0 auto; padding: 40px 24px; }

        .page-header { margin-bottom: 40px; }
        .page-title { font-size: 32px; font-weight: 700; color: #374151; margin-bottom: 12px; }
        .page-desc { font-size: 16px; color: #6b7280; line-height: 1.6; }

        /* í†µê³„ ì¹´ë“œ */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .stat-card { background: #fff; border-radius: 16px; padding: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); }
        .stat-label { font-size: 13px; color: #6b7280; margin-bottom: 8px; }
        .stat-value { font-size: 28px; font-weight: 700; color: #111; }
        .stat-change { font-size: 12px; margin-top: 4px; }
        .stat-change.up { color: #22c55e; }
        .stat-change.down { color: #ef4444; }

        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; padding-bottom: 16px; border-bottom: 3px solid #ff6b35; }
        .section-title { font-size: 24px; font-weight: 700; color: #111; }
        .section-badge { background: #fff1eb; color: #ff6b35; padding: 6px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; }

        /* ì…€ëŸ¬ íƒ€ì… ì¹´ë“œ */
        .type-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 24px; margin-bottom: 48px; }

        .type-card { background: #fff; border-radius: 16px; padding: 32px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); border: 2px solid transparent; transition: all 0.3s; }
        .type-card:hover { border-color: #ff6b35; box-shadow: 0 8px 24px rgba(255,107,53,0.15); }

        .type-icon { font-size: 48px; margin-bottom: 16px; }
        .type-name { font-size: 20px; font-weight: 700; color: #111; margin-bottom: 8px; }
        .type-desc { font-size: 14px; color: #6b7280; line-height: 1.6; margin-bottom: 16px; min-height: 48px; }
        .type-tags { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 20px; }
        .type-tag { display: inline-block; padding: 4px 12px; background: #fff1eb; color: #ff6b35; font-size: 12px; font-weight: 600; border-radius: 12px; }

        .btn-group { display: flex; gap: 8px; margin-bottom: 12px; }
        .btn-primary { flex: 1; padding: 12px; background: linear-gradient(135deg, #ff6b35 0%, #ff9500 100%); color: #fff; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-primary:hover { background: linear-gradient(135deg, #e55a2b 0%, #e08600 100%); }
        .btn-secondary { flex: 1; padding: 12px; background: #fff; color: #ff6b35; border: 2px solid #ff6b35; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-secondary:hover { background: #fff8f5; }

        /* ì œì•ˆ ëª©ë¡ */
        .proposals-section { margin-top: 16px; padding-top: 16px; border-top: 1px solid #e5e7eb; }
        .proposals-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .proposals-title { font-size: 14px; font-weight: 600; color: #374151; }
        .proposals-count { font-size: 12px; color: #6b7280; }
        .proposal-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 12px; background: #f9fafb; border-radius: 8px; margin-bottom: 8px; border: 1px solid #e5e7eb; }
        .proposal-info { flex: 1; min-width: 0; }
        .proposal-name { font-size: 13px; font-weight: 600; color: #111; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .proposal-details { font-size: 11px; color: #6b7280; margin-top: 2px; display: flex; gap: 8px; flex-wrap: wrap; }
        .proposal-actions { display: flex; gap: 6px; margin-left: 12px; }
        .btn-icon { padding: 6px 10px; background: #fff; border: 1px solid #d1d5db; border-radius: 6px; font-size: 11px; cursor: pointer; transition: all 0.2s; white-space: nowrap; }
        .btn-icon:hover { background: #f9fafb; border-color: #ff6b35; color: #ff6b35; }
        .btn-icon.danger:hover { border-color: #dc2626; color: #dc2626; }
        .btn-icon.success { background: #22c55e; color: #fff; border-color: #22c55e; }
        .btn-icon.success:hover { background: #16a34a; }

        /* ì—°ë½ ë°©ë²• ë“œë¡­ë‹¤ìš´ */
        .contact-dropdown { position: relative; display: inline-block; }
        .contact-btn { padding: 6px 12px; background: linear-gradient(135deg, #ff6b35 0%, #ff9500 100%); color: #fff; border: none; border-radius: 6px; font-size: 11px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 4px; }
        .contact-btn:hover { background: linear-gradient(135deg, #e55a2b 0%, #e08600 100%); }
        .contact-menu { display: none; position: absolute; top: 100%; right: 0; margin-top: 4px; background: #fff; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.15); min-width: 160px; z-index: 100; overflow: hidden; }
        .contact-menu.show { display: block; }
        .contact-menu-item { display: flex; align-items: center; gap: 8px; padding: 10px 14px; font-size: 13px; color: #374151; cursor: pointer; transition: all 0.15s; border: none; background: none; width: 100%; text-align: left; }
        .contact-menu-item:hover { background: #f3f4f6; color: #ff6b35; }
        .contact-menu-item .icon { font-size: 16px; }

        /* ì „í™” ëŒ€ë³¸ ì¹´ë“œ */
        .call-script-card { background: linear-gradient(135deg, #fff8f5 0%, #fff1eb 100%); border: 2px solid #ff6b35; border-radius: 16px; padding: 24px; margin-bottom: 32px; }
        .call-script-header { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
        .call-script-icon { width: 48px; height: 48px; background: linear-gradient(135deg, #ff6b35 0%, #ff9500 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .call-script-title { font-size: 18px; font-weight: 700; color: #111; }
        .call-script-desc { font-size: 14px; color: #6b7280; margin-bottom: 16px; line-height: 1.6; }
        .call-script-btn { display: inline-flex; align-items: center; gap: 8px; padding: 12px 20px; background: linear-gradient(135deg, #ff6b35 0%, #ff9500 100%); color: #fff; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; text-decoration: none; transition: all 0.2s; }
        .call-script-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(255,107,53,0.3); }

        /* ìƒíƒœ ë°°ì§€ */
        .status-badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: 600; }
        .status-badge.proposal { background: #fef3c7; color: #92400e; }
        .status-badge.onboarding { background: #dbeafe; color: #1e40af; }
        .status-badge.listed { background: #dcfce7; color: #166534; }

        /* ëª¨ë‹¬ */
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center; }
        .modal.active { display: flex; }
        .modal-content { background: #fff; border-radius: 16px; padding: 32px; max-width: 500px; width: 90%; box-shadow: 0 20px 60px rgba(0,0,0,0.3); max-height: 90vh; overflow-y: auto; }
        .modal-header { font-size: 20px; font-weight: 700; color: #111; margin-bottom: 20px; }
        .modal-body { margin-bottom: 24px; }
        .modal-label { display: block; font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 8px; }
        .modal-input { width: 100%; padding: 12px 16px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 15px; font-family: 'Noto Sans KR', sans-serif; }
        .modal-input:focus { outline: none; border-color: #ff6b35; }
        .modal-hint { font-size: 12px; color: #6b7280; margin-top: 8px; line-height: 1.6; }
        .modal-hint strong { color: #ff6b35; }
        .modal-footer { display: flex; gap: 12px; justify-content: flex-end; }
        .btn-modal { padding: 12px 24px; border: none; border-radius: 8px; font-size: 15px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-modal-cancel { background: #e5e7eb; color: #374151; }
        .btn-modal-cancel:hover { background: #d1d5db; }
        .btn-modal-confirm { background: linear-gradient(135deg, #ff6b35 0%, #ff9500 100%); color: #fff; }
        .btn-modal-confirm:hover { background: linear-gradient(135deg, #e55a2b 0%, #e08600 100%); }

        .toast { position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%); background: #111; color: #fff; padding: 12px 24px; border-radius: 8px; font-size: 14px; z-index: 2000; opacity: 0; transition: opacity 0.3s; }
        .toast.show { opacity: 1; }

        /* SNS íƒ€ì… ì„ íƒ */
        .sns-options { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
        .sns-option { display: flex; align-items: center; padding: 8px 12px; background: #f9fafb; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer; transition: all 0.2s; }
        .sns-option:hover { border-color: #ff6b35; background: #fff8f5; }
        .sns-option.selected { border-color: #ff6b35; background: #fff8f5; }
        .sns-option input { display: none; }
        .sns-option span { font-size: 13px; color: #374151; }

        /* íŒ”ë¡œì›Œ ë²”ìœ„ ì„ íƒ */
        .follower-options { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
        .follower-option { padding: 8px 16px; background: #f9fafb; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 13px; cursor: pointer; transition: all 0.2s; }
        .follower-option:hover { border-color: #ff6b35; background: #fff8f5; }
        .follower-option.selected { border-color: #ff6b35; background: #fff8f5; color: #ff6b35; font-weight: 600; }

        /* ì´ë©”ì¼ ëª¨ë‹¬ */
        .email-modal .modal-content { max-width: 800px; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column; }
        .email-modal .modal-body { flex: 1; overflow: hidden; display: flex; flex-direction: column; }
        .email-subject-row { display: flex; gap: 8px; margin-bottom: 12px; align-items: center; }
        .email-subject-label { font-size: 13px; font-weight: 600; color: #374151; white-space: nowrap; }
        .email-subject-input { flex: 1; padding: 10px 14px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px; font-family: inherit; }
        .email-subject-input:focus { outline: none; border-color: #ff6b35; }
        .btn-copy-subject { padding: 10px 16px; background: #1a1a2e; color: #fff; border: none; border-radius: 8px; font-size: 13px; font-weight: 600; cursor: pointer; white-space: nowrap; }
        .email-preview-frame { flex: 1; border: 1px solid #e5e7eb; border-radius: 8px; overflow: auto; background: #f8f9fa; min-height: 350px; }
        .email-preview-frame iframe { width: 100%; height: 400px; border: none; }
        .email-actions { display: flex; gap: 8px; margin-top: 16px; }
        .email-actions .btn-modal { flex: 1; }

        /* ì¤‘ë³µ í™•ì¸ ëª¨ë‹¬ */
        .duplicate-list { max-height: 200px; overflow-y: auto; margin: 16px 0; }
        .duplicate-item { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #f9fafb; border-radius: 8px; margin-bottom: 8px; border: 2px solid transparent; cursor: pointer; transition: all 0.2s; }
        .duplicate-item:hover { border-color: #ff6b35; background: #fff8f5; }
        .duplicate-item.selected { border-color: #ff6b35; background: #fff8f5; }
        .duplicate-info { flex: 1; }
        .duplicate-name { font-size: 14px; font-weight: 600; color: #111; }
        .duplicate-meta { font-size: 12px; color: #6b7280; margin-top: 4px; }
        .modal-actions-row { display: flex; gap: 8px; margin-top: 16px; }
        .modal-actions-row .btn-modal { flex: 1; }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-inner">
            <a href="/" class="logo">
                <span>ğŸ”¥ ëª¨ì—¬ë¼ë”œ</span>
            </a>
            <div class="nav-menu">
                <a href="/seller/" class="nav-item">ì…€ëŸ¬ í¬í„¸</a>
                <a href="proposal-manager.html" class="nav-item active">ì…€ëŸ¬ ì œì•ˆ</a>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="page-header">
            <h1 class="page-title">ğŸ‘©â€ğŸ’¼ ì…€ëŸ¬ ì œì•ˆ ê´€ë¦¬ (ì•„ì›ƒë°”ìš´ë“œ)</h1>
            <p class="page-desc">ì…€ëŸ¬ íƒ€ì…ë³„ë¡œ ë§ì¶¤ ì œì•ˆì„œë¥¼ ìƒì„±í•˜ê³ , íŒŒì´í”„ë¼ì¸ì„ ê´€ë¦¬í•˜ì„¸ìš”.<br>ì œì•ˆ â†’ ì˜¨ë³´ë”© â†’ ì…ì ì™„ë£Œê¹Œì§€ ì „ ê³¼ì •ì„ ì¶”ì í•©ë‹ˆë‹¤.</p>
        </div>

        <!-- í†µê³„ ì¹´ë“œ -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">ì´ ì œì•ˆ</div>
                <div class="stat-value" id="totalProposals">0</div>
                <div class="stat-change up" id="proposalChange">ì´ë²ˆ ì£¼ +0ê±´</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">ì˜¨ë³´ë”© ì¤‘</div>
                <div class="stat-value" id="onboardingCount">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">ì…ì ì™„ë£Œ</div>
                <div class="stat-value" id="listedCount">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">ì „í™˜ìœ¨</div>
                <div class="stat-value" id="conversionRate">0%</div>
            </div>
        </div>

        <!-- ì „í™” ëŒ€ë³¸ ì„¹ì…˜ -->
        <div class="call-script-card">
            <div class="call-script-header">
                <div class="call-script-icon">ğŸ“</div>
                <div>
                    <h3 class="call-script-title">ì…€ëŸ¬ ì „í™” ëŒ€ë³¸</h3>
                </div>
            </div>
            <p class="call-script-desc">
                ì…€ëŸ¬ì—ê²Œ ì „í™”í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í‘œì¤€ ëŒ€ë³¸ì…ë‹ˆë‹¤.<br>
                ìƒí™©ë³„ ë¶„ê¸°ì™€ TIPì´ í¬í•¨ë˜ì–´ ìˆì–´ íš¨ê³¼ì ì¸ ì½œë“œì½œì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
            </p>
            <a href="/seller/call-script/template.html" target="_blank" class="call-script-btn">
                <span>ğŸ“„</span> ì „í™” ëŒ€ë³¸ ë³´ê¸°
            </a>
        </div>

        <div class="section-header">
            <h2 class="section-title">ğŸ¯ ì…€ëŸ¬ íƒ€ì…ë³„ ì œì•ˆ</h2>
            <span class="section-badge">ì•„ì›ƒë°”ìš´ë“œ</span>
        </div>

        <div class="type-grid">
            <!-- ì¸ìŠ¤íƒ€ê·¸ë¨ ì…€ëŸ¬ -->
            <div class="type-card" data-type="instagram">
                <div class="type-icon">ğŸ“¸</div>
                <h3 class="type-name">ì¸ìŠ¤íƒ€ê·¸ë¨ ì…€ëŸ¬</h3>
                <p class="type-desc">ì¸ìŠ¤íƒ€ê·¸ë¨ ê¸°ë°˜ ì¸í”Œë£¨ì–¸ì„œ, ê³µêµ¬ íŒë§¤ì</p>
                <div class="type-tags">
                    <span class="type-tag">ìŠ¤í† ë¦¬ ê³µêµ¬</span>
                    <span class="type-tag">í”¼ë“œ í™ë³´</span>
                    <span class="type-tag">ë¼ì´ë¸Œ</span>
                </div>
                <div class="btn-group">
                    <button class="btn-primary" onclick="openCreateModal('instagram', 'ì¸ìŠ¤íƒ€ê·¸ë¨')">+ ìƒˆ ì œì•ˆ</button>
                </div>
                <div class="proposals-section" id="proposals-instagram"></div>
            </div>

            <!-- ë¸”ë¡œê·¸ ì…€ëŸ¬ -->
            <div class="type-card" data-type="blog">
                <div class="type-icon">ğŸ“</div>
                <h3 class="type-name">ë¸”ë¡œê·¸ ì…€ëŸ¬</h3>
                <p class="type-desc">ë„¤ì´ë²„/í‹°ìŠ¤í† ë¦¬ ë¸”ë¡œê·¸ ìš´ì˜ì</p>
                <div class="type-tags">
                    <span class="type-tag">ë¦¬ë·° í¬ìŠ¤íŒ…</span>
                    <span class="type-tag">ì²´í—˜ë‹¨</span>
                    <span class="type-tag">SEO</span>
                </div>
                <div class="btn-group">
                    <button class="btn-primary" onclick="openCreateModal('blog', 'ë¸”ë¡œê·¸')">+ ìƒˆ ì œì•ˆ</button>
                </div>
                <div class="proposals-section" id="proposals-blog"></div>
            </div>

            <!-- ìœ íŠœë¸Œ ì…€ëŸ¬ -->
            <div class="type-card" data-type="youtube">
                <div class="type-icon">ğŸ¬</div>
                <h3 class="type-name">ìœ íŠœë¸Œ ì…€ëŸ¬</h3>
                <p class="type-desc">ìœ íŠœë¸Œ í¬ë¦¬ì—ì´í„°, ë¦¬ë·°ì–´</p>
                <div class="type-tags">
                    <span class="type-tag">ì–¸ë°•ì‹±</span>
                    <span class="type-tag">ë¦¬ë·°</span>
                    <span class="type-tag">ì‡¼ì¸ </span>
                </div>
                <div class="btn-group">
                    <button class="btn-primary" onclick="openCreateModal('youtube', 'ìœ íŠœë¸Œ')">+ ìƒˆ ì œì•ˆ</button>
                </div>
                <div class="proposals-section" id="proposals-youtube"></div>
            </div>

            <!-- í‹±í†¡ ì…€ëŸ¬ -->
            <div class="type-card" data-type="tiktok">
                <div class="type-icon">ğŸµ</div>
                <h3 class="type-name">í‹±í†¡ ì…€ëŸ¬</h3>
                <p class="type-desc">í‹±í†¡ í¬ë¦¬ì—ì´í„°, ìˆí¼ ì „ë¬¸ê°€</p>
                <div class="type-tags">
                    <span class="type-tag">ìˆí¼</span>
                    <span class="type-tag">íŠ¸ë Œë“œ</span>
                    <span class="type-tag">MZì„¸ëŒ€</span>
                </div>
                <div class="btn-group">
                    <button class="btn-primary" onclick="openCreateModal('tiktok', 'í‹±í†¡')">+ ìƒˆ ì œì•ˆ</button>
                </div>
                <div class="proposals-section" id="proposals-tiktok"></div>
            </div>

            <!-- ì¹´í˜/ì»¤ë®¤ë‹ˆí‹° ì…€ëŸ¬ -->
            <div class="type-card" data-type="community">
                <div class="type-icon">ğŸ‘¥</div>
                <h3 class="type-name">ì¹´í˜/ì»¤ë®¤ë‹ˆí‹° ì…€ëŸ¬</h3>
                <p class="type-desc">ë„¤ì´ë²„ ì¹´í˜, ë§˜ì¹´í˜ ìš´ì˜ì</p>
                <div class="type-tags">
                    <span class="type-tag">ê³µë™êµ¬ë§¤</span>
                    <span class="type-tag">ì¹´í˜ ê³µêµ¬</span>
                    <span class="type-tag">ì»¤ë®¤ë‹ˆí‹°</span>
                </div>
                <div class="btn-group">
                    <button class="btn-primary" onclick="openCreateModal('community', 'ì¹´í˜/ì»¤ë®¤ë‹ˆí‹°')">+ ìƒˆ ì œì•ˆ</button>
                </div>
                <div class="proposals-section" id="proposals-community"></div>
            </div>

            <!-- ë¼ì´ë¸Œì»¤ë¨¸ìŠ¤ ì…€ëŸ¬ -->
            <div class="type-card" data-type="live">
                <div class="type-icon">ğŸ“º</div>
                <h3 class="type-name">ë¼ì´ë¸Œì»¤ë¨¸ìŠ¤ ì…€ëŸ¬</h3>
                <p class="type-desc">ë„¤ì´ë²„ ì‡¼í•‘ë¼ì´ë¸Œ, ê·¸ë¦½ ë“± ë¼ì´ë¸Œ íŒë§¤ì</p>
                <div class="type-tags">
                    <span class="type-tag">ì‹¤ì‹œê°„ íŒë§¤</span>
                    <span class="type-tag">ë†’ì€ ì „í™˜ìœ¨</span>
                    <span class="type-tag">ì†Œí†µ</span>
                </div>
                <div class="btn-group">
                    <button class="btn-primary" onclick="openCreateModal('live', 'ë¼ì´ë¸Œì»¤ë¨¸ìŠ¤')">+ ìƒˆ ì œì•ˆ</button>
                </div>
                <div class="proposals-section" id="proposals-live"></div>
            </div>
        </div>
    </div>

    <!-- ì œì•ˆ ìƒì„± ëª¨ë‹¬ -->
    <div id="createModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">ğŸ“ ìƒˆ ì…€ëŸ¬ ì œì•ˆ ë“±ë¡</div>
            <div class="modal-body">
                <label class="modal-label">ì…€ëŸ¬ëª… / ì±„ë„ëª… <span style="color:#dc2626;">*</span></label>
                <input type="text" id="sellerName" class="modal-input" placeholder="ì˜ˆ: ë§˜ìŠ¤íƒ€ê·¸ë¨ / @momstagram">

                <label class="modal-label" style="margin-top: 16px;">SNS ê³„ì • / URL</label>
                <input type="text" id="sellerAccount" class="modal-input" placeholder="ì˜ˆ: https://instagram.com/momstagram">

                <label class="modal-label" style="margin-top: 16px;">ì—°ë½ì²˜</label>
                <input type="tel" id="sellerPhone" class="modal-input" placeholder="ì˜ˆ: 010-1234-5678">

                <label class="modal-label" style="margin-top: 16px;">ì´ë©”ì¼</label>
                <input type="email" id="sellerEmail" class="modal-input" placeholder="ì˜ˆ: seller@example.com">

                <label class="modal-label" style="margin-top: 16px;">íŒ”ë¡œì›Œ/êµ¬ë…ì ê·œëª¨</label>
                <div class="follower-options">
                    <div class="follower-option" data-value="1k-5k" onclick="selectFollower(this)">1K~5K</div>
                    <div class="follower-option" data-value="5k-10k" onclick="selectFollower(this)">5K~10K</div>
                    <div class="follower-option" data-value="10k-50k" onclick="selectFollower(this)">1ë§Œ~5ë§Œ</div>
                    <div class="follower-option" data-value="50k-100k" onclick="selectFollower(this)">5ë§Œ~10ë§Œ</div>
                    <div class="follower-option" data-value="100k+" onclick="selectFollower(this)">10ë§Œ+</div>
                </div>

                <label class="modal-label" style="margin-top: 16px;">ê´€ì‹¬ ì¹´í…Œê³ ë¦¬</label>
                <div class="sns-options" id="categoryOptions">
                    <label class="sns-option" onclick="toggleCategory(this)">
                        <input type="checkbox" value="food">
                        <span>ğŸ½ï¸ ì‹í’ˆ</span>
                    </label>
                    <label class="sns-option" onclick="toggleCategory(this)">
                        <input type="checkbox" value="baby">
                        <span>ğŸ‘¶ ìœ¡ì•„</span>
                    </label>
                    <label class="sns-option" onclick="toggleCategory(this)">
                        <input type="checkbox" value="lifestyle">
                        <span>ğŸ  ë¦¬ë¹™</span>
                    </label>
                    <label class="sns-option" onclick="toggleCategory(this)">
                        <input type="checkbox" value="beauty">
                        <span>ğŸ’„ ë·°í‹°</span>
                    </label>
                    <label class="sns-option" onclick="toggleCategory(this)">
                        <input type="checkbox" value="health">
                        <span>ğŸ’Š ê±´ê°•</span>
                    </label>
                    <label class="sns-option" onclick="toggleCategory(this)">
                        <input type="checkbox" value="pet">
                        <span>ğŸ¾ ë°˜ë ¤ë™ë¬¼</span>
                    </label>
                </div>

                <label class="modal-label" style="margin-top: 16px;">ë©”ëª¨</label>
                <textarea id="sellerMemo" class="modal-input" rows="3" placeholder="íŠ¹ì´ì‚¬í•­, ì°¸ê³  ì •ë³´ ë“±"></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn-modal btn-modal-cancel" onclick="closeCreateModal()">ì·¨ì†Œ</button>
                <button class="btn-modal btn-modal-confirm" onclick="createProposal()">ë“±ë¡</button>
            </div>
        </div>
    </div>

    <!-- ì´ë©”ì¼ ëª¨ë‹¬ -->
    <div id="emailModal" class="modal email-modal">
        <div class="modal-content">
            <div class="modal-header">ğŸ“§ ì œì•ˆ ì´ë©”ì¼</div>
            <div class="modal-body">
                <div class="email-subject-row">
                    <span class="email-subject-label">ì œëª©:</span>
                    <input type="text" id="emailSubject" class="email-subject-input" readonly>
                    <button class="btn-copy-subject" onclick="copyEmailSubject()">ğŸ“‹ ë³µì‚¬</button>
                </div>
                <div class="email-preview-frame">
                    <iframe id="emailPreviewFrame"></iframe>
                </div>
                <div class="email-actions">
                    <button class="btn-modal btn-modal-cancel" onclick="closeEmailModal()">ë‹«ê¸°</button>
                    <button class="btn-modal btn-modal-confirm" onclick="copyEmailHtml()">ğŸ“‹ HTML ë³µì‚¬</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì˜¨ë³´ë”© ë§í¬ ëª¨ë‹¬ -->
    <div id="onboardingModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">ğŸ”— ì˜¨ë³´ë”© ê°€ì´ë“œ ë§í¬</div>
            <div class="modal-body">
                <p style="font-size: 14px; color: #6b7280; margin-bottom: 16px;">ì•„ë˜ ë§í¬ë¥¼ ì…€ëŸ¬ì—ê²Œ ì „ë‹¬í•˜ì„¸ìš”. ì…€ëŸ¬ê°€ ë§í¬ë¥¼ í†µí•´ ì„œë¥˜ë¥¼ ì œì¶œí•˜ë©´ ìë™ìœ¼ë¡œ ì˜¨ë³´ë”© ë‹¨ê³„ë¡œ ì „í™˜ë©ë‹ˆë‹¤.</p>
                <div style="background: #f3f4f6; padding: 16px; border-radius: 8px; word-break: break-all; font-family: monospace; font-size: 13px;" id="onboardingLinkText"></div>
            </div>
            <div class="modal-footer">
                <button class="btn-modal btn-modal-cancel" onclick="closeOnboardingModal()">ë‹«ê¸°</button>
                <button class="btn-modal btn-modal-confirm" onclick="copyOnboardingLink()">ğŸ“‹ ë§í¬ ë³µì‚¬</button>
            </div>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <!-- ì¤‘ë³µ í™•ì¸ ëª¨ë‹¬ -->
    <div id="duplicateModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">ğŸ” ì…€ëŸ¬ ì¤‘ë³µ í™•ì¸</div>
            <div class="modal-body">
                <p style="font-size: 14px; color: #6b7280; margin-bottom: 16px;">
                    ë™ì¼í•œ ì´ë¦„ì˜ ì…€ëŸ¬ê°€ ì´ë¯¸ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.<br>
                    ê¸°ì¡´ ì…€ëŸ¬ì™€ ë³‘í•©í•˜ê±°ë‚˜ ìƒˆë¡œ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
                <div class="duplicate-list" id="duplicateList"></div>
                <div class="modal-actions-row">
                    <button class="btn-modal btn-modal-cancel" onclick="closeDuplicateModal()">ì·¨ì†Œ</button>
                    <button class="btn-modal" style="background:#3b82f6;color:#fff;" onclick="mergeWithSelected()">ì„ íƒ í•­ëª©ì— ë³‘í•©</button>
                    <button class="btn-modal btn-modal-confirm" onclick="addAsNew()">ìƒˆë¡œ ì¶”ê°€</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <script>
        // Firebase ì„¤ì •
        const firebaseConfig = {
            apiKey: "AIzaSyAQf_Cu9wMji5QsMBQns5eg6nOD_vmrZMs",
            authDomain: "moyeora-deal-manager.firebaseapp.com",
            projectId: "moyeora-deal-manager",
            storageBucket: "moyeora-deal-manager.firebasestorage.app",
            messagingSenderId: "527148187832",
            appId: "1:527148187832:web:dc35b0413a7157db34744d"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const BASE_URL = 'https://partner-moyeoradeal.kr';
        let currentType = null;
        let currentTypeName = null;
        let selectedFollower = null;
        let currentOnboardingLink = '';
        let currentEmailHtml = '';

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¡œë“œ
        document.addEventListener('DOMContentLoaded', function() {
            loadSellerProposals();
        });

        // ì…€ëŸ¬ ì œì•ˆ ëª©ë¡ ë¡œë“œ (ì…ì  ì œì•ˆë§Œ - ê¸°ì¡´ ê³µêµ¬ ì œì•ˆê³¼ êµ¬ë¶„)
        async function loadSellerProposals() {
            try {
                const snapshot = await db.collection('sellerProposals')
                    .where('type', '==', 'recruitment')
                    .orderBy('createdAt', 'desc')
                    .get();

                const proposals = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

                // íƒ€ì…ë³„ë¡œ ê·¸ë£¹í•‘
                const byType = {};
                proposals.forEach(p => {
                    const type = p.sellerType || 'instagram';
                    if (!byType[type]) byType[type] = [];
                    byType[type].push(p);
                });

                // ê° íƒ€ì…ë³„ë¡œ ëª©ë¡ ì—…ë°ì´íŠ¸
                ['instagram', 'blog', 'youtube', 'tiktok', 'community', 'live'].forEach(type => {
                    updateProposalsList(type, byType[type] || []);
                });

                // í†µê³„ ì—…ë°ì´íŠ¸
                updateStats(proposals);
            } catch (err) {
                console.error('Firebase load error:', err);
            }
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats(proposals) {
            const total = proposals.length;
            const onboarding = proposals.filter(p => p.stage === 'onboarding').length;
            const listed = proposals.filter(p => p.stage === 'listed').length;
            const rate = total > 0 ? Math.round((listed / total) * 100) : 0;

            document.getElementById('totalProposals').textContent = total;
            document.getElementById('onboardingCount').textContent = onboarding;
            document.getElementById('listedCount').textContent = listed;
            document.getElementById('conversionRate').textContent = rate + '%';

            // ì´ë²ˆ ì£¼ ì¶”ê°€ ê±´ìˆ˜ ê³„ì‚°
            const oneWeekAgo = new Date();
            oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
            const thisWeek = proposals.filter(p => new Date(p.createdAt) > oneWeekAgo).length;
            document.getElementById('proposalChange').textContent = `ì´ë²ˆ ì£¼ +${thisWeek}ê±´`;
        }

        // ì œì•ˆ ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateProposalsList(type, proposals) {
            const container = document.getElementById(`proposals-${type}`);
            if (!container) return;

            if (proposals.length === 0) {
                container.innerHTML = '<div style="font-size: 12px; color: #9ca3af; padding: 12px; text-align: center;">ì•„ì§ ì œì•ˆì´ ì—†ìŠµë‹ˆë‹¤</div>';
                return;
            }

            let html = `
                <div class="proposals-header">
                    <span class="proposals-title">ğŸ“‹ ì œì•ˆ ëª©ë¡</span>
                    <span class="proposals-count">${proposals.length}ê±´</span>
                </div>
            `;

            proposals.forEach(p => {
                const stageBadge = getStageDisplay(p.stage);

                html += `
                    <div class="proposal-item">
                        <div class="proposal-info">
                            <div class="proposal-name">${p.name || p.sellerName || '-'}</div>
                            <div class="proposal-details">
                                <span class="status-badge ${p.stage || 'proposal'}">${stageBadge}</span>
                                ${p.followers ? `<span>ğŸ‘¥ ${p.followers}</span>` : ''}
                                ${p.phone ? `<span>ğŸ“ ${p.phone}</span>` : ''}
                            </div>
                        </div>
                        <div class="proposal-actions">
                            ${p.stage === 'proposal' ? `
                                <button class="btn-icon success" onclick="sendOnboarding('${p.id}')">ì˜¨ë³´ë”©</button>
                            ` : ''}
                            ${p.stage === 'onboarding' ? `
                                <button class="btn-icon success" onclick="markAsListed('${p.id}')">ì…ì ì™„ë£Œ</button>
                            ` : ''}
                            <div class="contact-dropdown">
                                <button class="contact-btn" onclick="toggleContactMenu(event, '${p.id}')">
                                    ì œì•ˆ <span style="font-size:10px;">â–¼</span>
                                </button>
                                <div class="contact-menu" id="contact-menu-${p.id}">
                                    <button class="contact-menu-item" onclick="openCallScript('${p.id}')">
                                        <span class="icon">ğŸ“</span> ì „í™” ëŒ€ë³¸
                                    </button>
                                    <button class="contact-menu-item" onclick="openEmailModalForSeller('${p.id}')">
                                        <span class="icon">ğŸ“§</span> ì´ë©”ì¼
                                    </button>
                                    <button class="contact-menu-item" onclick="openKakaoContact('${p.id}')">
                                        <span class="icon">ğŸ’¬</span> ì¹´ì¹´ì˜¤í†¡
                                    </button>
                                    <button class="contact-menu-item" onclick="openDMContact('${p.id}')">
                                        <span class="icon">âœ‰ï¸</span> DM
                                    </button>
                                    <button class="contact-menu-item" onclick="openInfocLink('${p.id}')">
                                        <span class="icon">ğŸ”—</span> ì¸í¬í¬ë§í¬
                                    </button>
                                </div>
                            </div>
                            <button class="btn-icon danger" onclick="deleteProposal('${p.id}', '${type}')">ì‚­ì œ</button>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // ë‹¨ê³„ í‘œì‹œ
        function getStageDisplay(stage) {
            switch(stage) {
                case 'proposal': return 'ì œì•ˆ';
                case 'onboarding': return 'ì˜¨ë³´ë”©';
                case 'listed': return 'ì…ì ì™„ë£Œ';
                default: return 'ì œì•ˆ';
            }
        }

        // ëª¨ë‹¬ ì—´ê¸°
        function openCreateModal(type, typeName) {
            currentType = type;
            currentTypeName = typeName;
            document.getElementById('sellerName').value = '';
            document.getElementById('sellerAccount').value = '';
            document.getElementById('sellerPhone').value = '';
            document.getElementById('sellerEmail').value = '';
            document.getElementById('sellerMemo').value = '';
            selectedFollower = null;
            document.querySelectorAll('.follower-option').forEach(el => el.classList.remove('selected'));
            document.querySelectorAll('.sns-option').forEach(el => el.classList.remove('selected'));
            document.querySelectorAll('.sns-option input').forEach(el => el.checked = false);
            document.getElementById('createModal').classList.add('active');
        }

        function closeCreateModal() {
            document.getElementById('createModal').classList.remove('active');
        }

        // íŒ”ë¡œì›Œ ì„ íƒ
        function selectFollower(el) {
            document.querySelectorAll('.follower-option').forEach(o => o.classList.remove('selected'));
            el.classList.add('selected');
            selectedFollower = el.dataset.value;
        }

        // ì¹´í…Œê³ ë¦¬ í† ê¸€
        function toggleCategory(el) {
            el.classList.toggle('selected');
            const checkbox = el.querySelector('input');
            checkbox.checked = !checkbox.checked;
        }

        // ì œì•ˆ ìƒì„±
        async function createProposal() {
            const name = document.getElementById('sellerName').value.trim();
            if (!name) {
                showToast('ì…€ëŸ¬ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì„ íƒëœ ì¹´í…Œê³ ë¦¬ ìˆ˜ì§‘
            const categories = [];
            document.querySelectorAll('#categoryOptions input:checked').forEach(el => {
                categories.push(el.value);
            });

            const newProposal = {
                name: name,
                sellerName: name,
                account: document.getElementById('sellerAccount').value.trim(),
                phone: document.getElementById('sellerPhone').value.trim(),
                email: document.getElementById('sellerEmail').value.trim(),
                followers: selectedFollower,
                categories: categories,
                memo: document.getElementById('sellerMemo').value.trim(),
                sellerType: currentType,
                sellerTypeName: currentTypeName,
                type: 'recruitment',  // ì…€ëŸ¬ ì…ì  ì œì•ˆ (ê¸°ì¡´ ê³µêµ¬ ì œì•ˆê³¼ êµ¬ë¶„)
                sourceType: 'outbound',  // ì•„ì›ƒë°”ìš´ë“œ
                stage: 'proposal',
                createdAt: new Date().toISOString(),
                proposalAt: new Date().toISOString()
            };

            try {
                await db.collection('sellerProposals').add(newProposal);
                closeCreateModal();
                await loadSellerProposals();
                showToast(`"${name}" ì…€ëŸ¬ ì œì•ˆì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!`);
            } catch (err) {
                console.error('Save error:', err);
                showToast('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì˜¨ë³´ë”© ì „ì†¡
        async function sendOnboarding(proposalId) {
            try {
                const doc = await db.collection('sellerProposals').doc(proposalId).get();
                if (!doc.exists) {
                    showToast('ì œì•ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                const data = doc.data();

                // ì˜¨ë³´ë”© ë§í¬ ìƒì„±
                const onboardingLink = `${BASE_URL}/seller-guide/onboarding.html?id=${proposalId}&source=outbound`;
                currentOnboardingLink = onboardingLink;

                // ìƒíƒœ ì—…ë°ì´íŠ¸
                await db.collection('sellerProposals').doc(proposalId).update({
                    stage: 'onboarding',
                    onboardingStartedAt: new Date().toISOString()
                });

                // ëª¨ë‹¬ì— ë§í¬ í‘œì‹œ
                document.getElementById('onboardingLinkText').textContent = onboardingLink;
                document.getElementById('onboardingModal').classList.add('active');

                await loadSellerProposals();
            } catch (err) {
                console.error('Error:', err);
                showToast('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // í˜„ì¬ ì²˜ë¦¬ ì¤‘ì¸ ì œì•ˆ ì •ë³´ (ì¤‘ë³µ í™•ì¸ìš©)
        let pendingListedData = null;
        let duplicateSellers = [];
        let selectedDuplicateId = null;

        // ì…ì ì™„ë£Œ ì²˜ë¦¬
        async function markAsListed(proposalId) {
            if (!confirm('ì…ì ì™„ë£Œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì…€ëŸ¬ DBë¡œ ë“±ë¡ë©ë‹ˆë‹¤.')) return;

            try {
                // ì œì•ˆ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                const doc = await db.collection('sellerProposals').doc(proposalId).get();
                if (!doc.exists) {
                    showToast('ì œì•ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                const proposalData = doc.data();
                const sellerName = proposalData.name || proposalData.sellerName || '';

                // ì¤‘ë³µ í™•ì¸: ê°™ì€ ì´ë¦„ì˜ ì…€ëŸ¬ê°€ ìˆëŠ”ì§€
                const duplicateCheck = await db.collection('sellers')
                    .where('name', '==', sellerName)
                    .get();

                if (!duplicateCheck.empty) {
                    // ì¤‘ë³µ ë°œê²¬ - ëª¨ë‹¬ í‘œì‹œ
                    pendingListedData = { proposalId, proposalData };
                    duplicateSellers = duplicateCheck.docs.map(d => ({ id: d.id, ...d.data() }));
                    showDuplicateModal(duplicateSellers, sellerName);
                } else {
                    // ì¤‘ë³µ ì—†ìŒ - ë°”ë¡œ ë“±ë¡
                    await completeListing(proposalId, proposalData, null);
                }
            } catch (err) {
                console.error('Error:', err);
                showToast('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì¤‘ë³µ í™•ì¸ ëª¨ë‹¬ í‘œì‹œ
        function showDuplicateModal(duplicates, sellerName) {
            const listEl = document.getElementById('duplicateList');
            listEl.innerHTML = duplicates.map(d => `
                <div class="duplicate-item" onclick="selectDuplicate('${d.id}')" data-id="${d.id}">
                    <div class="duplicate-info">
                        <div class="duplicate-name">${d.name || sellerName}</div>
                        <div class="duplicate-meta">
                            ${d.type ? `ğŸ·ï¸ ${d.type}` : ''}
                            ${d.followers ? ` Â· ğŸ‘¥ ${d.followers}` : ''}
                            ${d.registeredAt ? ` Â· ë“±ë¡: ${new Date(d.registeredAt).toLocaleDateString()}` : ''}
                        </div>
                    </div>
                </div>
            `).join('');

            selectedDuplicateId = null;
            document.getElementById('duplicateModal').classList.add('active');
        }

        // ì¤‘ë³µ í•­ëª© ì„ íƒ
        function selectDuplicate(id) {
            selectedDuplicateId = id;
            document.querySelectorAll('.duplicate-item').forEach(el => {
                el.classList.toggle('selected', el.dataset.id === id);
            });
        }

        // ì¤‘ë³µ ëª¨ë‹¬ ë‹«ê¸°
        function closeDuplicateModal() {
            document.getElementById('duplicateModal').classList.remove('active');
            pendingListedData = null;
            duplicateSellers = [];
            selectedDuplicateId = null;
        }

        // ì„ íƒí•œ í•­ëª©ê³¼ ë³‘í•©
        async function mergeWithSelected() {
            if (!selectedDuplicateId) {
                showToast('ë³‘í•©í•  ì…€ëŸ¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            if (!pendingListedData) return;

            try {
                const { proposalId, proposalData } = pendingListedData;

                // ê¸°ì¡´ ì…€ëŸ¬ ì •ë³´ ì—…ë°ì´íŠ¸ (ìƒˆ ì •ë³´ ë³‘í•©)
                const updateData = {
                    lastUpdatedAt: new Date().toISOString(),
                    crmSource: 'merged'
                };

                // ìƒˆë¡œìš´ ì •ë³´ê°€ ìˆìœ¼ë©´ ì¶”ê°€
                if (proposalData.phone) updateData.phone = proposalData.phone;
                if (proposalData.email) updateData.email = proposalData.email;
                if (proposalData.account) updateData.snsAccount = proposalData.account;
                if (proposalData.followers) updateData.followers = proposalData.followers;
                if (proposalData.categories) updateData.categories = proposalData.categories;

                await db.collection('sellers').doc(selectedDuplicateId).update(updateData);

                // ì œì•ˆì„œ ìƒíƒœ ì—…ë°ì´íŠ¸
                await db.collection('sellerProposals').doc(proposalId).update({
                    stage: 'listed',
                    listedAt: new Date().toISOString(),
                    linkedSellerId: selectedDuplicateId,
                    mergedWith: selectedDuplicateId
                });

                closeDuplicateModal();
                await loadSellerProposals();
                showToast('ê¸°ì¡´ ì…€ëŸ¬ì™€ ë³‘í•©ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (err) {
                console.error('Merge error:', err);
                showToast('ë³‘í•© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ìƒˆë¡œ ì¶”ê°€
        async function addAsNew() {
            if (!pendingListedData) return;

            const { proposalId, proposalData } = pendingListedData;
            await completeListing(proposalId, proposalData, null);
            closeDuplicateModal();
        }

        // ì…ì  ì™„ë£Œ ì²˜ë¦¬ (ì…€ëŸ¬ DBì— ë“±ë¡)
        async function completeListing(proposalId, proposalData, linkedId) {
            try {
                // ì…€ëŸ¬ DBì— ìƒˆë¡œ ì¶”ê°€
                const sellerData = {
                    name: proposalData.name || proposalData.sellerName,
                    phone: proposalData.phone || '',
                    email: proposalData.email || '',
                    type: proposalData.sellerTypeName || proposalData.sellerType || '',
                    snsAccount: proposalData.account || '',
                    followers: proposalData.followers || '',
                    categories: proposalData.categories || [],
                    source: 'crm',
                    sourceType: proposalData.sourceType || 'outbound',
                    registeredAt: new Date().toISOString(),
                    status: 'active',
                    notes: `CRMì„ í†µí•´ ë“±ë¡ë¨ (ì œì•ˆ ID: ${proposalId})`
                };

                const newSellerRef = await db.collection('sellers').add(sellerData);

                // ì œì•ˆì„œ ìƒíƒœ ì—…ë°ì´íŠ¸
                await db.collection('sellerProposals').doc(proposalId).update({
                    stage: 'listed',
                    listedAt: new Date().toISOString(),
                    linkedSellerId: newSellerRef.id
                });

                await loadSellerProposals();
                showToast('ì…ì ì™„ë£Œ! ì…€ëŸ¬ DBì— ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (err) {
                console.error('Complete listing error:', err);
                showToast('ì…€ëŸ¬ ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì‚­ì œ
        async function deleteProposal(proposalId, type) {
            if (!confirm('ì´ ì œì•ˆì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            try {
                await db.collection('sellerProposals').doc(proposalId).delete();
                await loadSellerProposals();
                showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (err) {
                console.error('Error:', err);
                showToast('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì´ë©”ì¼ ëª¨ë‹¬
        async function openEmailModalForSeller(proposalId) {
            try {
                const doc = await db.collection('sellerProposals').doc(proposalId).get();
                if (!doc.exists) {
                    showToast('ì œì•ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                const data = doc.data();
                const sellerName = data.name || data.sellerName;

                document.getElementById('emailSubject').value = `[ëª¨ì—¬ë¼ë”œ] ${sellerName}ë‹˜, íŒŒíŠ¸ë„ˆ ì œì•ˆë“œë¦½ë‹ˆë‹¤`;

                currentEmailHtml = generateSellerEmailHtml(data);
                document.getElementById('emailPreviewFrame').srcdoc = currentEmailHtml;
                document.getElementById('emailModal').classList.add('active');
            } catch (err) {
                console.error('Error:', err);
                showToast('ì´ë©”ì¼ ëª¨ë‹¬ì„ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // ì…€ëŸ¬ìš© ì´ë©”ì¼ HTML ìƒì„±
        function generateSellerEmailHtml(seller) {
            const sellerName = seller.name || seller.sellerName || 'ì…€ëŸ¬';
            const typeName = seller.sellerTypeName || 'ì¸ìŠ¤íƒ€ê·¸ë¨';

            return `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="margin: 0; padding: 20px; font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif; background: #f5f5f5;">
    <div style="max-width: 600px; margin: 0 auto; background: white; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
        <!-- í—¤ë” -->
        <div style="background: linear-gradient(135deg, #ff6b35 0%, #ff9500 100%); padding: 40px 32px; text-align: center;">
            <div style="font-size: 24px; font-weight: 700; color: white; margin-bottom: 8px;">ëª¨ì—¬ë¼ë”œ íŒŒíŠ¸ë„ˆ ì œì•ˆ</div>
            <div style="font-size: 14px; color: rgba(255,255,255,0.9);">ê³µë™êµ¬ë§¤ í”Œë«í¼ No.1</div>
        </div>

        <!-- ë³¸ë¬¸ -->
        <div style="padding: 40px 32px;">
            <div style="font-size: 18px; font-weight: 700; color: #111; margin-bottom: 24px;">
                ì•ˆë…•í•˜ì„¸ìš”, ${sellerName}ë‹˜!
            </div>

            <p style="font-size: 15px; color: #374151; line-height: 1.8; margin-bottom: 20px;">
                ${typeName} ì±„ë„ì„ ìš´ì˜í•˜ì‹œëŠ” ê²ƒì„ ë³´ê³  ì—°ë½ë“œë¦½ë‹ˆë‹¤.<br>
                ëª¨ì—¬ë¼ë”œì€ <strong>ê³µë™êµ¬ë§¤ ì „ë¬¸ í”Œë«í¼</strong>ìœ¼ë¡œ, ì…€ëŸ¬ë¶„ë“¤ì˜ ì„±ê³µì ì¸ ê³µêµ¬ ì§„í–‰ì„ ì§€ì›í•©ë‹ˆë‹¤.
            </p>

            <div style="background: #fff8f5; border-radius: 12px; padding: 24px; margin: 24px 0;">
                <div style="font-size: 16px; font-weight: 700; color: #ff6b35; margin-bottom: 16px;">ğŸ ì…€ëŸ¬ í˜œíƒ</div>
                <ul style="font-size: 14px; color: #374151; line-height: 2; margin: 0; padding-left: 20px;">
                    <li>ë¬´ë£Œ ì…ì , ìˆ˜ìˆ˜ë£Œ ìµœì†Œí™”</li>
                    <li>ì „ë‹´ ë§¤ë‹ˆì € 1:1 ì§€ì›</li>
                    <li>íŠ¸ë Œë“œ ìƒí’ˆ ë¬´ë£Œ ìƒ˜í”Œ ì œê³µ</li>
                    <li>ì½˜í…ì¸  ì œì‘ ì§€ì› (ì¸ë„¤ì¼, ìƒì„¸í˜ì´ì§€)</li>
                    <li>ë¹ ë¥¸ ì •ì‚° (3~7ì¼ ì´ë‚´)</li>
                </ul>
            </div>

            <p style="font-size: 15px; color: #374151; line-height: 1.8; margin-bottom: 24px;">
                ê´€ì‹¬ì´ ìˆìœ¼ì‹œë‹¤ë©´ í¸í•˜ê²Œ íšŒì‹  ì£¼ì‹œê±°ë‚˜, ì•„ë˜ ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ì—°ë½ ë¶€íƒë“œë¦½ë‹ˆë‹¤.
            </p>

            <div style="text-align: center; margin: 32px 0;">
                <a href="http://pf.kakao.com/_xdZVkn" style="display: inline-block; padding: 16px 40px; background: linear-gradient(135deg, #ff6b35 0%, #ff9500 100%); color: white; text-decoration: none; border-radius: 8px; font-size: 16px; font-weight: 700;">
                    ğŸ’¬ ì¹´ì¹´ì˜¤í†¡ ìƒë‹´í•˜ê¸°
                </a>
            </div>
        </div>

        <!-- í‘¸í„° -->
        <div style="background: #f9fafb; padding: 24px 32px; text-align: center; border-top: 1px solid #e5e7eb;">
            <div style="font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 8px;">ëª¨ì—¬ë¼ë”œ</div>
            <div style="font-size: 12px; color: #6b7280;">ê³µë™êµ¬ë§¤ í”Œë«í¼ | moyeoradeal.com</div>
        </div>
    </div>
</body>
</html>`;
        }

        // ì´ë©”ì¼ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function closeEmailModal() {
            document.getElementById('emailModal').classList.remove('active');
        }

        function copyEmailSubject() {
            const subject = document.getElementById('emailSubject').value;
            navigator.clipboard.writeText(subject).then(() => {
                showToast('ì œëª©ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }

        function copyEmailHtml() {
            navigator.clipboard.writeText(currentEmailHtml).then(() => {
                showToast('HTMLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }

        // ì˜¨ë³´ë”© ëª¨ë‹¬ ê´€ë ¨
        function closeOnboardingModal() {
            document.getElementById('onboardingModal').classList.remove('active');
        }

        function copyOnboardingLink() {
            navigator.clipboard.writeText(currentOnboardingLink).then(() => {
                showToast('ì˜¨ë³´ë”© ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }

        // ì—°ë½ ë°©ë²• ë“œë¡­ë‹¤ìš´ í† ê¸€
        function toggleContactMenu(event, proposalId) {
            event.stopPropagation();
            // ë‹¤ë¥¸ ë©”ë‰´ ë‹«ê¸°
            document.querySelectorAll('.contact-menu').forEach(menu => {
                if (menu.id !== `contact-menu-${proposalId}`) {
                    menu.classList.remove('show');
                }
            });
            // í˜„ì¬ ë©”ë‰´ í† ê¸€
            const menu = document.getElementById(`contact-menu-${proposalId}`);
            menu.classList.toggle('show');
        }

        // ë¬¸ì„œ í´ë¦­ ì‹œ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
        document.addEventListener('click', function() {
            document.querySelectorAll('.contact-menu').forEach(menu => {
                menu.classList.remove('show');
            });
        });

        // ì „í™” ëŒ€ë³¸ ì—´ê¸°
        async function openCallScript(proposalId) {
            try {
                const doc = await db.collection('sellerProposals').doc(proposalId).get();
                if (!doc.exists) {
                    showToast('ì œì•ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                const data = doc.data();
                const sellerName = encodeURIComponent(data.name || data.sellerName || '');
                const channel = encodeURIComponent(data.account || '');
                const followers = encodeURIComponent(data.followers || '');
                const type = encodeURIComponent(data.sellerTypeName || 'ì¸í”Œë£¨ì–¸ì„œ');

                const url = `/seller/call-script/template.html?name=${sellerName}&channel=${channel}&followers=${followers}&type=${type}`;
                window.open(url, '_blank');
            } catch (err) {
                console.error('Error:', err);
                showToast('ì „í™” ëŒ€ë³¸ì„ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // ì¹´ì¹´ì˜¤í†¡ ì—°ë½
        async function openKakaoContact(proposalId) {
            try {
                const doc = await db.collection('sellerProposals').doc(proposalId).get();
                if (!doc.exists) {
                    showToast('ì œì•ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                const data = doc.data();
                const sellerName = data.name || data.sellerName;

                // ì¹´ì¹´ì˜¤í†¡ ë©”ì‹œì§€ í…œí”Œë¦¿ ë³µì‚¬
                const message = `ì•ˆë…•í•˜ì„¸ìš” ${sellerName}ë‹˜! ğŸ‘‹

ëª¨ì—¬ë¼ë”œ ì…€ëŸ¬ íŒŒíŠ¸ë„ˆì‹­ ë‹´ë‹¹ìì…ë‹ˆë‹¤.

${sellerName}ë‹˜ì˜ ì±„ë„ì„ ë³´ê³  ì—°ë½ë“œë ¤ìš”. ì €í¬ ëª¨ì—¬ë¼ë”œì€ ì•„íŒŒíŠ¸ ë‹¨ì§€ ëŒ€ìƒ ê³µë™êµ¬ë§¤ í”Œë«í¼ì¸ë°ìš”,

âœ¨ ë¬´ë£Œ ì…ì , ìµœì†Œ ìˆ˜ìˆ˜ë£Œ
âœ¨ ì „ë‹´ ë§¤ë‹ˆì € 1:1 ì§€ì›
âœ¨ íŠ¸ë Œë“œ ìƒí’ˆ ë¬´ë£Œ ìƒ˜í”Œ
âœ¨ ë¹ ë¥¸ ì •ì‚° (3~7ì¼)

í˜¹ì‹œ ê³µë™êµ¬ë§¤ í˜‘ì—…ì— ê´€ì‹¬ ìˆìœ¼ì‹œë©´ í¸í•˜ê²Œ ë‹µë³€ ì£¼ì„¸ìš”! ğŸ˜Š`;

                await navigator.clipboard.writeText(message);
                showToast('ì¹´ì¹´ì˜¤í†¡ ë©”ì‹œì§€ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ì¹´ì¹´ì˜¤í†¡ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.');
            } catch (err) {
                console.error('Error:', err);
                showToast('ë©”ì‹œì§€ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // DM ì—°ë½ (ì¸ìŠ¤íƒ€ê·¸ë¨ ë“±)
        async function openDMContact(proposalId) {
            try {
                const doc = await db.collection('sellerProposals').doc(proposalId).get();
                if (!doc.exists) {
                    showToast('ì œì•ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                const data = doc.data();
                const sellerName = data.name || data.sellerName;
                const account = data.account || '';

                // DM ë©”ì‹œì§€ í…œí”Œë¦¿ ë³µì‚¬
                const message = `ì•ˆë…•í•˜ì„¸ìš” ${sellerName}ë‹˜! âœ¨

ëª¨ì—¬ë¼ë”œ íŒŒíŠ¸ë„ˆì‹­ ë‹´ë‹¹ìì…ë‹ˆë‹¤.
ì±„ë„ ìš´ì˜í•˜ì‹œëŠ” ê²ƒ ë³´ê³  ì—°ë½ë“œë ¤ìš”!

ì €í¬ëŠ” ì•„íŒŒíŠ¸ ê³µë™êµ¬ë§¤ í”Œë«í¼ì¸ë°,
ì…€ëŸ¬ë¶„ë“¤ê³¼ í˜‘ì—…í•´ì„œ ê³µêµ¬ ì§„í–‰í•˜ê³  ìˆì–´ìš”.

ğŸ ë¬´ë£Œ ì…ì  / ì „ë‹´ ë§¤ë‹ˆì € ì§€ì›
ğŸ íŠ¸ë Œë“œ ìƒí’ˆ ë¬´ë£Œ ìƒ˜í”Œ ì œê³µ
ğŸ ë¹ ë¥¸ ì •ì‚°

ê´€ì‹¬ ìˆìœ¼ì‹œë©´ í¸í•˜ê²Œ ë‹µë³€ ì£¼ì„¸ìš”! ğŸ’¬`;

                await navigator.clipboard.writeText(message);

                // ì¸ìŠ¤íƒ€ê·¸ë¨ URLì´ë©´ ë°”ë¡œ ì—´ê¸°
                if (account && account.includes('instagram.com')) {
                    window.open(account, '_blank');
                }

                showToast('DM ë©”ì‹œì§€ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! SNSì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.');
            } catch (err) {
                console.error('Error:', err);
                showToast('ë©”ì‹œì§€ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì¸í¬í¬ë§í¬ ìƒì„±
        async function openInfocLink(proposalId) {
            try {
                const doc = await db.collection('sellerProposals').doc(proposalId).get();
                if (!doc.exists) {
                    showToast('ì œì•ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                const data = doc.data();
                const sellerName = data.name || data.sellerName;
                const typeName = data.sellerTypeName || 'ì¸í”Œë£¨ì–¸ì„œ';

                // ì¸í¬í¬ë§í¬ìš© ì œì•ˆ í˜ì´ì§€ URL ìƒì„±
                const proposalData = {
                    sellerName: sellerName,
                    sellerType: typeName,
                    proposalId: proposalId
                };
                const encodedData = btoa(encodeURIComponent(JSON.stringify(proposalData)));
                const infocLink = `${BASE_URL}/seller/proposal/?d=${encodedData}`;

                await navigator.clipboard.writeText(infocLink);
                showToast('ì¸í¬í¬ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ê³µìœ  ê°€ëŠ¥í•©ë‹ˆë‹¤.');
            } catch (err) {
                console.error('Error:', err);
                showToast('ë§í¬ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // í† ìŠ¤íŠ¸
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2500);
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('createModal').addEventListener('click', function(e) {
            if (e.target === this) closeCreateModal();
        });
        document.getElementById('emailModal').addEventListener('click', function(e) {
            if (e.target === this) closeEmailModal();
        });
        document.getElementById('onboardingModal').addEventListener('click', function(e) {
            if (e.target === this) closeOnboardingModal();
        });
        document.getElementById('duplicateModal').addEventListener('click', function(e) {
            if (e.target === this) closeDuplicateModal();
        });
    </script>
</body>
</html>
